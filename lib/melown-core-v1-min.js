!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b._mproj4_=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function Point(a,b,c){if(!(this instanceof Point))return new Point(a,b,c);if(Array.isArray(a))this.x=a[0],this.y=a[1],this.z=a[2]||0;else if("object"==typeof a)this.x=a.x,this.y=a.y,this.z=a.z||0;else if("string"==typeof a&&"undefined"==typeof b){var d=a.split(",");this.x=parseFloat(d[0],10),this.y=parseFloat(d[1],10),this.z=parseFloat(d[2],10)||0}else this.x=a,this.y=b,this.z=c||0;console.warn("_mproj4_.Point will be removed in version 3, use _mproj4_.toPoint")}var d=a("mgrs");Point.fromMGRS=function(a){return new Point(d.toPoint(a))},Point.prototype.toMGRS=function(a){return d.forward([this.x,this.y],a)},b.exports=Point},{mgrs:68}],2:[function(a,b,c){function Projection(a,b){if(!(this instanceof Projection))return new Projection(a);b=b||function(a){if(a)throw a};var c=d(a);if("object"!=typeof c)return void b(a);var f=g(c),h=Projection.projections.get(f.projName);h?(e(this,f),e(this,h),this.init(),b(null,this)):b(a)}var d=a("./parseCode"),e=a("./extend"),f=a("./projections"),g=a("./deriveConstants");Projection.projections=f,Projection.projections.start(),b.exports=Projection},{"./deriveConstants":33,"./extend":34,"./parseCode":37,"./projections":39}],3:[function(a,b,c){b.exports=function(a,b,c){var d,e,f,g=c.x,h=c.y,i=c.z||0;for(f=0;3>f;f++)if(!b||2!==f||void 0!==c.z)switch(0===f?(d=g,e="x"):1===f?(d=h,e="y"):(d=i,e="z"),a.axis[f]){case"e":c[e]=d;break;case"w":c[e]=-d;break;case"n":c[e]=d;break;case"s":c[e]=-d;break;case"u":void 0!==c[e]&&(c.z=d);break;case"d":void 0!==c[e]&&(c.z=-d);break;default:return null}return c}},{}],4:[function(a,b,c){var d=Math.PI/2,e=a("./sign");b.exports=function(a){return Math.abs(a)<d?a:a-e(a)*Math.PI}},{"./sign":21}],5:[function(a,b,c){var d=2*Math.PI,e=3.14159265359,f=a("./sign");b.exports=function(a){return Math.abs(a)<=e?a:a-f(a)*d}},{"./sign":21}],6:[function(a,b,c){b.exports=function(a){return Math.abs(a)>1&&(a=a>1?1:-1),Math.asin(a)}},{}],7:[function(a,b,c){b.exports=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))}},{}],8:[function(a,b,c){b.exports=function(a){return.375*a*(1+.25*a*(1+.46875*a))}},{}],9:[function(a,b,c){b.exports=function(a){return.05859375*a*a*(1+.75*a)}},{}],10:[function(a,b,c){b.exports=function(a){return a*a*a*(35/3072)}},{}],11:[function(a,b,c){b.exports=function(a,b,c){var d=b*c;return a/Math.sqrt(1-d*d)}},{}],12:[function(a,b,c){b.exports=function(a,b,c,d,e){var f,g;f=a/b;for(var h=0;15>h;h++)if(g=(a-(b*f-c*Math.sin(2*f)+d*Math.sin(4*f)-e*Math.sin(6*f)))/(b-2*c*Math.cos(2*f)+4*d*Math.cos(4*f)-6*e*Math.cos(6*f)),f+=g,Math.abs(g)<=1e-10)return f;return NaN}},{}],13:[function(a,b,c){var d=Math.PI/2;b.exports=function(a,b){var c=1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a));if(Math.abs(Math.abs(b)-c)<1e-6)return 0>b?-1*d:d;for(var e,f,g,h,i=Math.asin(.5*b),j=0;30>j;j++)if(f=Math.sin(i),g=Math.cos(i),h=a*f,e=Math.pow(1-h*h,2)/(2*g)*(b/(1-a*a)-f/(1-h*h)+.5/a*Math.log((1-h)/(1+h))),i+=e,Math.abs(e)<=1e-10)return i;return NaN}},{}],14:[function(a,b,c){b.exports=function(a,b,c,d,e){return a*e-b*Math.sin(2*e)+c*Math.sin(4*e)-d*Math.sin(6*e)}},{}],15:[function(a,b,c){b.exports=function(a,b,c){var d=a*b;return c/Math.sqrt(1-d*d)}},{}],16:[function(a,b,c){var d=Math.PI/2;b.exports=function(a,b){for(var c,e,f=.5*a,g=d-2*Math.atan(b),h=0;15>=h;h++)if(c=a*Math.sin(g),e=d-2*Math.atan(b*Math.pow((1-c)/(1+c),f))-g,g+=e,Math.abs(e)<=1e-10)return g;return-9999}},{}],17:[function(a,b,c){var d=1,e=.25,f=.046875,g=.01953125,h=.01068115234375,i=.75,j=.46875,k=.013020833333333334,l=.007120768229166667,m=.3645833333333333,n=.005696614583333333,o=.3076171875;b.exports=function(a){var b=[];b[0]=d-a*(e+a*(f+a*(g+a*h))),b[1]=a*(i-a*(f+a*(g+a*h)));var c=a*a;return b[2]=c*(j-a*(k+a*l)),c*=a,b[3]=c*(m-a*n),b[4]=c*a*o,b}},{}],18:[function(a,b,c){var d=a("./pj_mlfn"),e=1e-10,f=20;b.exports=function(a,b,c){for(var g=1/(1-b),h=a,i=f;i;--i){var j=Math.sin(h),k=1-b*j*j;if(k=(d(h,j,Math.cos(h),c)-a)*(k*Math.sqrt(k))*g,h-=k,Math.abs(k)<e)return h}return h}},{"./pj_mlfn":19}],19:[function(a,b,c){b.exports=function(a,b,c,d){return c*=b,b*=b,d[0]*a-c*(d[1]+b*(d[2]+b*(d[3]+b*d[4])))}},{}],20:[function(a,b,c){b.exports=function(a,b){var c;return a>1e-7?(c=a*b,(1-a*a)*(b/(1-c*c)-.5/a*Math.log((1-c)/(1+c)))):2*b}},{}],21:[function(a,b,c){b.exports=function(a){return 0>a?-1:1}},{}],22:[function(a,b,c){b.exports=function(a,b){return Math.pow((1-a)/(1+a),b)}},{}],23:[function(a,b,c){b.exports=function(a){var b={x:a[0],y:a[1]};return a.length>2&&(b.z=a[2]),a.length>3&&(b.m=a[3]),b}},{}],24:[function(a,b,c){var d=Math.PI/2;b.exports=function(a,b,c){var e=a*c,f=.5*a;return e=Math.pow((1-e)/(1+e),f),Math.tan(.5*(d-b))/e}},{}],25:[function(a,b,c){c.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},c.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},c.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},c.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},c.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},c.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},c.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},c.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},c.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},c.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},c.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},c.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},c.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},c.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},c.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},c.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(a,b,c){c.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},c.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},c.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},c.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},c.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},c.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},c.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},c.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},c.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},c.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},c.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},c.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},c.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},c.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},c.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},c.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},c.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},c.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},c.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},c.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},c.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},c.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},c.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},c.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},c.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},c.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},c.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},c.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},c.hough={a:6378270,rf:297,ellipseName:"Hough"},c.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},c.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},c.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},c.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},c.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},c.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},c.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},c.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},c.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},c.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},c.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},c.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},c.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},c.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(a,b,c){c.greenwich=0,c.lisbon=-9.131906111111,c.paris=2.337229166667,c.bogota=-74.080916666667,c.madrid=-3.687938888889,c.rome=12.452333333333,c.bern=7.439583333333,c.jakarta=106.807719444444,c.ferro=-17.666666666667,c.brussels=4.367975,c.stockholm=18.058277777778,c.athens=23.7163375,c.oslo=10.722916666667},{}],28:[function(a,b,c){c.ft={to_meter:.3048},c["us-ft"]={to_meter:1200/3937}},{}],29:[function(a,b,c){function d(a,b,c){var d;return Array.isArray(c)?(d=g(a,b,c),3===c.length?[d.x,d.y,d.z]:[d.x,d.y]):g(a,b,c)}function e(a){return a instanceof f?a:a.oProj?a.oProj:f(a)}function _mproj4_(a,b,c,_dddd_){a=e(a);if(_dddd_) return a; var f,g=!1;return"undefined"==typeof b?(b=a,a=h,g=!0):("undefined"!=typeof b.x||Array.isArray(b))&&(c=b,b=a,a=h,g=!0),b=e(b),c?d(a,b,c):(f={forward:function(c){return d(a,b,c)},inverse:function(c){return d(b,a,c)},info:function(){return{a:b.a,b:b.b,ra:b.R_A,"proj-name":b.projName}}},g&&(f.oProj=b),f)}var f=a("./Proj"),g=a("./transform"),h=f("WGS84");b.exports=_mproj4_},{"./Proj":2,"./transform":66}],30:[function(a,b,c){var d=Math.PI/2,e=1,f=2,g=3,h=4,i=5,j=484813681109536e-20,k=1.0026,l=.3826834323650898,m=function(a){if(!(this instanceof m))return new m(a);if(this.datum_type=h,a){if(a.datumCode&&"none"===a.datumCode&&(this.datum_type=i),a.datum_params){for(var b=0;b<a.datum_params.length;b++)a.datum_params[b]=parseFloat(a.datum_params[b]);(0!==a.datum_params[0]||0!==a.datum_params[1]||0!==a.datum_params[2])&&(this.datum_type=e),a.datum_params.length>3&&(0!==a.datum_params[3]||0!==a.datum_params[4]||0!==a.datum_params[5]||0!==a.datum_params[6])&&(this.datum_type=f,a.datum_params[3]*=j,a.datum_params[4]*=j,a.datum_params[5]*=j,a.datum_params[6]=a.datum_params[6]/1e6+1)}this.datum_type=a.grids?g:this.datum_type,this.a=a.a,this.b=a.b,this.es=a.es,this.ep2=a.ep2,this.datum_params=a.datum_params,this.datum_type===g&&(this.grids=a.grids)}};m.prototype={compare_datums:function(a){return this.datum_type!==a.datum_type?!1:this.a!==a.a||Math.abs(this.es-a.es)>5e-11?!1:this.datum_type===e?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]:this.datum_type===f?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]&&this.datum_params[3]===a.datum_params[3]&&this.datum_params[4]===a.datum_params[4]&&this.datum_params[5]===a.datum_params[5]&&this.datum_params[6]===a.datum_params[6]:this.datum_type===g||a.datum_type===g?this.nadgrids===a.nadgrids:!0},geodetic_to_geocentric:function(a){var b,c,e,f,g,h,i,j=a.x,k=a.y,l=a.z?a.z:0,m=0;if(-d>k&&k>-1.001*d)k=-d;else if(k>d&&1.001*d>k)k=d;else if(-d>k||k>d)return null;return j>Math.PI&&(j-=2*Math.PI),g=Math.sin(k),i=Math.cos(k),h=g*g,f=this.a/Math.sqrt(1-this.es*h),b=(f+l)*i*Math.cos(j),c=(f+l)*i*Math.sin(j),e=(f*(1-this.es)+l)*g,a.x=b,a.y=c,a.z=e,m},geocentric_to_geodetic:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=1e-12,u=t*t,v=30,w=a.x,x=a.y,y=a.z?a.z:0;if(o=!1,b=Math.sqrt(w*w+x*x),c=Math.sqrt(w*w+x*x+y*y),b/this.a<t){if(o=!0,q=0,c/this.a<t)return r=d,void(s=-this.b)}else q=Math.atan2(x,w);e=y/c,f=b/c,g=1/Math.sqrt(1-this.es*(2-this.es)*f*f),j=f*(1-this.es)*g,k=e*g,p=0;do p++,i=this.a/Math.sqrt(1-this.es*k*k),s=b*j+y*k-i*(1-this.es*k*k),h=this.es*i/(i+s),g=1/Math.sqrt(1-h*(2-h)*f*f),l=f*(1-h)*g,m=e*g,n=m*j-l*k,j=l,k=m;while(n*n>u&&v>p);return r=Math.atan(m/Math.abs(l)),a.x=q,a.y=r,a.z=s,a},geocentric_to_geodetic_noniter:function(a){var b,c,e,f,g,h,i,j,m,n,o,p,q,r,s,t,u,v=a.x,w=a.y,x=a.z?a.z:0;if(v=parseFloat(v),w=parseFloat(w),x=parseFloat(x),u=!1,0!==v)b=Math.atan2(w,v);else if(w>0)b=d;else if(0>w)b=-d;else if(u=!0,b=0,x>0)c=d;else{if(!(0>x))return c=d,void(e=-this.b);c=-d}return g=v*v+w*w,f=Math.sqrt(g),h=x*k,j=Math.sqrt(h*h+g),n=h/j,p=f/j,o=n*n*n,i=x+this.b*this.ep2*o,t=f-this.a*this.es*p*p*p,m=Math.sqrt(i*i+t*t),q=i/m,r=t/m,s=this.a/Math.sqrt(1-this.es*q*q),e=r>=l?f/r-s:-l>=r?f/-r-s:x/q+s*(this.es-1),u===!1&&(c=Math.atan(q/r)),a.x=b,a.y=c,a.z=e,a},geocentric_to_wgs84:function(a){if(this.datum_type===e)a.x+=this.datum_params[0],a.y+=this.datum_params[1],a.z+=this.datum_params[2];else if(this.datum_type===f){var b=this.datum_params[0],c=this.datum_params[1],d=this.datum_params[2],g=this.datum_params[3],h=this.datum_params[4],i=this.datum_params[5],j=this.datum_params[6],k=j*(a.x-i*a.y+h*a.z)+b,l=j*(i*a.x+a.y-g*a.z)+c,m=j*(-h*a.x+g*a.y+a.z)+d;a.x=k,a.y=l,a.z=m}},geocentric_from_wgs84:function(a){if(this.datum_type===e)a.x-=this.datum_params[0],a.y-=this.datum_params[1],a.z-=this.datum_params[2];else if(this.datum_type===f){var b=this.datum_params[0],c=this.datum_params[1],d=this.datum_params[2],g=this.datum_params[3],h=this.datum_params[4],i=this.datum_params[5],j=this.datum_params[6],k=(a.x-b)/j,l=(a.y-c)/j,m=(a.z-d)/j;a.x=k+i*l-h*m,a.y=-i*k+l+g*m,a.z=h*k-g*l+m}}},b.exports=m},{}],31:[function(a,b,c){var d=1,e=2,f=3,g=5,h=6378137,i=.006694379990141316;b.exports=function(a,b,c){function j(a){return a===d||a===e}var k,l,m;if(a.compare_datums(b))return c;if(a.datum_type===g||b.datum_type===g)return c;var n=a.a,o=a.es,p=b.a,q=b.es,r=a.datum_type;if(r===f)if(0===this.apply_gridshift(a,0,c))a.a=h,a.es=i;else{if(!a.datum_params)return a.a=n,a.es=a.es,c;for(k=1,l=0,m=a.datum_params.length;m>l;l++)k*=a.datum_params[l];if(0===k)return a.a=n,a.es=a.es,c;r=a.datum_params.length>3?e:d}return b.datum_type===f&&(b.a=h,b.es=i),(a.es!==b.es||a.a!==b.a||j(r)||j(b.datum_type))&&(a.geodetic_to_geocentric(c),j(a.datum_type)&&a.geocentric_to_wgs84(c),j(b.datum_type)&&b.geocentric_from_wgs84(c),b.geocentric_to_geodetic(c)),b.datum_type===f&&this.apply_gridshift(b,1,c),a.a=n,a.es=o,b.a=p,b.es=q,c}},{}],32:[function(a,b,c){function d(a){var b=this;if(2===arguments.length){var c=arguments[1];"string"==typeof c?"+"===c.charAt(0)?d[a]=f(arguments[1]):d[a]=g(arguments[1]):d[a]=c}else if(1===arguments.length){if(Array.isArray(a))return a.map(function(a){Array.isArray(a)?d.apply(b,a):d(a)});if("string"==typeof a){if(a in d)return d[a]}else"EPSG"in a?d["EPSG:"+a.EPSG]=a:"ESRI"in a?d["ESRI:"+a.ESRI]=a:"IAU2000"in a?d["IAU2000:"+a.IAU2000]=a:console.log(a);return}}var e=a("./global"),f=a("./projString"),g=a("./wkt");e(d),b.exports=d},{"./global":35,"./projString":38,"./wkt":67}],33:[function(a,b,c){var d=a("./constants/Datum"),e=a("./constants/Ellipsoid"),f=a("./extend"),g=a("./datum"),h=1e-10,i=.16666666666666666,j=.04722222222222222,k=.022156084656084655;b.exports=function(a){if(a.datumCode&&"none"!==a.datumCode){var b=d[a.datumCode];b&&(a.datum_params=b.towgs84?b.towgs84.split(","):null,a.ellps=b.ellipse,a.datumName=b.datumName?b.datumName:a.datumCode)}if(!a.a){var c=e[a.ellps]?e[a.ellps]:e.WGS84;f(a,c)}return a.rf&&!a.b&&(a.b=(1-1/a.rf)*a.a),(0===a.rf||Math.abs(a.a-a.b)<h)&&(a.sphere=!0,a.b=a.a),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=(a.a2-a.b2)/a.a2,a.e=Math.sqrt(a.es),a.R_A&&(a.a*=1-a.es*(i+a.es*(j+a.es*k)),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=0),a.ep2=(a.a2-a.b2)/a.b2,a.k0||(a.k0=1),a.axis||(a.axis="enu"),a.datum||(a.datum=g(a)),a}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":30,"./extend":34}],34:[function(a,b,c){b.exports=function(a,b){a=a||{};var c,d;if(!b)return a;for(d in b)c=b[d],void 0!==c&&(a[d]=c);return a}},{}],35:[function(a,b,c){b.exports=function(a){a("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),a("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),a("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),a.WGS84=a["EPSG:4326"],a["EPSG:3785"]=a["EPSG:3857"],a.GOOGLE=a["EPSG:3857"],a["EPSG:900913"]=a["EPSG:3857"],a["EPSG:102113"]=a["EPSG:3857"]}},{}],36:[function(a,b,c){var _mproj4_=a("./core");_mproj4_.defaultDatum="WGS84",_mproj4_.Proj=a("./Proj"),_mproj4_.WGS84=new _mproj4_.Proj("WGS84"),_mproj4_.Point=a("./Point"),_mproj4_.toPoint=a("./common/toPoint"),_mproj4_.defs=a("./defs"),_mproj4_.transform=a("./transform"),_mproj4_.mgrs=a("mgrs"),_mproj4_.version=a("../package.json").version,a("./includedProjections")(_mproj4_),b.exports=_mproj4_},{"../package.json":69,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":29,"./defs":32,"./includedProjections":"Pk/iAZ","./transform":66,mgrs:68}],37:[function(a,b,c){function d(a){return"string"==typeof a}function e(a){return a in i}function f(a){var b=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return b.reduce(function(b,c){return b+1+a.indexOf(c)},0)}function g(a){return"+"===a[0]}function h(a){return d(a)?e(a)?i[a]:f(a)?j(a):g(a)?k(a):void 0:a}var i=a("./defs"),j=a("./wkt"),k=a("./projString");b.exports=h},{"./defs":32,"./projString":38,"./wkt":67}],38:[function(a,b,c){var d=.017453292519943295,e=a("./constants/PrimeMeridian"),f=a("./constants/units");b.exports=function(a){var b={},c={};a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).forEach(function(a){var b=a.split("=");b.push(!0),c[b[0].toLowerCase()]=b[1]});var g,h,i,j={proj:"projName",datum:"datumCode",rf:function(a){b.rf=parseFloat(a)},lat_0:function(a){b.lat0=a*d},lat_1:function(a){b.lat1=a*d},lat_2:function(a){b.lat2=a*d},lat_ts:function(a){b.lat_ts=a*d},lon_0:function(a){b.long0=a*d},lon_1:function(a){b.long1=a*d},lon_2:function(a){b.long2=a*d},alpha:function(a){b.alpha=parseFloat(a)*d},lonc:function(a){b.longc=a*d},x_0:function(a){b.x0=parseFloat(a)},y_0:function(a){b.y0=parseFloat(a)},k_0:function(a){b.k0=parseFloat(a)},k:function(a){b.k0=parseFloat(a)},a:function(a){b.a=parseFloat(a)},b:function(a){b.b=parseFloat(a)},r_a:function(){b.R_A=!0},zone:function(a){b.zone=parseInt(a,10)},south:function(){b.utmSouth=!0},towgs84:function(a){b.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){b.to_meter=parseFloat(a)},units:function(a){b.units=a,f[a]&&(b.to_meter=f[a].to_meter)},from_greenwich:function(a){b.from_greenwich=a*d},pm:function(a){b.from_greenwich=(e[a]?e[a]:parseFloat(a))*d},nadgrids:function(a){"@null"===a?b.datumCode="none":b.nadgrids=a},axis:function(a){var c="ewnsud";3===a.length&&-1!==c.indexOf(a.substr(0,1))&&-1!==c.indexOf(a.substr(1,1))&&-1!==c.indexOf(a.substr(2,1))&&(b.axis=a)}};for(g in c)h=c[g],g in j?(i=j[g],"function"==typeof i?i(h):b[i]=h):b[g]=h;return"string"==typeof b.datumCode&&"WGS84"!==b.datumCode&&(b.datumCode=b.datumCode.toLowerCase()),b}},{"./constants/PrimeMeridian":27,"./constants/units":28}],39:[function(a,b,c){function d(a,b){var c=g.length;return a.names?(g[c]=a,a.names.forEach(function(a){f[a.toLowerCase()]=c}),this):(console.log(b),!0)}var e=[a("./projections/merc"),a("./projections/longlat")],f={},g=[];c.add=d,c.get=function(a){if(!a)return!1;var b=a.toLowerCase();return"undefined"!=typeof f[b]&&g[f[b]]?g[f[b]]:void 0},c.start=function(){e.forEach(d)}},{"./projections/longlat":52,"./projections/merc":53}],40:[function(a,b,c){var d=1e-10,e=a("../common/msfnz"),f=a("../common/qsfnz"),g=a("../common/adjust_lon"),h=a("../common/asinz");c.init=function(){Math.abs(this.lat1+this.lat2)<d||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=e(this.e3,this.sin_po,this.cos_po),this.qs1=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=e(this.e3,this.sin_po,this.cos_po),this.qs2=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=f(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>d?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},c.forward=function(a){var b=a.x,c=a.y;this.sin_phi=Math.sin(c),this.cos_phi=Math.cos(c);var d=f(this.e3,this.sin_phi,this.cos_phi),e=this.a*Math.sqrt(this.c-this.ns0*d)/this.ns0,h=this.ns0*g(b-this.long0),i=e*Math.sin(h)+this.x0,j=this.rh-e*Math.cos(h)+this.y0;return a.x=i,a.y=j,a},c.inverse=function(a){var b,c,d,e,f,h;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,this.ns0>=0?(b=Math.sqrt(a.x*a.x+a.y*a.y),d=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),d=-1),e=0,0!==b&&(e=Math.atan2(d*a.x,d*a.y)),d=b*this.ns0/this.a,this.sphere?h=Math.asin((this.c-d*d)/(2*this.ns0)):(c=(this.c-d*d)/this.ns0,h=this.phi1z(this.e3,c)),f=g(e/this.ns0+this.long0),a.x=f,a.y=h,a},c.phi1z=function(a,b){var c,e,f,g,i,j=h(.5*b);if(d>a)return j;for(var k=a*a,l=1;25>=l;l++)if(c=Math.sin(j),e=Math.cos(j),f=a*c,g=1-f*f,i=.5*g*g/e*(b/(1-k)-c/g+.5/a*Math.log((1-f)/(1+f))),j+=i,Math.abs(i)<=1e-7)return j;return null},c.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],41:[function(a,b,c){var d=a("../common/adjust_lon"),e=Math.PI/2,f=1e-10,g=a("../common/mlfn"),h=a("../common/e0fn"),i=a("../common/e1fn"),j=a("../common/e2fn"),k=a("../common/e3fn"),l=a("../common/gN"),m=a("../common/asinz"),n=a("../common/imlfn");c.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},c.forward=function(a){var b,c,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=a.x,I=a.y,J=Math.sin(a.y),K=Math.cos(a.y),L=d(H-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=f?(a.x=this.x0+this.a*(e-I)*Math.sin(L),a.y=this.y0-this.a*(e-I)*Math.cos(L),a):Math.abs(this.sin_p12+1)<=f?(a.x=this.x0+this.a*(e+I)*Math.sin(L),a.y=this.y0+this.a*(e+I)*Math.cos(L),a):(B=this.sin_p12*J+this.cos_p12*K*Math.cos(L),z=Math.acos(B),A=z/Math.sin(z),a.x=this.x0+this.a*A*K*Math.sin(L),a.y=this.y0+this.a*A*(this.cos_p12*J-this.sin_p12*K*Math.cos(L)),a):(b=h(this.es),c=i(this.es),m=j(this.es),n=k(this.es),Math.abs(this.sin_p12-1)<=f?(o=this.a*g(b,c,m,n,e),p=this.a*g(b,c,m,n,I),a.x=this.x0+(o-p)*Math.sin(L),a.y=this.y0-(o-p)*Math.cos(L),a):Math.abs(this.sin_p12+1)<=f?(o=this.a*g(b,c,m,n,e),p=this.a*g(b,c,m,n,I),a.x=this.x0+(o+p)*Math.sin(L),a.y=this.y0+(o+p)*Math.cos(L),a):(q=J/K,r=l(this.a,this.e,this.sin_p12),s=l(this.a,this.e,J),t=Math.atan((1-this.es)*q+this.es*r*this.sin_p12/(s*K)),u=Math.atan2(Math.sin(L),this.cos_p12*Math.tan(t)-this.sin_p12*Math.cos(L)),C=0===u?Math.asin(this.cos_p12*Math.sin(t)-this.sin_p12*Math.cos(t)):Math.abs(Math.abs(u)-Math.PI)<=f?-Math.asin(this.cos_p12*Math.sin(t)-this.sin_p12*Math.cos(t)):Math.asin(Math.sin(L)*Math.cos(t)/Math.sin(u)),v=this.e*this.sin_p12/Math.sqrt(1-this.es),w=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es),x=v*w,y=w*w,D=C*C,E=D*C,F=E*C,G=F*C,z=r*C*(1-D*y*(1-y)/6+E/8*x*(1-2*y)+F/120*(y*(4-7*y)-3*v*v*(1-7*y))-G/48*x),a.x=this.x0+z*Math.sin(u),a.y=this.y0+z*Math.cos(u),a))},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;if(this.sphere){if(b=Math.sqrt(a.x*a.x+a.y*a.y),b>2*e*this.a)return;return c=b/this.a,o=Math.sin(c),p=Math.cos(c),q=this.long0,Math.abs(b)<=f?r=this.lat0:(r=m(p*this.sin_p12+a.y*o*this.cos_p12/b),s=Math.abs(this.lat0)-e,q=d(Math.abs(s)<=f?this.lat0>=0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y):this.long0+Math.atan2(a.x*o,b*this.cos_p12*p-a.y*this.sin_p12*o))),a.x=q,a.y=r,a}return t=h(this.es),u=i(this.es),v=j(this.es),w=k(this.es),Math.abs(this.sin_p12-1)<=f?(x=this.a*g(t,u,v,w,e),b=Math.sqrt(a.x*a.x+a.y*a.y),y=x-b,r=n(y/this.a,t,u,v,w),q=d(this.long0+Math.atan2(a.x,-1*a.y)),a.x=q,a.y=r,a):Math.abs(this.sin_p12+1)<=f?(x=this.a*g(t,u,v,w,e),b=Math.sqrt(a.x*a.x+a.y*a.y),y=b-x,r=n(y/this.a,t,u,v,w),q=d(this.long0+Math.atan2(a.x,a.y)),a.x=q,a.y=r,a):(b=Math.sqrt(a.x*a.x+a.y*a.y),B=Math.atan2(a.x,a.y),z=l(this.a,this.e,this.sin_p12),C=Math.cos(B),D=this.e*this.cos_p12*C,E=-D*D/(1-this.es),F=3*this.es*(1-E)*this.sin_p12*this.cos_p12*C/(1-this.es),G=b/z,H=G-E*(1+E)*Math.pow(G,3)/6-F*(1+3*E)*Math.pow(G,4)/24,I=1-E*H*H/2-G*H*H*H/6,A=Math.asin(this.sin_p12*Math.cos(H)+this.cos_p12*Math.sin(H)*C),q=d(this.long0+Math.asin(Math.sin(B)*Math.sin(H)/Math.cos(A))),r=Math.atan((1-this.es*I*this.sin_p12/Math.sin(A))*Math.tan(A)/(1-this.es)),a.x=q,a.y=r,a)},c.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(a,b,c){var d=a("../common/mlfn"),e=a("../common/e0fn"),f=a("../common/e1fn"),g=a("../common/e2fn"),h=a("../common/e3fn"),i=a("../common/gN"),j=a("../common/adjust_lon"),k=a("../common/adjust_lat"),l=a("../common/imlfn"),m=Math.PI/2,n=1e-10;c.init=function(){this.sphere||(this.e0=e(this.es),this.e1=f(this.es),this.e2=g(this.es),this.e3=h(this.es),this.ml0=this.a*d(this.e0,this.e1,this.e2,this.e3,this.lat0))},c.forward=function(a){var b,c,e=a.x,f=a.y;if(e=j(e-this.long0),this.sphere)b=this.a*Math.asin(Math.cos(f)*Math.sin(e)),c=this.a*(Math.atan2(Math.tan(f),Math.cos(e))-this.lat0);else{var g=Math.sin(f),h=Math.cos(f),k=i(this.a,this.e,g),l=Math.tan(f)*Math.tan(f),m=e*Math.cos(f),n=m*m,o=this.es*h*h/(1-this.es),p=this.a*d(this.e0,this.e1,this.e2,this.e3,f);b=k*m*(1-n*l*(1/6-(8-l+8*o)*n/120)),c=p-this.ml0+k*g/h*n*(.5+(5-l+6*o)*n/24)}return a.x=b+this.x0,a.y=c+this.y0,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,d=a.x/this.a,e=a.y/this.a;if(this.sphere){var f=e+this.lat0;b=Math.asin(Math.sin(f)*Math.cos(d)),c=Math.atan2(Math.tan(d),Math.cos(f))}else{var g=this.ml0/this.a+e,h=l(g,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(h)-m)<=n)return a.x=this.long0,a.y=m,0>e&&(a.y*=-1),a;var o=i(this.a,this.e,Math.sin(h)),p=o*o*o/this.a/this.a*(1-this.es),q=Math.pow(Math.tan(h),2),r=d*this.a/o,s=r*r;b=h-o*Math.tan(h)/p*r*r*(.5-(1+3*q)*r*r/24),c=r*(1-s*(q/3+(1+3*q)*q*s/15))/Math.cos(h)}return a.x=j(c+this.long0),a.y=k(b),a},c.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],43:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/qsfnz"),f=a("../common/msfnz"),g=a("../common/iqsfnz");c.init=function(){this.sphere||(this.k0=f(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},c.forward=function(a){var b,c,f=a.x,g=a.y,h=d(f-this.long0);if(this.sphere)b=this.x0+this.a*h*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(g)/Math.cos(this.lat_ts);else{var i=e(this.e,Math.sin(g));b=this.x0+this.a*this.k0*h,c=this.y0+this.a*i*.5/this.k0}return a.x=b,a.y=c,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c;return this.sphere?(b=d(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(c=g(this.e,2*a.y*this.k0/this.a),b=d(this.long0+a.x/(this.a*this.k0))),a.x=b,a.y=c,a},c.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],44:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/adjust_lat");c.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},c.forward=function(a){var b=a.x,c=a.y,f=d(b-this.long0),g=e(c-this.lat0);return a.x=this.x0+this.a*f*this.rc,a.y=this.y0+this.a*g,a},c.inverse=function(a){var b=a.x,c=a.y;return a.x=d(this.long0+(b-this.x0)/(this.a*this.rc)),a.y=e(this.lat0+(c-this.y0)/this.a),a},c.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],45:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/msfnz"),i=a("../common/mlfn"),j=a("../common/adjust_lon"),k=a("../common/adjust_lat"),l=a("../common/imlfn"),m=1e-10;c.init=function(){Math.abs(this.lat1+this.lat2)<m||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=h(this.e,this.sinphi,this.cosphi),this.ml1=i(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<m?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=h(this.e,this.sinphi,this.cosphi),this.ml2=i(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=i(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},c.forward=function(a){var b,c=a.x,d=a.y;if(this.sphere)b=this.a*(this.g-d);else{var e=i(this.e0,this.e1,this.e2,this.e3,d);b=this.a*(this.g-e)}var f=this.ns*j(c-this.long0),g=this.x0+b*Math.sin(f),h=this.y0+this.rh-b*Math.cos(f);return a.x=g,a.y=h,a},c.inverse=function(a){a.x-=this.x0,a.y=this.rh-a.y+this.y0;var b,c,d,e;this.ns>=0?(c=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(c=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);var f=0;if(0!==c&&(f=Math.atan2(b*a.x,b*a.y)),this.sphere)return e=j(this.long0+f/this.ns),d=k(this.g-c/this.a),a.x=e,a.y=d,a;var g=this.g-c/this.a;return d=l(g,this.e0,this.e1,this.e2,this.e3),e=j(this.long0+f/this.ns),a.x=e,a.y=d,a},c.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],46:[function(a,b,c){var d=Math.PI/4,e=a("../common/srat"),f=Math.PI/2,g=20;c.init=function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0);b*=b,this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a),this.C=Math.sqrt(1+this.es*b*b/(1-this.es)),this.phic0=Math.asin(a/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+d)/(Math.pow(Math.tan(.5*this.lat0+d),this.C)*e(this.e*a,this.ratexp))},c.forward=function(a){var b=a.x,c=a.y;return a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*c+d),this.C)*e(this.e*Math.sin(c),this.ratexp))-f,a.x=this.C*b,a},c.inverse=function(a){for(var b=1e-14,c=a.x/this.C,h=a.y,i=Math.pow(Math.tan(.5*h+d)/this.K,1/this.C),j=g;j>0&&(h=2*Math.atan(i*e(this.e*Math.sin(a.y),-.5*this.e))-f,!(Math.abs(h-a.y)<b));--j)a.y=h;return j?(a.x=c,a.y=h,a):null},c.names=["gauss"]},{"../common/srat":22}],47:[function(a,b,c){function d(a){return a;
}c.init=function(){this.isGeocent=!0},c.forward=d,c.inverse=d,c.names=["geocent"]},{}],48:[function(a,b,c){var d=a("../common/adjust_lon"),e=1e-10,f=a("../common/asinz");c.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},c.forward=function(a){var b,c,f,g,h,i,j,k,l=a.x,m=a.y;return f=d(l-this.long0),b=Math.sin(m),c=Math.cos(m),g=Math.cos(f),i=this.sin_p14*b+this.cos_p14*c*g,h=1,i>0||Math.abs(i)<=e?(j=this.x0+this.a*h*c*Math.sin(f)/i,k=this.y0+this.a*h*(this.cos_p14*b-this.sin_p14*c*g)/i):(j=this.x0+this.infinity_dist*c*Math.sin(f),k=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*c*g)),a.x=j,a.y=k,a},c.inverse=function(a){var b,c,e,g,h,i;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(b=Math.sqrt(a.x*a.x+a.y*a.y))?(g=Math.atan2(b,this.rc),c=Math.sin(g),e=Math.cos(g),i=f(e*this.sin_p14+a.y*c*this.cos_p14/b),h=Math.atan2(a.x*c,b*this.cos_p14*e-a.y*this.sin_p14*c),h=d(this.long0+h)):(i=this.phic0,h=0),a.x=h,a.y=i,a},c.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],49:[function(a,b,c){var d=a("../common/adjust_lon");c.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},c.forward=function(a){var b,c,e,f,g,h,i,j=a.x,k=a.y,l=d(j-this.long0);return b=Math.pow((1+this.e*Math.sin(k))/(1-this.e*Math.sin(k)),this.alfa*this.e/2),c=2*(Math.atan(this.k*Math.pow(Math.tan(k/2+this.s45),this.alfa)/b)-this.s45),e=-l*this.alfa,f=Math.asin(Math.cos(this.ad)*Math.sin(c)+Math.sin(this.ad)*Math.cos(c)*Math.cos(e)),g=Math.asin(Math.cos(c)*Math.sin(e)/Math.cos(f)),h=this.n*g,i=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(f/2+this.s45),this.n),a.y=i*Math.cos(h)/1,a.x=i*Math.sin(h)/1,this.czech||(a.y*=-1,a.x*=-1),a},c.inverse=function(a){var b,c,d,e,f,g,h,i,j=a.x;a.x=a.y,a.y=j,this.czech||(a.y*=-1,a.x*=-1),g=Math.sqrt(a.x*a.x+a.y*a.y),f=Math.atan2(a.y,a.x),e=f/Math.sin(this.s0),d=2*(Math.atan(Math.pow(this.ro0/g,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),b=Math.asin(Math.cos(this.ad)*Math.sin(d)-Math.sin(this.ad)*Math.cos(d)*Math.cos(e)),c=Math.asin(Math.cos(d)*Math.sin(e)/Math.cos(b)),a.x=this.long0-c/this.alfa,h=b,i=0;var k=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.e/2))-this.s45),Math.abs(h-a.y)<1e-10&&(i=1),h=a.y,k+=1;while(0===i&&15>k);return k>=15?null:a},c.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],50:[function(a,b,c){var d=Math.PI/2,e=Math.PI/4,f=1e-10,g=a("../common/qsfnz"),h=a("../common/adjust_lon");c.S_POLE=1,c.N_POLE=2,c.EQUIT=3,c.OBLIQ=4,c.init=function(){var a=Math.abs(this.lat0);if(Math.abs(a-d)<f?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(a)<f?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var b;switch(this.qp=g(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),b=Math.sin(this.lat0),this.sinb1=g(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},c.forward=function(a){var b,c,i,j,k,l,m,n,o,p,q=a.x,r=a.y;if(q=h(q-this.long0),this.sphere){if(k=Math.sin(r),p=Math.cos(r),i=Math.cos(q),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c=this.mode===this.EQUIT?1+p*i:1+this.sinph0*k+this.cosph0*p*i,f>=c)return null;c=Math.sqrt(2/c),b=c*p*Math.sin(q),c*=this.mode===this.EQUIT?k:this.cosph0*k-this.sinph0*p*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(r+this.phi0)<f)return null;c=e-.5*r,c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c)),b=c*Math.sin(q),c*=i}}else{switch(m=0,n=0,o=0,i=Math.cos(q),j=Math.sin(q),k=Math.sin(r),l=g(this.e,k),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=l/this.qp,n=Math.sqrt(1-m*m)),this.mode){case this.OBLIQ:o=1+this.sinb1*m+this.cosb1*n*i;break;case this.EQUIT:o=1+n*i;break;case this.N_POLE:o=d+r,l=this.qp-l;break;case this.S_POLE:o=r-d,l=this.qp+l}if(Math.abs(o)<f)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:o=Math.sqrt(2/o),c=this.mode===this.OBLIQ?this.ymf*o*(this.cosb1*m-this.sinb1*n*i):(o=Math.sqrt(2/(1+n*i)))*m*this.ymf,b=this.xmf*o*n*j;break;case this.N_POLE:case this.S_POLE:l>=0?(b=(o=Math.sqrt(l))*j,c=i*(this.mode===this.S_POLE?o:-o)):b=c=0}}return a.x=this.a*b+this.x0,a.y=this.a*c+this.y0,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,e,g,i,j,k,l=a.x/this.a,m=a.y/this.a;if(this.sphere){var n,o=0,p=0;if(n=Math.sqrt(l*l+m*m),c=.5*n,c>1)return null;switch(c=2*Math.asin(c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(p=Math.sin(c),o=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(n)<=f?0:Math.asin(m*p/n),l*=p,m=o*n;break;case this.OBLIQ:c=Math.abs(n)<=f?this.phi0:Math.asin(o*this.sinph0+m*p*this.cosph0/n),l*=p*this.cosph0,m=(o-Math.sin(c)*this.sinph0)*n;break;case this.N_POLE:m=-m,c=d-c;break;case this.S_POLE:c-=d}b=0!==m||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,m):0}else{if(k=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,m*=this.dd,j=Math.sqrt(l*l+m*m),f>j)return a.x=0,a.y=this.phi0,a;g=2*Math.asin(.5*j/this.rq),e=Math.cos(g),l*=g=Math.sin(g),this.mode===this.OBLIQ?(k=e*this.sinb1+m*g*this.cosb1/j,i=this.qp*k,m=j*this.cosb1*e-m*this.sinb1*g):(k=m*g/j,i=this.qp*k,m=j*e)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(m=-m),i=l*l+m*m,!i)return a.x=0,a.y=this.phi0,a;k=1-i/this.qp,this.mode===this.S_POLE&&(k=-k)}b=Math.atan2(l,m),c=this.authlat(Math.asin(k),this.apa)}return a.x=h(this.long0+b),a.y=c,a},c.P00=.3333333333333333,c.P01=.17222222222222222,c.P02=.10257936507936508,c.P10=.06388888888888888,c.P11=.0664021164021164,c.P20=.016415012942191543,c.authset=function(a){var b,c=[];return c[0]=a*this.P00,b=a*a,c[0]+=b*this.P01,c[1]=b*this.P10,b*=a,c[0]+=b*this.P02,c[1]+=b*this.P11,c[2]=b*this.P20,c},c.authlat=function(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)},c.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],51:[function(a,b,c){var d=1e-10,e=a("../common/msfnz"),f=a("../common/tsfnz"),g=Math.PI/2,h=a("../common/sign"),i=a("../common/adjust_lon"),j=a("../common/phi2z");c.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<d)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var b=Math.sin(this.lat1),c=Math.cos(this.lat1),g=e(this.e,b,c),h=f(this.e,this.lat1,b),i=Math.sin(this.lat2),j=Math.cos(this.lat2),k=e(this.e,i,j),l=f(this.e,this.lat2,i),m=f(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>d?this.ns=Math.log(g/k)/Math.log(h/l):this.ns=b,isNaN(this.ns)&&(this.ns=b),this.f0=g/(this.ns*Math.pow(h,this.ns)),this.rh=this.a*this.f0*Math.pow(m,this.ns),this.title||(this.title="Lambert Conformal Conic")}},c.forward=function(a){var b=a.x,c=a.y;Math.abs(2*Math.abs(c)-Math.PI)<=d&&(c=h(c)*(g-2*d));var e,j,k=Math.abs(Math.abs(c)-g);if(k>d)e=f(this.e,c,Math.sin(c)),j=this.a*this.f0*Math.pow(e,this.ns);else{if(k=c*this.ns,0>=k)return null;j=0}var l=this.ns*i(b-this.long0);return a.x=this.k0*(j*Math.sin(l))+this.x0,a.y=this.k0*(this.rh-j*Math.cos(l))+this.y0,a},c.inverse=function(a){var b,c,d,e,f,h=(a.x-this.x0)/this.k0,k=this.rh-(a.y-this.y0)/this.k0;this.ns>0?(b=Math.sqrt(h*h+k*k),c=1):(b=-Math.sqrt(h*h+k*k),c=-1);var l=0;if(0!==b&&(l=Math.atan2(c*h,c*k)),0!==b||this.ns>0){if(c=1/this.ns,d=Math.pow(b/(this.a*this.f0),c),e=j(this.e,d),-9999===e)return null}else e=-g;return f=i(l/this.ns+this.long0),a.x=f,a.y=e,a},c.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],52:[function(a,b,c){function d(a){return a}c.init=function(){},c.forward=d,c.inverse=d,c.names=["longlat","identity"]},{}],53:[function(a,b,c){var d=a("../common/msfnz"),e=Math.PI/2,f=1e-10,g=57.29577951308232,h=a("../common/adjust_lon"),i=Math.PI/4,j=a("../common/tsfnz"),k=a("../common/phi2z");c.init=function(){var a=this.b/this.a;this.es=1-a*a,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=d(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},c.forward=function(a){var b=a.x,c=a.y;if(c*g>90&&-90>c*g&&b*g>180&&-180>b*g)return null;var d,k;if(Math.abs(Math.abs(c)-e)<=f)return null;if(this.sphere)d=this.x0+this.a*this.k0*h(b-this.long0),k=this.y0+this.a*this.k0*Math.log(Math.tan(i+.5*c));else{var l=Math.sin(c),m=j(this.e,c,l);d=this.x0+this.a*this.k0*h(b-this.long0),k=this.y0-this.a*this.k0*Math.log(m)}return a.x=d,a.y=k,a},c.inverse=function(a){var b,c,d=a.x-this.x0,f=a.y-this.y0;if(this.sphere)c=e-2*Math.atan(Math.exp(-f/(this.a*this.k0)));else{var g=Math.exp(-f/(this.a*this.k0));if(c=k(this.e,g),-9999===c)return null}return b=h(this.long0+d/(this.a*this.k0)),a.x=b,a.y=c,a},c.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],54:[function(a,b,c){var d=a("../common/adjust_lon");c.init=function(){},c.forward=function(a){var b=a.x,c=a.y,e=d(b-this.long0),f=this.x0+this.a*e,g=this.y0+this.a*Math.log(Math.tan(Math.PI/4+c/2.5))*1.25;return a.x=f,a.y=g,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b=d(this.long0+a.x/this.a),c=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=b,a.y=c,a},c.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],55:[function(a,b,c){var d=a("../common/adjust_lon"),e=1e-10;c.init=function(){},c.forward=function(a){for(var b=a.x,c=a.y,f=d(b-this.long0),g=c,h=Math.PI*Math.sin(c),i=0;!0;i++){var j=-(g+Math.sin(g)-h)/(1+Math.cos(g));if(g+=j,Math.abs(j)<e)break}g/=2,Math.PI/2-Math.abs(c)<e&&(f=0);var k=.900316316158*this.a*f*Math.cos(g)+this.x0,l=1.4142135623731*this.a*Math.sin(g)+this.y0;return a.x=k,a.y=l,a},c.inverse=function(a){var b,c;a.x-=this.x0,a.y-=this.y0,c=a.y/(1.4142135623731*this.a),Math.abs(c)>.999999999999&&(c=.999999999999),b=Math.asin(c);var e=d(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));e<-Math.PI&&(e=-Math.PI),e>Math.PI&&(e=Math.PI),c=(2*b+Math.sin(2*b))/Math.PI,Math.abs(c)>1&&(c=1);var f=Math.asin(c);return a.x=e,a.y=f,a},c.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],56:[function(a,b,c){var d=484813681109536e-20;c.iterations=1,c.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},c.forward=function(a){var b,c=a.x,e=a.y,f=e-this.lat0,g=c-this.long0,h=f/d*1e-5,i=g,j=1,k=0;for(b=1;10>=b;b++)j*=h,k+=this.A[b]*j;var l,m,n=k,o=i,p=1,q=0,r=0,s=0;for(b=1;6>=b;b++)l=p*n-q*o,m=q*n+p*o,p=l,q=m,r=r+this.B_re[b]*p-this.B_im[b]*q,s=s+this.B_im[b]*p+this.B_re[b]*q;return a.x=s*this.a+this.x0,a.y=r*this.a+this.y0,a},c.inverse=function(a){var b,c,e,f=a.x,g=a.y,h=f-this.x0,i=g-this.y0,j=i/this.a,k=h/this.a,l=1,m=0,n=0,o=0;for(b=1;6>=b;b++)c=l*j-m*k,e=m*j+l*k,l=c,m=e,n=n+this.C_re[b]*l-this.C_im[b]*m,o=o+this.C_im[b]*l+this.C_re[b]*m;for(var p=0;p<this.iterations;p++){var q,r,s=n,t=o,u=j,v=k;for(b=2;6>=b;b++)q=s*n-t*o,r=t*n+s*o,s=q,t=r,u+=(b-1)*(this.B_re[b]*s-this.B_im[b]*t),v+=(b-1)*(this.B_im[b]*s+this.B_re[b]*t);s=1,t=0;var w=this.B_re[1],x=this.B_im[1];for(b=2;6>=b;b++)q=s*n-t*o,r=t*n+s*o,s=q,t=r,w+=b*(this.B_re[b]*s-this.B_im[b]*t),x+=b*(this.B_im[b]*s+this.B_re[b]*t);var y=w*w+x*x;n=(u*w+v*x)/y,o=(v*w-u*x)/y}var z=n,A=o,B=1,C=0;for(b=1;9>=b;b++)B*=z,C+=this.D[b]*B;var D=this.lat0+C*d*1e5,E=this.long0+A;return a.x=E,a.y=D,a},c.names=["New_Zealand_Map_Grid","nzmg"]},{}],57:[function(a,b,c){var d=a("../common/tsfnz"),e=a("../common/adjust_lon"),f=a("../common/phi2z"),g=Math.PI/2,h=Math.PI/4,i=1e-10;c.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),c=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-c*c);var f=d(this.e,this.lat0,a),g=this.bl/b*Math.sqrt((1-this.es)/(1-c*c));1>g*g&&(g=1);var h,i;if(isNaN(this.longc)){var j=d(this.e,this.lat1,Math.sin(this.lat1)),k=d(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(g+Math.sqrt(g*g-1))*Math.pow(f,this.bl):this.el=(g-Math.sqrt(g*g-1))*Math.pow(f,this.bl);var l=Math.pow(j,this.bl),m=Math.pow(k,this.bl);h=this.el/l,i=.5*(h-1/h);var n=(this.el*this.el-m*l)/(this.el*this.el+m*l),o=(m-l)/(m+l),p=e(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(n*Math.tan(.5*this.bl*p)/o)/this.bl,this.long0=e(this.long0);var q=e(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*q)/i),this.alpha=Math.asin(g*Math.sin(this.gamma0))}else h=this.lat0>=0?g+Math.sqrt(g*g-1):g-Math.sqrt(g*g-1),this.el=h*Math.pow(f,this.bl),i=.5*(h-1/h),this.gamma0=Math.asin(Math.sin(this.alpha)/g),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(g*g-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(g*g-1),Math.cos(this.alpha))},c.forward=function(a){var b,c,f,j=a.x,k=a.y,l=e(j-this.long0);if(Math.abs(Math.abs(k)-g)<=i)f=k>0?-1:1,c=this.al/this.bl*Math.log(Math.tan(h+f*this.gamma0*.5)),b=-1*f*g*this.al/this.bl;else{var m=d(this.e,k,Math.sin(k)),n=this.el/Math.pow(m,this.bl),o=.5*(n-1/n),p=.5*(n+1/n),q=Math.sin(this.bl*l),r=(o*Math.sin(this.gamma0)-q*Math.cos(this.gamma0))/p;c=Math.abs(Math.abs(r)-1)<=i?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-r)/(1+r))/this.bl,b=Math.abs(Math.cos(this.bl*l))<=i?this.al*this.bl*l:this.al*Math.atan2(o*Math.cos(this.gamma0)+q*Math.sin(this.gamma0),Math.cos(this.bl*l))/this.bl}return this.no_rot?(a.x=this.x0+b,a.y=this.y0+c):(b-=this.uc,a.x=this.x0+c*Math.cos(this.alpha)+b*Math.sin(this.alpha),a.y=this.y0+b*Math.cos(this.alpha)-c*Math.sin(this.alpha)),a},c.inverse=function(a){var b,c;this.no_rot?(c=a.y-this.y0,b=a.x-this.x0):(c=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var d=Math.exp(-1*this.bl*c/this.al),h=.5*(d-1/d),j=.5*(d+1/d),k=Math.sin(this.bl*b/this.al),l=(k*Math.cos(this.gamma0)+h*Math.sin(this.gamma0))/j,m=Math.pow(this.el/Math.sqrt((1+l)/(1-l)),1/this.bl);return Math.abs(l-1)<i?(a.x=this.long0,a.y=g):Math.abs(l+1)<i?(a.x=this.long0,a.y=-1*g):(a.y=f(this.e,m),a.x=e(this.long0-Math.atan2(h*Math.cos(this.gamma0)-k*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl)),a},c.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],58:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/adjust_lon"),i=a("../common/adjust_lat"),j=a("../common/mlfn"),k=1e-10,l=a("../common/gN"),m=20;c.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.ml0=this.a*j(this.e0,this.e1,this.e2,this.e3,this.lat0)},c.forward=function(a){var b,c,d,e=a.x,f=a.y,g=h(e-this.long0);if(d=g*Math.sin(f),this.sphere)Math.abs(f)<=k?(b=this.a*g,c=-1*this.a*this.lat0):(b=this.a*Math.sin(d)/Math.tan(f),c=this.a*(i(f-this.lat0)+(1-Math.cos(d))/Math.tan(f)));else if(Math.abs(f)<=k)b=this.a*g,c=-1*this.ml0;else{var m=l(this.a,this.e,Math.sin(f))/Math.tan(f);b=m*Math.sin(d),c=this.a*j(this.e0,this.e1,this.e2,this.e3,f)-this.ml0+m*(1-Math.cos(d))}return a.x=b+this.x0,a.y=c+this.y0,a},c.inverse=function(a){var b,c,d,e,f,g,i,l,n;if(d=a.x-this.x0,e=a.y-this.y0,this.sphere)if(Math.abs(e+this.a*this.lat0)<=k)b=h(d/this.a+this.long0),c=0;else{g=this.lat0+e/this.a,i=d*d/this.a/this.a+g*g,l=g;var o;for(f=m;f;--f)if(o=Math.tan(l),n=-1*(g*(l*o+1)-l-.5*(l*l+i)*o)/((l-g)/o-1),l+=n,Math.abs(n)<=k){c=l;break}b=h(this.long0+Math.asin(d*Math.tan(l)/this.a)/Math.sin(c))}else if(Math.abs(e+this.ml0)<=k)c=0,b=h(this.long0+d/this.a);else{g=(this.ml0+e)/this.a,i=d*d/this.a/this.a+g*g,l=g;var p,q,r,s,t;for(f=m;f;--f)if(t=this.e*Math.sin(l),p=Math.sqrt(1-t*t)*Math.tan(l),q=this.a*j(this.e0,this.e1,this.e2,this.e3,l),r=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),s=q/this.a,n=(g*(p*s+1)-s-.5*p*(s*s+i))/(this.es*Math.sin(2*l)*(s*s+i-2*g*s)/(4*p)+(g-s)*(p*r-2/Math.sin(2*l))-r),l-=n,Math.abs(n)<=k){c=l;break}p=Math.sqrt(1-this.es*Math.pow(Math.sin(c),2))*Math.tan(c),b=h(this.long0+Math.asin(d*p/this.a)/Math.sin(c))}return a.x=b,a.y=c,a},c.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],59:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/adjust_lat"),f=a("../common/pj_enfn"),g=20,h=a("../common/pj_mlfn"),i=a("../common/pj_inv_mlfn"),j=Math.PI/2,k=1e-10,l=a("../common/asinz");c.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=f(this.es)},c.forward=function(a){var b,c,e=a.x,f=a.y;if(e=d(e-this.long0),this.sphere){if(this.m)for(var i=this.n*Math.sin(f),j=g;j;--j){var l=(this.m*f+Math.sin(f)-i)/(this.m+Math.cos(f));if(f-=l,Math.abs(l)<k)break}else f=1!==this.n?Math.asin(this.n*Math.sin(f)):f;b=this.a*this.C_x*e*(this.m+Math.cos(f)),c=this.a*this.C_y*f}else{var m=Math.sin(f),n=Math.cos(f);c=this.a*h(f,m,n,this.en),b=this.a*e*n/Math.sqrt(1-this.es*m*m)}return a.x=b,a.y=c,a},c.inverse=function(a){var b,c,f,g;return a.x-=this.x0,f=a.x/this.a,a.y-=this.y0,b=a.y/this.a,this.sphere?(b/=this.C_y,f/=this.C_x*(this.m+Math.cos(b)),this.m?b=l((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=l(Math.sin(b)/this.n)),f=d(f+this.long0),b=e(b)):(b=i(a.y/this.a,this.es,this.en),g=Math.abs(b),j>g?(g=Math.sin(b),c=this.long0+a.x*Math.sqrt(1-this.es*g*g)/(this.a*Math.cos(b)),f=d(c)):j>g-k&&(f=this.long0)),a.x=f,a.y=b,a},c.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],60:[function(a,b,c){c.init=function(){var a=this.lat0;this.lambda0=this.long0;var b=Math.sin(a),c=this.a,d=this.rf,e=1/d,f=2*e-Math.pow(e,2),g=this.e=Math.sqrt(f);this.R=this.k0*c*Math.sqrt(1-f)/(1-f*Math.pow(b,2)),this.alpha=Math.sqrt(1+f/(1-f)*Math.pow(Math.cos(a),4)),this.b0=Math.asin(b/this.alpha);var h=Math.log(Math.tan(Math.PI/4+this.b0/2)),i=Math.log(Math.tan(Math.PI/4+a/2)),j=Math.log((1+g*b)/(1-g*b));this.K=h-this.alpha*i+this.alpha*g/2*j},c.forward=function(a){var b=Math.log(Math.tan(Math.PI/4-a.y/2)),c=this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))),d=-this.alpha*(b+c)+this.K,e=2*(Math.atan(Math.exp(d))-Math.PI/4),f=this.alpha*(a.x-this.lambda0),g=Math.atan(Math.sin(f)/(Math.sin(this.b0)*Math.tan(e)+Math.cos(this.b0)*Math.cos(f))),h=Math.asin(Math.cos(this.b0)*Math.sin(e)-Math.sin(this.b0)*Math.cos(e)*Math.cos(f));return a.y=this.R/2*Math.log((1+Math.sin(h))/(1-Math.sin(h)))+this.y0,a.x=this.R*g+this.x0,a},c.inverse=function(a){for(var b=a.x-this.x0,c=a.y-this.y0,d=b/this.R,e=2*(Math.atan(Math.exp(c/this.R))-Math.PI/4),f=Math.asin(Math.cos(this.b0)*Math.sin(e)+Math.sin(this.b0)*Math.cos(e)*Math.cos(d)),g=Math.atan(Math.sin(d)/(Math.cos(this.b0)*Math.cos(d)-Math.sin(this.b0)*Math.tan(e))),h=this.lambda0+g/this.alpha,i=0,j=f,k=-1e3,l=0;Math.abs(j-k)>1e-7;){if(++l>20)return;i=1/this.alpha*(Math.log(Math.tan(Math.PI/4+f/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(j))/2)),k=j,j=2*Math.atan(Math.exp(i))-Math.PI/2}return a.x=h,a.y=j,a},c.names=["somerc"]},{}],61:[function(a,b,c){var d=Math.PI/2,e=1e-10,f=a("../common/sign"),g=a("../common/msfnz"),h=a("../common/tsfnz"),i=a("../common/phi2z"),j=a("../common/adjust_lon");c.ssfn_=function(a,b,c){return b*=c,Math.tan(.5*(d+a))*Math.pow((1-b)/(1+b),.5*c)},c.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=e&&(this.k0=.5*(1+f(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=e&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=e&&(this.k0=.5*this.cons*g(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/h(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=g(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-d,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},c.forward=function(a){var b,c,f,g,i,k,l=a.x,m=a.y,n=Math.sin(m),o=Math.cos(m),p=j(l-this.long0);return Math.abs(Math.abs(l-this.long0)-Math.PI)<=e&&Math.abs(m+this.lat0)<=e?(a.x=NaN,a.y=NaN,a):this.sphere?(b=2*this.k0/(1+this.sinlat0*n+this.coslat0*o*Math.cos(p)),a.x=this.a*b*o*Math.sin(p)+this.x0,a.y=this.a*b*(this.coslat0*n-this.sinlat0*o*Math.cos(p))+this.y0,a):(c=2*Math.atan(this.ssfn_(m,n,this.e))-d,g=Math.cos(c),f=Math.sin(c),Math.abs(this.coslat0)<=e?(i=h(this.e,m*this.con,this.con*n),k=2*this.a*this.k0*i/this.cons,a.x=this.x0+k*Math.sin(l-this.long0),a.y=this.y0-this.con*k*Math.cos(l-this.long0),a):(Math.abs(this.sinlat0)<e?(b=2*this.a*this.k0/(1+g*Math.cos(p)),a.y=b*f):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*f+this.cosX0*g*Math.cos(p))),a.y=b*(this.cosX0*f-this.sinX0*g*Math.cos(p))+this.y0),a.x=b*g*Math.sin(p)+this.x0,a))},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,f,g,h,k=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){var l=2*Math.atan(k/(.5*this.a*this.k0));return b=this.long0,c=this.lat0,e>=k?(a.x=b,a.y=c,a):(c=Math.asin(Math.cos(l)*this.sinlat0+a.y*Math.sin(l)*this.coslat0/k),b=j(Math.abs(this.coslat0)<e?this.lat0>0?this.long0+Math.atan2(a.x,-1*a.y):this.long0+Math.atan2(a.x,a.y):this.long0+Math.atan2(a.x*Math.sin(l),k*this.coslat0*Math.cos(l)-a.y*this.sinlat0*Math.sin(l))),a.x=b,a.y=c,a)}if(Math.abs(this.coslat0)<=e){if(e>=k)return c=this.lat0,b=this.long0,a.x=b,a.y=c,a;a.x*=this.con,a.y*=this.con,f=k*this.cons/(2*this.a*this.k0),c=this.con*i(this.e,f),b=this.con*j(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else g=2*Math.atan(k*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,e>=k?h=this.X0:(h=Math.asin(Math.cos(g)*this.sinX0+a.y*Math.sin(g)*this.cosX0/k),b=j(this.long0+Math.atan2(a.x*Math.sin(g),k*this.cosX0*Math.cos(g)-a.y*this.sinX0*Math.sin(g)))),c=-1*i(this.e,Math.tan(.5*(d+h)));return a.x=b,a.y=c,a},c.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],62:[function(a,b,c){var d=a("./gauss"),e=a("../common/adjust_lon");c.init=function(){d.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},c.forward=function(a){var b,c,f,g;return a.x=e(a.x-this.long0),d.forward.apply(this,[a]),b=Math.sin(a.y),c=Math.cos(a.y),f=Math.cos(a.x),g=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*c*f),a.x=g*c*Math.sin(a.x),a.y=g*(this.cosc0*b-this.sinc0*c*f),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a},c.inverse=function(a){var b,c,f,g,h;if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,h=Math.sqrt(a.x*a.x+a.y*a.y)){var i=2*Math.atan2(h,this.R2);b=Math.sin(i),c=Math.cos(i),g=Math.asin(c*this.sinc0+a.y*b*this.cosc0/h),f=Math.atan2(a.x*b,h*this.cosc0*c-a.y*this.sinc0*b)}else g=this.phic0,f=0;return a.x=f,a.y=g,d.inverse.apply(this,[a]),a.x=e(a.x+this.long0),a},c.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":46}],63:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/mlfn"),i=a("../common/adjust_lon"),j=Math.PI/2,k=1e-10,l=a("../common/sign"),m=a("../common/asinz");c.init=function(){this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.ml0=this.a*h(this.e0,this.e1,this.e2,this.e3,this.lat0)},c.forward=function(a){var b,c,d,e=a.x,f=a.y,g=i(e-this.long0),j=Math.sin(f),k=Math.cos(f);if(this.sphere){var l=k*Math.sin(g);if(Math.abs(Math.abs(l)-1)<1e-10)return 93;c=.5*this.a*this.k0*Math.log((1+l)/(1-l)),b=Math.acos(k*Math.cos(g)/Math.sqrt(1-l*l)),0>f&&(b=-b),d=this.a*this.k0*(b-this.lat0)}else{var m=k*g,n=Math.pow(m,2),o=this.ep2*Math.pow(k,2),p=Math.tan(f),q=Math.pow(p,2);b=1-this.es*Math.pow(j,2);var r=this.a/Math.sqrt(b),s=this.a*h(this.e0,this.e1,this.e2,this.e3,f);c=this.k0*r*m*(1+n/6*(1-q+o+n/20*(5-18*q+Math.pow(q,2)+72*o-58*this.ep2)))+this.x0,d=this.k0*(s-this.ml0+r*p*(n*(.5+n/24*(5-q+9*o+4*Math.pow(o,2)+n/30*(61-58*q+Math.pow(q,2)+600*o-330*this.ep2)))))+this.y0}return a.x=c,a.y=d,a},c.inverse=function(a){var b,c,d,e,f,g,h=6;if(this.sphere){var n=Math.exp(a.x/(this.a*this.k0)),o=.5*(n-1/n),p=this.lat0+a.y/(this.a*this.k0),q=Math.cos(p);b=Math.sqrt((1-q*q)/(1+o*o)),f=m(b),0>p&&(f=-f),g=0===o&&0===q?this.long0:i(Math.atan2(o,q)+this.long0)}else{var r=a.x-this.x0,s=a.y-this.y0;for(b=(this.ml0+s/this.k0)/this.a,c=b,e=0;!0&&(d=(b+this.e1*Math.sin(2*c)-this.e2*Math.sin(4*c)+this.e3*Math.sin(6*c))/this.e0-c,c+=d,!(Math.abs(d)<=k));e++)if(e>=h)return 95;if(Math.abs(c)<j){var t=Math.sin(c),u=Math.cos(c),v=Math.tan(c),w=this.ep2*Math.pow(u,2),x=Math.pow(w,2),y=Math.pow(v,2),z=Math.pow(y,2);b=1-this.es*Math.pow(t,2);var A=this.a/Math.sqrt(b),B=A*(1-this.es)/b,C=r/(A*this.k0),D=Math.pow(C,2);f=c-A*v*D/B*(.5-D/24*(5+3*y+10*w-4*x-9*this.ep2-D/30*(61+90*y+298*w+45*z-252*this.ep2-3*x))),g=i(this.long0+C*(1-D/6*(1+2*y+w-D/20*(5-2*w+28*y-3*x+8*this.ep2+24*z)))/u)}else f=j*l(s),g=this.long0}return a.x=g,a.y=f,a},c.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],64:[function(a,b,c){var d=.017453292519943295,e=a("./tmerc");c.dependsOn="tmerc",c.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*d,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,e.init.apply(this),this.forward=e.forward,this.inverse=e.inverse)},c.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":63}],65:[function(a,b,c){var d=a("../common/adjust_lon"),e=Math.PI/2,f=1e-10,g=a("../common/asinz");c.init=function(){this.R=this.a},c.forward=function(a){var b,c,h=a.x,i=a.y,j=d(h-this.long0);Math.abs(i)<=f&&(b=this.x0+this.R*j,c=this.y0);var k=g(2*Math.abs(i/Math.PI));(Math.abs(j)<=f||Math.abs(Math.abs(i)-e)<=f)&&(b=this.x0,c=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*k):this.y0+Math.PI*this.R*-Math.tan(.5*k));var l=.5*Math.abs(Math.PI/j-j/Math.PI),m=l*l,n=Math.sin(k),o=Math.cos(k),p=o/(n+o-1),q=p*p,r=p*(2/n-1),s=r*r,t=Math.PI*this.R*(l*(p-s)+Math.sqrt(m*(p-s)*(p-s)-(s+m)*(q-s)))/(s+m);0>j&&(t=-t),b=this.x0+t;var u=m+p;return t=Math.PI*this.R*(r*u-l*Math.sqrt((s+m)*(m+1)-u*u))/(s+m),c=i>=0?this.y0+t:this.y0-t,a.x=b,a.y=c,a},c.inverse=function(a){var b,c,e,g,h,i,j,k,l,m,n,o,p;return a.x-=this.x0,a.y-=this.y0,n=Math.PI*this.R,e=a.x/n,g=a.y/n,h=e*e+g*g,i=-Math.abs(g)*(1+h),j=i-2*g*g+e*e,k=-2*i+1+2*g*g+h*h,p=g*g/k+(2*j*j*j/k/k/k-9*i*j/k/k)/27,l=(i-j*j/3/k)/k,m=2*Math.sqrt(-l/3),n=3*p/l/m,Math.abs(n)>1&&(n=n>=0?1:-1),o=Math.acos(n)/3,c=a.y>=0?(-m*Math.cos(o+Math.PI/3)-j/3/k)*Math.PI:-(-m*Math.cos(o+Math.PI/3)-j/3/k)*Math.PI,b=Math.abs(e)<f?this.long0:d(this.long0+Math.PI*(h-1+Math.sqrt(1+2*(e*e-g*g)+h*h))/2/e),a.x=b,a.y=c,a},c.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],66:[function(a,b,c){var d=.017453292519943295,e=57.29577951308232,f=1,g=2,h=a("./datum_transform"),i=a("./adjust_axis"),j=a("./Proj"),k=a("./common/toPoint");b.exports=function l(a,b,c){function m(a,b){return(a.datum.datum_type===f||a.datum.datum_type===g)&&"WGS84"!==b.datumCode}var n;return Array.isArray(c)&&(c=k(c)),a.datum&&b.datum&&(m(a,b)||m(b,a))&&(n=new j("WGS84"),l(a,n,c),a=n),"enu"!==a.axis&&i(a,!1,c),"longlat"===a.projName?(c.x*=d,c.y*=d):a.isGeocent?(a.to_meter&&(c.x*=a.to_meter,c.y*=a.to_meter,c.z*=a.to_meter),b.datum.geocentric_to_geodetic_noniter(c)):(a.to_meter&&(c.x*=a.to_meter,c.y*=a.to_meter),a.inverse(c)),a.from_greenwich&&(c.x+=a.from_greenwich),c=h(a.datum,b.datum,c),b.from_greenwich&&(c.x-=b.from_greenwich),"longlat"===b.projName?(c.x*=e,c.y*=e):b.isGeocent?(b.datum.geodetic_to_geocentric(c),b.to_meter&&(c.x/=b.to_meter,c.y/=b.to_meter,c.z/=b.to_meter)):(b.forward(c),b.to_meter&&(c.x/=b.to_meter,c.y/=b.to_meter)),"enu"!==b.axis&&i(b,!0,c),c}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":31}],67:[function(a,b,c){function d(a,b,c){a[b]=c.map(function(a){var b={};return e(a,b),b}).reduce(function(a,b){return j(a,b)},{})}function e(a,b){var c;return Array.isArray(a)?(c=a.shift(),"PARAMETER"===c&&(c=a.shift()),1===a.length?Array.isArray(a[0])?(b[c]={},e(a[0],b[c])):b[c]=a[0]:a.length?"TOWGS84"===c?b[c]=a:(b[c]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(c)>-1?(b[c]={name:a[0].toLowerCase(),convert:a[1]},3===a.length&&(b[c].auth=a[2])):"SPHEROID"===c?(b[c]={name:a[0],a:a[1],rf:a[2]},4===a.length&&(b[c].auth=a[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(c)>-1?(a[0]=["name",a[0]],d(b,c,a)):a.every(function(a){return Array.isArray(a)})?d(b,c,a):e(a,b[c])):b[c]=!0,
void 0):void(b[a]=!0)}function f(a,b){var c=b[0],d=b[1];!(c in a)&&d in a&&(a[c]=a[d],3===b.length&&(a[c]=b[2](a[c])))}function g(a){return a*i}function h(a){function b(b){var c=a.to_meter||1;return parseFloat(b,10)*c}"GEOGCS"===a.type?a.projName="longlat":"LOCAL_CS"===a.type?(a.projName="identity",a.local=!0):"object"==typeof a.PROJECTION?a.projName=Object.keys(a.PROJECTION)[0]:a.projName=a.PROJECTION,a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&(a.to_meter=parseFloat(a.UNIT.convert,10))),a.GEOGCS&&(a.GEOGCS.DATUM?a.datumCode=a.GEOGCS.DATUM.name.toLowerCase():a.datumCode=a.GEOGCS.name.toLowerCase(),"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===a.datumCode||"new_zealand_1949"===a.datumCode)&&(a.datumCode="nzgd49"),"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84"),"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6)),"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8)),~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72"),a.GEOGCS.DATUM&&a.GEOGCS.DATUM.SPHEROID&&(a.ellps=a.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===a.ellps.toLowerCase().slice(0,13)&&(a.ellps="intl"),a.a=a.GEOGCS.DATUM.SPHEROID.a,a.rf=parseFloat(a.GEOGCS.DATUM.SPHEROID.rf,10)),~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36")),a.b&&!isFinite(a.b)&&(a.b=a.a);var c=function(b){return f(a,b)},d=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",g],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",g],["x0","false_easting",b],["y0","false_northing",b],["long0","central_meridian",g],["lat0","latitude_of_origin",g],["lat0","standard_parallel_1",g],["lat1","standard_parallel_1",g],["lat2","standard_parallel_2",g],["alpha","azimuth",g],["srsCode","name"]];d.forEach(c),a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.projName&&"Lambert_Azimuthal_Equal_Area"!==a.projName||(a.long0=a.longc),a.lat_ts||!a.lat1||"Stereographic_South_Pole"!==a.projName&&"Polar Stereographic (variant B)"!==a.projName||(a.lat0=g(a.lat1>0?90:-90),a.lat_ts=a.lat1)}var i=.017453292519943295,j=a("./extend");b.exports=function(a,b){var c=JSON.parse((","+a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),d=c.shift(),f=c.shift();c.unshift(["name",f]),c.unshift(["type",d]),c.unshift("output");var g={};return e(c,g),h(g.output),j(b,g.output)}},{"./extend":34}],68:[function(a,b,c){function d(a){return a*(Math.PI/180)}function e(a){return 180*(a/Math.PI)}function f(a){var b,c,e,f,g,i,j,k,l,m=a.lat,n=a.lon,o=6378137,p=.00669438,q=.9996,r=d(m),s=d(n);l=Math.floor((n+180)/6)+1,180===n&&(l=60),m>=56&&64>m&&n>=3&&12>n&&(l=32),m>=72&&84>m&&(n>=0&&9>n?l=31:n>=9&&21>n?l=33:n>=21&&33>n?l=35:n>=33&&42>n&&(l=37)),b=6*(l-1)-180+3,k=d(b),c=p/(1-p),e=o/Math.sqrt(1-p*Math.sin(r)*Math.sin(r)),f=Math.tan(r)*Math.tan(r),g=c*Math.cos(r)*Math.cos(r),i=Math.cos(r)*(s-k),j=o*((1-p/4-3*p*p/64-5*p*p*p/256)*r-(3*p/8+3*p*p/32+45*p*p*p/1024)*Math.sin(2*r)+(15*p*p/256+45*p*p*p/1024)*Math.sin(4*r)-35*p*p*p/3072*Math.sin(6*r));var t=q*e*(i+(1-f+g)*i*i*i/6+(5-18*f+f*f+72*g-58*c)*i*i*i*i*i/120)+5e5,u=q*(j+e*Math.tan(r)*(i*i/2+(5-f+9*g+4*g*g)*i*i*i*i/24+(61-58*f+f*f+600*g-330*c)*i*i*i*i*i*i/720));return 0>m&&(u+=1e7),{northing:Math.round(u),easting:Math.round(t),zoneNumber:l,zoneLetter:h(m)}}function g(a){var b=a.northing,c=a.easting,d=a.zoneLetter,f=a.zoneNumber;if(0>f||f>60)return null;var h,i,j,k,l,m,n,o,p,q,r=.9996,s=6378137,t=.00669438,u=(1-Math.sqrt(1-t))/(1+Math.sqrt(1-t)),v=c-5e5,w=b;"N">d&&(w-=1e7),o=6*(f-1)-180+3,h=t/(1-t),n=w/r,p=n/(s*(1-t/4-3*t*t/64-5*t*t*t/256)),q=p+(3*u/2-27*u*u*u/32)*Math.sin(2*p)+(21*u*u/16-55*u*u*u*u/32)*Math.sin(4*p)+151*u*u*u/96*Math.sin(6*p),i=s/Math.sqrt(1-t*Math.sin(q)*Math.sin(q)),j=Math.tan(q)*Math.tan(q),k=h*Math.cos(q)*Math.cos(q),l=s*(1-t)/Math.pow(1-t*Math.sin(q)*Math.sin(q),1.5),m=v/(i*r);var x=q-i*Math.tan(q)/l*(m*m/2-(5+3*j+10*k-4*k*k-9*h)*m*m*m*m/24+(61+90*j+298*k+45*j*j-252*h-3*k*k)*m*m*m*m*m*m/720);x=e(x);var y=(m-(1+2*j+k)*m*m*m/6+(5-2*k+28*j-3*k*k+8*h+24*j*j)*m*m*m*m*m/120)/Math.cos(q);y=o+e(y);var z;if(a.accuracy){var A=g({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber});z={top:A.lat,right:A.lon,bottom:x,left:y}}else z={lat:x,lon:y};return z}function h(a){var b="Z";return 84>=a&&a>=72?b="X":72>a&&a>=64?b="W":64>a&&a>=56?b="V":56>a&&a>=48?b="U":48>a&&a>=40?b="T":40>a&&a>=32?b="S":32>a&&a>=24?b="R":24>a&&a>=16?b="Q":16>a&&a>=8?b="P":8>a&&a>=0?b="N":0>a&&a>=-8?b="M":-8>a&&a>=-16?b="L":-16>a&&a>=-24?b="K":-24>a&&a>=-32?b="J":-32>a&&a>=-40?b="H":-40>a&&a>=-48?b="G":-48>a&&a>=-56?b="F":-56>a&&a>=-64?b="E":-64>a&&a>=-72?b="D":-72>a&&a>=-80&&(b="C"),b}function i(a,b){var c=""+a.easting,d=""+a.northing;return a.zoneNumber+a.zoneLetter+j(a.easting,a.northing,a.zoneNumber)+c.substr(c.length-5,b)+d.substr(d.length-5,b)}function j(a,b,c){var d=k(c),e=Math.floor(a/1e5),f=Math.floor(b/1e5)%20;return l(e,f,d)}function k(a){var b=a%q;return 0===b&&(b=q),b}function l(a,b,c){var d=c-1,e=r.charCodeAt(d),f=s.charCodeAt(d),g=e+a-1,h=f+b,i=!1;g>x&&(g=g-x+t-1,i=!0),(g===u||u>e&&g>u||(g>u||u>e)&&i)&&g++,(g===v||v>e&&g>v||(g>v||v>e)&&i)&&(g++,g===u&&g++),g>x&&(g=g-x+t-1),h>w?(h=h-w+t-1,i=!0):i=!1,(h===u||u>f&&h>u||(h>u||u>f)&&i)&&h++,(h===v||v>f&&h>v||(h>v||v>f)&&i)&&(h++,h===u&&h++),h>w&&(h=h-w+t-1);var j=String.fromCharCode(g)+String.fromCharCode(h);return j}function m(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b,c=a.length,d=null,e="",f=0;!/[A-Z]/.test(b=a.charAt(f));){if(f>=2)throw"MGRSPoint bad conversion from: "+a;e+=b,f++}var g=parseInt(e,10);if(0===f||f+3>c)throw"MGRSPoint bad conversion from: "+a;var h=a.charAt(f++);if("A">=h||"B"===h||"Y"===h||h>="Z"||"I"===h||"O"===h)throw"MGRSPoint zone letter "+h+" not handled: "+a;d=a.substring(f,f+=2);for(var i=k(g),j=n(d.charAt(0),i),l=o(d.charAt(1),i);l<p(h);)l+=2e6;var m=c-f;if(m%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var q,r,s,t,u,v=m/2,w=0,x=0;return v>0&&(q=1e5/Math.pow(10,v),r=a.substring(f,f+v),w=parseFloat(r)*q,s=a.substring(f+v),x=parseFloat(s)*q),t=w+j,u=x+l,{easting:t,northing:u,zoneLetter:h,zoneNumber:g,accuracy:q}}function n(a,b){for(var c=r.charCodeAt(b-1),d=1e5,e=!1;c!==a.charCodeAt(0);){if(c++,c===u&&c++,c===v&&c++,c>x){if(e)throw"Bad character: "+a;c=t,e=!0}d+=1e5}return d}function o(a,b){if(a>"V")throw"MGRSPoint given invalid Northing "+a;for(var c=s.charCodeAt(b-1),d=0,e=!1;c!==a.charCodeAt(0);){if(c++,c===u&&c++,c===v&&c++,c>w){if(e)throw"Bad character: "+a;c=t,e=!0}d+=1e5}return d}function p(a){var b;switch(a){case"C":b=11e5;break;case"D":b=2e6;break;case"E":b=28e5;break;case"F":b=37e5;break;case"G":b=46e5;break;case"H":b=55e5;break;case"J":b=64e5;break;case"K":b=73e5;break;case"L":b=82e5;break;case"M":b=91e5;break;case"N":b=0;break;case"P":b=8e5;break;case"Q":b=17e5;break;case"R":b=26e5;break;case"S":b=35e5;break;case"T":b=44e5;break;case"U":b=53e5;break;case"V":b=62e5;break;case"W":b=7e6;break;case"X":b=79e5;break;default:b=-1}if(b>=0)return b;throw"Invalid zone letter: "+a}var q=6,r="AJSAJS",s="AFAFAF",t=65,u=73,v=79,w=86,x=90;c.forward=function(a,b){return b=b||5,i(f({lat:a[1],lon:a[0]}),b)},c.inverse=function(a){var b=g(m(a.toUpperCase()));return[b.left,b.bottom,b.right,b.top]},c.toPoint=function(a){var b=c.inverse(a);return[(b[2]+b[0])/2,(b[3]+b[1])/2]}},{}],69:[function(a,b,c){b.exports={name:"_mproj4_",version:"2.3.7-alpha",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/_mproj4_js/_mproj4_js.git"},author:"",license:"MIT",jam:{main:"dist/_mproj4_.js",include:["dist/_mproj4_.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(a,b,c){b.exports=a("Pk/iAZ")},{}],"Pk/iAZ":[function(a,b,c){var d=[a("./lib/projections/tmerc"),a("./lib/projections/utm"),a("./lib/projections/sterea"),a("./lib/projections/stere"),a("./lib/projections/somerc"),a("./lib/projections/omerc"),a("./lib/projections/lcc"),a("./lib/projections/krovak"),a("./lib/projections/cass"),a("./lib/projections/laea"),a("./lib/projections/aea"),a("./lib/projections/gnom"),a("./lib/projections/cea"),a("./lib/projections/eqc"),a("./lib/projections/poly"),a("./lib/projections/nzmg"),a("./lib/projections/mill"),a("./lib/projections/sinu"),a("./lib/projections/moll"),a("./lib/projections/eqdc"),a("./lib/projections/vandg"),a("./lib/projections/aeqd"),a("./lib/projections/geocent")];b.exports=function(_mproj4_){d.forEach(function(a){_mproj4_.Proj.projections.add(a)})}},{"./lib/projections/aea":40,"./lib/projections/aeqd":41,"./lib/projections/cass":42,"./lib/projections/cea":43,"./lib/projections/eqc":44,"./lib/projections/eqdc":45,"./lib/projections/geocent":47,"./lib/projections/gnom":48,"./lib/projections/krovak":49,"./lib/projections/laea":50,"./lib/projections/lcc":51,"./lib/projections/mill":54,"./lib/projections/moll":55,"./lib/projections/nzmg":56,"./lib/projections/omerc":57,"./lib/projections/poly":58,"./lib/projections/sinu":59,"./lib/projections/somerc":60,"./lib/projections/stere":61,"./lib/projections/sterea":62,"./lib/projections/tmerc":63,"./lib/projections/utm":64,"./lib/projections/vandg":65}]},{},[36])(36)});var GeographicLib={};GeographicLib.Constants={};GeographicLib.Math={};GeographicLib.Accumulator={};(function(c){c.WGS84={a:6378137,f:1/298.257223563};c.version={major:1,minor:45,patch:0};c.version_string="1.45"})(GeographicLib.Constants);
(function(m){m.digits=53;m.epsilon=Math.pow(.5,m.digits-1);m.degree=Math.PI/180;m.sq=function(x){return x*x};m.hypot=function(x,y){var a,b;x=Math.abs(x);y=Math.abs(y);a=Math.max(x,y);b=Math.min(x,y)/(a?a:1);return a*Math.sqrt(1+b*b)};m.cbrt=function(x){var y=Math.pow(Math.abs(x),1/3);return x<0?-y:y};m.log1p=function(x){var y=1+x,z=y-1;return z===0?x:x*Math.log(y)/z};m.atanh=function(x){var y=Math.abs(x);y=m.log1p(2*y/(1-y))/2;return x<0?-y:y};m.sum=function(u,v){var s=u+v,up=s-v,vpp=s-up,t;up-=u;
vpp-=v;t=-(up+vpp);return{s:s,t:t}};m.polyval=function(N,p,s,x){var y=N<0?0:p[s++];while(--N>=0)y=y*x+p[s++];return y};m.AngRound=function(x){var z=1/16,y=Math.abs(x);y=y<z?z-(z-y):y;return x<0?0-y:y};m.AngNormalize=function(x){x=x%360;return x<-180?x+360:x<180?x:x-360};m.LatFix=function(x){return Math.abs(x)>90?Number.NaN:x};m.AngDiff=function(x,y){var r=m.sum(m.AngNormalize(x),m.AngNormalize(-y)),d=-m.AngNormalize(r.s),t=r.t;return(d==180&&t<0?-180:d)-t};m.sincosd=function(x){var r,q,s,c,sinx,cosx;
r=x%360;q=Math.floor(r/90+.5);r-=90*q;r*=this.degree;s=Math.sin(r);c=Math.cos(r);switch(q&3){case 0:sinx=s;cosx=c;break;case 1:sinx=c;cosx=0-s;break;case 2:sinx=0-s;cosx=0-c;break;default:sinx=0-c;cosx=s;break}return{s:sinx,c:cosx}};m.atan2d=function(y,x){var q=0,t,ang;if(Math.abs(y)>Math.abs(x)){t=x;x=y;y=t;q=2}if(x<0){x=-x;++q}ang=Math.atan2(y,x)/this.degree;switch(q){case 1:ang=(y>0?180:-180)-ang;break;case 2:ang=90-ang;break;case 3:ang=-90+ang;break}return ang}})(GeographicLib.Math);
(function(a,m){a.Accumulator=function(y){this.Set(y)};a.Accumulator.prototype.Set=function(y){if(!y)y=0;if(y.constructor===a.Accumulator){this._s=y._s;this._t=y._t}else{this._s=y;this._t=0}};a.Accumulator.prototype.Add=function(y){var u=m.sum(y,this._t),v=m.sum(u.s,this._s);u=u.t;this._s=v.s;this._t=v.t;if(this._s===0)this._s=u;else this._t+=u};a.Accumulator.prototype.Sum=function(y){var b;if(!y)return this._s;else{b=new a.Accumulator(this);b.Add(y);return b._s}};a.Accumulator.prototype.Negate=function(){this._s*=
-1;this._t*=-1}})(GeographicLib.Accumulator,GeographicLib.Math);GeographicLib.DMS={};
(function(d){var lookup,zerofill,InternalDecode,NumMatch,hemispheres_="SNWE",signs_="-+",digits_="0123456789",dmsindicators_="D'\":",dmsindicatorsu_="\u00b0'\"",components_=["degrees","minutes","seconds"];lookup=function(s,c){return s.indexOf(c.toUpperCase())};zerofill=function(s,n){return String("0000").substr(0,Math.max(0,Math.min(4,n-s.length)))+s};d.NONE=0;d.LATITUDE=1;d.LONGITUDE=2;d.AZIMUTH=3;d.DEGREE=0;d.MINUTE=1;d.SECOND=2;d.Decode=function(dms){var dmsa=dms,end,v=0,i=0,mi,pi,vals,ind1=d.NONE,
ind2,p,pa,pb;dmsa=dmsa.replace(/\u00b0/g,"d").replace(/\u00ba/g,"d").replace(/\u2070/g,"d").replace(/\u02da/g,"d").replace(/\u2032/g,"'").replace(/\u00b4/g,"'").replace(/\u2019/g,"'").replace(/\u2033/g,'"').replace(/\u201d/g,'"').replace(/\u2212/g,"-").replace(/''/g,'"').trim();end=dmsa.length;for(p=0;p<end;p=pb,++i){pa=p;if(i===0&&lookup(hemispheres_,dmsa.charAt(pa))>=0)++pa;if(i>0||pa<end&&lookup(signs_,dmsa.charAt(pa))>=0)++pa;mi=dmsa.substr(pa,end-pa).indexOf("-");pi=dmsa.substr(pa,end-pa).indexOf("+");
if(mi<0)mi=end;else mi+=pa;if(pi<0)pi=end;else pi+=pa;pb=Math.min(mi,pi);vals=InternalDecode(dmsa.substr(p,pb-p));v+=vals.val;ind2=vals.ind;if(ind1==d.NONE)ind1=ind2;else if(!(ind2==d.NONE||ind1==ind2))throw new Error("Incompatible hemisphere specifies in "+dmsa.substr(0,pb));}if(i===0)throw new Error("Empty or incomplete DMS string "+dmsa);return{val:v,ind:ind1}};InternalDecode=function(dmsa){var vals={},errormsg="",sign,beg,end,ind1,k,ipieces,fpieces,npiece,icurrent,fcurrent,ncurrent,p,pointseen,
digcount,intcount,x;do{sign=1;beg=0;end=dmsa.length;ind1=d.NONE;k=-1;if(end>beg&&(k=lookup(hemispheres_,dmsa.charAt(beg)))>=0){ind1=k&2?d.LONGITUDE:d.LATITUDE;sign=k&1?1:-1;++beg}if(end>beg&&(k=lookup(hemispheres_,dmsa.charAt(end-1)))>=0)if(k>=0){if(ind1!==d.NONE){if(dmsa.charAt(beg-1).toUpperCase()===dmsa.charAt(end-1).toUpperCase())errormsg="Repeated hemisphere indicators "+dmsa.charAt(beg-1)+" in "+dmsa.substr(beg-1,end-beg+1);else errormsg="Contradictory hemisphere indicators "+dmsa.charAt(beg-
1)+" and "+dmsa.charAt(end-1)+" in "+dmsa.substr(beg-1,end-beg+1);break}ind1=k&2?d.LONGITUDE:d.LATITUDE;sign=k&1?1:-1;--end}if(end>beg&&(k=lookup(signs_,dmsa.charAt(beg)))>=0)if(k>=0){sign*=k?1:-1;++beg}if(end===beg){errormsg="Empty or incomplete DMS string "+dmsa;break}ipieces=[0,0,0];fpieces=[0,0,0];npiece=0;icurrent=0;fcurrent=0;ncurrent=0;p=beg;pointseen=false;digcount=0;intcount=0;while(p<end){x=dmsa.charAt(p++);if((k=lookup(digits_,x))>=0){++ncurrent;if(digcount>0)++digcount;else{icurrent=10*
icurrent+k;++intcount}}else if(x==="."){if(pointseen){errormsg="Multiple decimal points in "+dmsa.substr(beg,end-beg);break}pointseen=true;digcount=1}else if((k=lookup(dmsindicators_,x))>=0){if(k>=3){if(p===end){errormsg="Illegal for colon to appear at the end of "+dmsa.substr(beg,end-beg);break}k=npiece}if(k===npiece-1){errormsg="Repeated "+components_[k]+" component in "+dmsa.substr(beg,end-beg);break}else if(k<npiece){errormsg=components_[k]+" component follows "+components_[npiece-1]+" component in "+
dmsa.substr(beg,end-beg);break}if(ncurrent===0){errormsg="Missing numbers in "+components_[k]+" component of "+dmsa.substr(beg,end-beg);break}if(digcount>0){fcurrent=parseFloat(dmsa.substr(p-intcount-digcount-1,intcount+digcount));icurrent=0}ipieces[k]=icurrent;fpieces[k]=icurrent+fcurrent;if(p<end){npiece=k+1;icurrent=fcurrent=0;ncurrent=digcount=intcount=0}}else if(lookup(signs_,x)>=0){errormsg="Internal sign in DMS string "+dmsa.substr(beg,end-beg);break}else{errormsg="Illegal character "+x+" in DMS string "+
dmsa.substr(beg,end-beg);break}}if(errormsg.length)break;if(lookup(dmsindicators_,dmsa.charAt(p-1))<0){if(npiece>=3){errormsg="Extra text following seconds in DMS string "+dmsa.substr(beg,end-beg);break}if(ncurrent===0){errormsg="Missing numbers in trailing component of "+dmsa.substr(beg,end-beg);break}if(digcount>0){fcurrent=parseFloat(dmsa.substr(p-intcount-digcount,intcount+digcount));icurrent=0}ipieces[npiece]=icurrent;fpieces[npiece]=icurrent+fcurrent}if(pointseen&&digcount===0){errormsg="Decimal point in non-terminal component of "+
dmsa.substr(beg,end-beg);break}if(ipieces[1]>=60||fpieces[1]>60){errormsg="Minutes "+fpieces[1]+" not in range [0,60)";break}if(ipieces[2]>=60||fpieces[2]>60){errormsg="Seconds "+fpieces[2]+" not in range [0,60)";break}vals.ind=ind1;vals.val=sign*(fpieces[2]?(60*(60*fpieces[0]+fpieces[1])+fpieces[2])/3600:fpieces[1]?(60*fpieces[0]+fpieces[1])/60:fpieces[0]);return vals}while(false);vals.val=NumMatch(dmsa);if(vals.val===0)throw new Error(errormsg);else vals.ind=d.NONE;return vals};NumMatch=function(s){var t,
sign,p0,p1;if(s.length<3)return 0;t=s.toUpperCase().replace(/0+$/,"");sign=t.charAt(0)==="-"?-1:1;p0=t.charAt(0)==="-"||t.charAt(0)==="+"?1:0;p1=t.length-1;if(p1+1<p0+3)return 0;t=t.substr(p0,p1+1-p0);if(t==="NAN"||t==="1.#QNAN"||t==="1.#SNAN"||t==="1.#IND"||t==="1.#R")return Number.NaN;else if(t==="INF"||t==="1.#INF")return sign*Number.POSITIVE_INFINITY;return 0};d.DecodeLatLon=function(stra,strb,longfirst){var vals={},valsa=d.Decode(stra),valsb=d.Decode(strb),a=valsa.val,ia=valsa.ind,b=valsb.val,
ib=valsb.ind,lat,lon;if(!longfirst)longfirst=false;if(ia===d.NONE&&ib===d.NONE){ia=longfirst?d.LONGITUDE:d.LATITUDE;ib=longfirst?d.LATITUDE:d.LONGITUDE}else if(ia===d.NONE)ia=d.LATITUDE+d.LONGITUDE-ib;else if(ib===d.NONE)ib=d.LATITUDE+d.LONGITUDE-ia;if(ia===ib)throw new Error("Both "+stra+" and "+strb+" interpreted as "+(ia===d.LATITUDE?"latitudes":"longitudes"));lat=ia===d.LATITUDE?a:b;lon=ia===d.LATITUDE?b:a;if(Math.abs(lat)>90)throw new Error("Latitude "+lat+" not in [-90,90]");vals.lat=lat;vals.lon=
lon;return vals};d.DecodeAngle=function(angstr){var vals=d.Decode(angstr),ang=vals.val,ind=vals.ind;if(ind!==d.NONE)throw new Error("Arc angle "+angstr+" includes a hemisphere N/E/W/S");return ang};d.DecodeAzimuth=function(azistr){var vals=d.Decode(azistr),azi=vals.val,ind=vals.ind;if(ind===d.LATITUDE)throw new Error("Azimuth "+azistr+" has a latitude hemisphere N/S");return azi};d.Encode=function(angle,trailing,prec,ind){var scale=1,i,sign,idegree,fdegree,f,pieces,ip,fp,s;if(!ind)ind=d.NONE;if(!isFinite(angle))return angle<
0?String("-inf"):angle>0?String("inf"):String("nan");prec=Math.min(15-2*trailing,prec);for(i=0;i<trailing;++i)scale*=60;for(i=0;i<prec;++i)scale*=10;if(ind===d.AZIMUTH)angle-=Math.floor(angle/360)*360;sign=angle<0?-1:1;angle*=sign;idegree=Math.floor(angle);fdegree=(angle-idegree)*scale+.5;f=Math.floor(fdegree);fdegree=f==fdegree&&f&1?f-1:f;fdegree/=scale;fdegree=Math.floor((angle-idegree)*scale+.5)/scale;if(fdegree>=1){idegree+=1;fdegree-=1}pieces=[fdegree,0,0];for(i=1;i<=trailing;++i){ip=Math.floor(pieces[i-
1]);fp=pieces[i-1]-ip;pieces[i]=fp*60;pieces[i-1]=ip}pieces[0]+=idegree;s="";if(ind===d.NONE&&sign<0)s+="-";switch(trailing){case d.DEGREE:s+=zerofill(pieces[0].toFixed(prec),ind===d.NONE?0:1+Math.min(ind,2)+prec+(prec?1:0))+dmsindicatorsu_.charAt(0);break;default:s+=zerofill(pieces[0].toFixed(0),ind===d.NONE?0:1+Math.min(ind,2))+dmsindicatorsu_.charAt(0);switch(trailing){case d.MINUTE:s+=zerofill(pieces[1].toFixed(prec),2+prec+(prec?1:0))+dmsindicatorsu_.charAt(1);break;case d.SECOND:s+=zerofill(pieces[1].toFixed(0),
2)+dmsindicatorsu_.charAt(1);s+=zerofill(pieces[2].toFixed(prec),2+prec+(prec?1:0))+dmsindicatorsu_.charAt(2);break;default:break}}if(ind!==d.NONE&&ind!==d.AZIMUTH)s+=hemispheres_.charAt((ind===d.LATITUDE?0:2)+(sign<0?0:1));return s}})(GeographicLib.DMS);GeographicLib.Geodesic={};GeographicLib.GeodesicLine={};GeographicLib.PolygonArea={};
(function(g,l,p,m,c){var GEOGRAPHICLIB_GEODESIC_ORDER=6,nA1_=GEOGRAPHICLIB_GEODESIC_ORDER,nA2_=GEOGRAPHICLIB_GEODESIC_ORDER,nA3_=GEOGRAPHICLIB_GEODESIC_ORDER,nA3x_=nA3_,nC3x_,nC4x_,maxit1_=20,maxit2_=maxit1_+m.digits+10,tol0_=m.epsilon,tol1_=200*tol0_,tol2_=Math.sqrt(tol0_),tolb_=tol0_*tol1_,xthresh_=1E3*tol2_,CAP_NONE=0,CAP_ALL=31,CAP_MASK=CAP_ALL,OUT_ALL=32640,Astroid,A1m1f_coeff,C1f_coeff,C1pf_coeff,A2m1f_coeff,C2f_coeff,A3_coeff,C3_coeff,C4_coeff;g.tiny_=Math.sqrt(Number.MIN_VALUE);g.nC1_=GEOGRAPHICLIB_GEODESIC_ORDER;
g.nC1p_=GEOGRAPHICLIB_GEODESIC_ORDER;g.nC2_=GEOGRAPHICLIB_GEODESIC_ORDER;g.nC3_=GEOGRAPHICLIB_GEODESIC_ORDER;g.nC4_=GEOGRAPHICLIB_GEODESIC_ORDER;nC3x_=g.nC3_*(g.nC3_-1)/2;nC4x_=g.nC4_*(g.nC4_+1)/2,g.CAP_C1=1<<0;g.CAP_C1p=1<<1;g.CAP_C2=1<<2;g.CAP_C3=1<<3;g.CAP_C4=1<<4;g.NONE=0;g.LATITUDE=1<<7|CAP_NONE;g.LONGITUDE=1<<8|g.CAP_C3;g.AZIMUTH=1<<9|CAP_NONE;g.DISTANCE=1<<10|g.CAP_C1;g.STANDARD=g.LATITUDE|g.LONGITUDE|g.AZIMUTH|g.DISTANCE;g.DISTANCE_IN=1<<11|g.CAP_C1|g.CAP_C1p;g.REDUCEDLENGTH=1<<12|g.CAP_C1|
g.CAP_C2;g.GEODESICSCALE=1<<13|g.CAP_C1|g.CAP_C2;g.AREA=1<<14|g.CAP_C4;g.ALL=OUT_ALL|CAP_ALL;g.LONG_UNROLL=1<<15;g.OUT_MASK=OUT_ALL|g.LONG_UNROLL;g.SinCosSeries=function(sinp,sinx,cosx,c){var k=c.length,n=k-(sinp?1:0),ar=2*(cosx-sinx)*(cosx+sinx),y0=n&1?c[--k]:0,y1=0;n=Math.floor(n/2);while(n--){y1=ar*y0-y1+c[--k];y0=ar*y1-y0+c[--k]}return sinp?2*sinx*cosx*y0:cosx*(y0-y1)};Astroid=function(x,y){var k,p=m.sq(x),q=m.sq(y),r=(p+q-1)/6,S,r2,r3,disc,u,T3,T,ang,v,uv,w;if(!(q===0&&r<=0)){S=p*q/4;r2=m.sq(r);
r3=r*r2;disc=S*(S+2*r3);u=r;if(disc>=0){T3=S+r3;T3+=T3<0?-Math.sqrt(disc):Math.sqrt(disc);T=m.cbrt(T3);u+=T+(T!==0?r2/T:0)}else{ang=Math.atan2(Math.sqrt(-disc),-(S+r3));u+=2*r*Math.cos(ang/3)}v=Math.sqrt(m.sq(u)+q);uv=u<0?q/(v-u):u+v;w=(uv-q)/(2*v);k=uv/(Math.sqrt(uv+m.sq(w))+w)}else k=0;return k};A1m1f_coeff=[+1,4,64,0,256];g.A1m1f=function(eps){var p=Math.floor(nA1_/2),t=m.polyval(p,A1m1f_coeff,0,m.sq(eps))/A1m1f_coeff[p+1];return(t+eps)/(1-eps)};C1f_coeff=[-1,6,-16,32,-9,64,-128,2048,+9,-16,768,
+3,-5,512,-7,1280,-7,2048];g.C1f=function(eps,c){var eps2=m.sq(eps),d=eps,o=0,l,p;for(l=1;l<=g.nC1_;++l){p=Math.floor((g.nC1_-l)/2);c[l]=d*m.polyval(p,C1f_coeff,o,eps2)/C1f_coeff[o+p+1];o+=p+2;d*=eps}};C1pf_coeff=[+205,-432,768,1536,+4005,-4736,3840,12288,-225,116,384,-7173,2695,7680,+3467,7680,+38081,61440];g.C1pf=function(eps,c){var eps2=m.sq(eps),d=eps,o=0,l,p;for(l=1;l<=g.nC1p_;++l){p=Math.floor((g.nC1p_-l)/2);c[l]=d*m.polyval(p,C1pf_coeff,o,eps2)/C1pf_coeff[o+p+1];o+=p+2;d*=eps}};A2m1f_coeff=
[-11,-28,-192,0,256];g.A2m1f=function(eps){var p=Math.floor(nA2_/2),t=m.polyval(p,A2m1f_coeff,0,m.sq(eps))/A2m1f_coeff[p+1];return(t-eps)/(1+eps)};C2f_coeff=[+1,2,16,32,+35,64,384,2048,+15,80,768,+7,35,512,+63,1280,+77,2048];g.C2f=function(eps,c){var eps2=m.sq(eps),d=eps,o=0,l,p;for(l=1;l<=g.nC2_;++l){p=Math.floor((g.nC2_-l)/2);c[l]=d*m.polyval(p,C2f_coeff,o,eps2)/C2f_coeff[o+p+1];o+=p+2;d*=eps}};g.Geodesic=function(a,f){this.a=a;this.f=f;this._f1=1-this.f;this._e2=this.f*(2-this.f);this._ep2=this._e2/
m.sq(this._f1);this._n=this.f/(2-this.f);this._b=this.a*this._f1;this._c2=(m.sq(this.a)+m.sq(this._b)*(this._e2===0?1:(this._e2>0?m.atanh(Math.sqrt(this._e2)):Math.atan(Math.sqrt(-this._e2)))/Math.sqrt(Math.abs(this._e2))))/2;this._etol2=.1*tol2_/Math.sqrt(Math.max(.001,Math.abs(this.f))*Math.min(1,1-this.f/2)/2);if(!(isFinite(this.a)&&this.a>0))throw new Error("Major radius is not positive");if(!(isFinite(this._b)&&this._b>0))throw new Error("Minor radius is not positive");this._A3x=new Array(nA3x_);
this._C3x=new Array(nC3x_);this._C4x=new Array(nC4x_);this.A3coeff();this.C3coeff();this.C4coeff()};A3_coeff=[-3,128,-2,-3,64,-1,-3,-1,16,+3,-1,-2,8,+1,-1,2,+1,1];g.Geodesic.prototype.A3coeff=function(){var o=0,k=0,j,p;for(j=nA3_-1;j>=0;--j){p=Math.min(nA3_-j-1,j);this._A3x[k++]=m.polyval(p,A3_coeff,o,this._n)/A3_coeff[o+p+1];o+=p+2}};C3_coeff=[+3,128,+2,5,128,-1,3,3,64,-1,0,1,8,-1,1,4,+5,256,+1,3,128,-3,-2,3,64,+1,-3,2,32,+7,512,-10,9,384,+5,-9,5,192,+7,512,-14,7,512,+21,2560];g.Geodesic.prototype.C3coeff=
function(){var o=0,k=0,l,j,p;for(l=1;l<g.nC3_;++l)for(j=g.nC3_-1;j>=l;--j){p=Math.min(g.nC3_-j-1,j);this._C3x[k++]=m.polyval(p,C3_coeff,o,this._n)/C3_coeff[o+p+1];o+=p+2}};C4_coeff=[+97,15015,+1088,156,45045,-224,-4784,1573,45045,-10656,14144,-4576,-858,45045,+64,624,-4576,6864,-3003,15015,+100,208,572,3432,-12012,30030,45045,+1,9009,-2944,468,135135,+5792,1040,-1287,135135,+5952,-11648,9152,-2574,135135,-64,-624,4576,-6864,3003,135135,+8,10725,+1856,-936,225225,-8448,4992,-1144,225225,-1440,4160,
-4576,1716,225225,-136,63063,+1024,-208,105105,+3584,-3328,1144,315315,-128,135135,-2560,832,405405,+128,99099];g.Geodesic.prototype.C4coeff=function(){var o=0,k=0,l,j,p;for(l=0;l<g.nC4_;++l)for(j=g.nC4_-1;j>=l;--j){p=g.nC4_-j-1;this._C4x[k++]=m.polyval(p,C4_coeff,o,this._n)/C4_coeff[o+p+1];o+=p+2}};g.Geodesic.prototype.A3f=function(eps){return m.polyval(nA3x_-1,this._A3x,0,eps)};g.Geodesic.prototype.C3f=function(eps,c){var mult=1,o=0,l,p;for(l=1;l<g.nC3_;++l){p=g.nC3_-l-1;mult*=eps;c[l]=mult*m.polyval(p,
this._C3x,o,eps);o+=p+1}};g.Geodesic.prototype.C4f=function(eps,c){var mult=1,o=0,l,p;for(l=0;l<g.nC4_;++l){p=g.nC4_-l-1;c[l]=mult*m.polyval(p,this._C4x,o,eps);o+=p+1;mult*=eps}};g.Geodesic.prototype.Lengths=function(eps,sig12,ssig1,csig1,dn1,ssig2,csig2,dn2,cbet1,cbet2,outmask,C1a,C2a){outmask&=g.OUT_MASK;var vals={},m0x=0,J12=0,A1=0,A2=0,B1,B2,l,csig12,t;if(outmask&(g.DISTANCE|g.REDUCEDLENGTH|g.GEODESICSCALE)){A1=g.A1m1f(eps);g.C1f(eps,C1a);if(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)){A2=g.A2m1f(eps);
g.C2f(eps,C2a);m0x=A1-A2;A2=1+A2}A1=1+A1}if(outmask&g.DISTANCE){B1=g.SinCosSeries(true,ssig2,csig2,C1a)-g.SinCosSeries(true,ssig1,csig1,C1a);vals.s12b=A1*(sig12+B1);if(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)){B2=g.SinCosSeries(true,ssig2,csig2,C2a)-g.SinCosSeries(true,ssig1,csig1,C2a);J12=m0x*sig12+(A1*B1-A2*B2)}}else if(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)){for(l=1;l<=g.nC2_;++l)C2a[l]=A1*C1a[l]-A2*C2a[l];J12=m0x*sig12+(g.SinCosSeries(true,ssig2,csig2,C2a)-g.SinCosSeries(true,ssig1,csig1,
C2a))}if(outmask&g.REDUCEDLENGTH){vals.m0=m0x;vals.m12b=dn2*(csig1*ssig2)-dn1*(ssig1*csig2)-csig1*csig2*J12}if(outmask&g.GEODESICSCALE){csig12=csig1*csig2+ssig1*ssig2;t=this._ep2*(cbet1-cbet2)*(cbet1+cbet2)/(dn1+dn2);vals.M12=csig12+(t*ssig2-csig2*J12)*ssig1/dn1;vals.M21=csig12-(t*ssig1-csig1*J12)*ssig2/dn2}return vals};g.Geodesic.prototype.InverseStart=function(sbet1,cbet1,dn1,sbet2,cbet2,dn2,lam12,C1a,C2a){var vals={},sbet12=sbet2*cbet1-cbet2*sbet1,cbet12=cbet2*cbet1+sbet2*sbet1,sbet12a,shortline,
omg12,sbetm2,somg12,comg12,t,ssig12,csig12,x,y,lamscale,betscale,k2,eps,cbet12a,bet12a,m12b,m0,nvals,k,omg12a;vals.sig12=-1;sbet12a=sbet2*cbet1;sbet12a+=cbet2*sbet1;shortline=cbet12>=0&&sbet12<.5&&cbet2*lam12<.5;omg12=lam12;if(shortline){sbetm2=m.sq(sbet1+sbet2);sbetm2/=sbetm2+m.sq(cbet1+cbet2);vals.dnm=Math.sqrt(1+this._ep2*sbetm2);omg12/=this._f1*vals.dnm}somg12=Math.sin(omg12);comg12=Math.cos(omg12);vals.salp1=cbet2*somg12;vals.calp1=comg12>=0?sbet12+cbet2*sbet1*m.sq(somg12)/(1+comg12):sbet12a-
cbet2*sbet1*m.sq(somg12)/(1-comg12);ssig12=m.hypot(vals.salp1,vals.calp1);csig12=sbet1*sbet2+cbet1*cbet2*comg12;if(shortline&&ssig12<this._etol2){vals.salp2=cbet1*somg12;vals.calp2=sbet12-cbet1*sbet2*(comg12>=0?m.sq(somg12)/(1+comg12):1-comg12);t=m.hypot(vals.salp2,vals.calp2);vals.salp2/=t;vals.calp2/=t;vals.sig12=Math.atan2(ssig12,csig12)}else if(Math.abs(this._n)>.1||csig12>=0||ssig12>=6*Math.abs(this._n)*Math.PI*m.sq(cbet1));else{if(this.f>=0){k2=m.sq(sbet1)*this._ep2;eps=k2/(2*(1+Math.sqrt(1+
k2))+k2);lamscale=this.f*cbet1*this.A3f(eps)*Math.PI;betscale=lamscale*cbet1;x=(lam12-Math.PI)/lamscale;y=sbet12a/betscale}else{cbet12a=cbet2*cbet1-sbet2*sbet1;bet12a=Math.atan2(sbet12a,cbet12a);nvals=this.Lengths(this._n,Math.PI+bet12a,sbet1,-cbet1,dn1,sbet2,cbet2,dn2,cbet1,cbet2,g.REDUCEDLENGTH,C1a,C2a);m12b=nvals.m12b;m0=nvals.m0;x=-1+m12b/(cbet1*cbet2*m0*Math.PI);betscale=x<-.01?sbet12a/x:-this.f*m.sq(cbet1)*Math.PI;lamscale=betscale/cbet1;y=(lam12-Math.PI)/lamscale}if(y>-tol1_&&x>-1-xthresh_)if(this.f>=
0){vals.salp1=Math.min(1,-x);vals.calp1=-Math.sqrt(1-m.sq(vals.salp1))}else{vals.calp1=Math.max(x>-tol1_?0:-1,x);vals.salp1=Math.sqrt(1-m.sq(vals.calp1))}else{k=Astroid(x,y);omg12a=lamscale*(this.f>=0?-x*k/(1+k):-y*(1+k)/k);somg12=Math.sin(omg12a);comg12=-Math.cos(omg12a);vals.salp1=cbet2*somg12;vals.calp1=sbet12a-cbet2*sbet1*m.sq(somg12)/(1-comg12)}}if(!(vals.salp1<=0)){t=m.hypot(vals.salp1,vals.calp1);vals.salp1/=t;vals.calp1/=t}else{vals.salp1=1;vals.calp1=0}return vals};g.Geodesic.prototype.Lambda12=
function(sbet1,cbet1,dn1,sbet2,cbet2,dn2,salp1,calp1,diffp,C1a,C2a,C3a){var vals={},t,salp0,calp0,somg1,comg1,somg2,comg2,omg12,B312,h0,k2,nvals;if(sbet1===0&&calp1===0)calp1=-g.tiny_;salp0=salp1*cbet1;calp0=m.hypot(calp1,salp1*sbet1);vals.ssig1=sbet1;somg1=salp0*sbet1;vals.csig1=comg1=calp1*cbet1;t=m.hypot(vals.ssig1,vals.csig1);vals.ssig1/=t;vals.csig1/=t;vals.salp2=cbet2!==cbet1?salp0/cbet2:salp1;vals.calp2=cbet2!==cbet1||Math.abs(sbet2)!==-sbet1?Math.sqrt(m.sq(calp1*cbet1)+(cbet1<-sbet1?(cbet2-
cbet1)*(cbet1+cbet2):(sbet1-sbet2)*(sbet1+sbet2)))/cbet2:Math.abs(calp1);vals.ssig2=sbet2;somg2=salp0*sbet2;vals.csig2=comg2=vals.calp2*cbet2;t=m.hypot(vals.ssig2,vals.csig2);vals.ssig2/=t;vals.csig2/=t;vals.sig12=Math.atan2(Math.max(0,vals.csig1*vals.ssig2-vals.ssig1*vals.csig2),vals.csig1*vals.csig2+vals.ssig1*vals.ssig2);omg12=Math.atan2(Math.max(0,comg1*somg2-somg1*comg2),comg1*comg2+somg1*somg2);k2=m.sq(calp0)*this._ep2;vals.eps=k2/(2*(1+Math.sqrt(1+k2))+k2);this.C3f(vals.eps,C3a);B312=g.SinCosSeries(true,
vals.ssig2,vals.csig2,C3a)-g.SinCosSeries(true,vals.ssig1,vals.csig1,C3a);h0=-this.f*this.A3f(vals.eps);vals.domg12=salp0*h0*(vals.sig12+B312);vals.lam12=omg12+vals.domg12;if(diffp)if(vals.calp2===0)vals.dlam12=-2*this._f1*dn1/sbet1;else{nvals=this.Lengths(vals.eps,vals.sig12,vals.ssig1,vals.csig1,dn1,vals.ssig2,vals.csig2,dn2,cbet1,cbet2,g.REDUCEDLENGTH,C1a,C2a);vals.dlam12=nvals.m12b;vals.dlam12*=this._f1/(vals.calp2*cbet2)}return vals};g.Geodesic.prototype.Inverse=function(lat1,lon1,lat2,lon2,
outmask){var vals={},lon12,lonsign,t,swapp,latsign,sbet1,cbet1,sbet2,cbet2,s12x,m12x,dn1,dn2,lam12,slam12,clam12,sig12,calp1,salp1,calp2,salp2,C1a,C2a,C3a,meridian,nvals,ssig1,csig1,ssig2,csig2,eps,omg12,dnm,numit,salp1a,calp1a,salp1b,calp1b,tripn,tripb,v,dv,dalp1,sdalp1,cdalp1,nsalp1,lengthmask,salp0,calp0,alp12,k2,A4,C4a,B41,B42,somg12,domg12,dbet1,dbet2,salp12,calp12;if(!outmask)outmask=g.STANDARD;if(outmask==g.LONG_UNROLL)outmask|=g.STANDARD;outmask&=g.OUT_MASK;vals.lat1=lat1=m.LatFix(lat1);vals.lat2=
lat2=m.LatFix(lat2);lon12=m.AngDiff(lon1,lon2);if(outmask&g.LONG_UNROLL){vals.lon1=lon1;vals.lon2=lon1+lon12}else{vals.lon1=m.AngNormalize(lon1);vals.lon2=m.AngNormalize(lon2)}lon12=m.AngRound(lon12);lonsign=lon12>=0?1:-1;lon12*=lonsign;lat1=m.AngRound(lat1);lat2=m.AngRound(lat2);swapp=Math.abs(lat1)<Math.abs(lat2)?-1:1;if(swapp<0){lonsign*=-1;t=lat1;lat1=lat2;lat2=t}latsign=lat1<0?1:-1;lat1*=latsign;lat2*=latsign;t=m.sincosd(lat1);sbet1=this._f1*t.s;cbet1=t.c;t=m.hypot(sbet1,cbet1);sbet1/=t;cbet1/=
t;cbet1=Math.max(g.tiny_,cbet1);t=m.sincosd(lat2);sbet2=this._f1*t.s;cbet2=t.c;t=m.hypot(sbet2,cbet2);sbet2/=t;cbet2/=t;cbet2=Math.max(g.tiny_,cbet2);if(cbet1<-sbet1){if(cbet2===cbet1)sbet2=sbet2<0?sbet1:-sbet1}else if(Math.abs(sbet2)===-sbet1)cbet2=cbet1;dn1=Math.sqrt(1+this._ep2*m.sq(sbet1));dn2=Math.sqrt(1+this._ep2*m.sq(sbet2));lam12=lon12*m.degree;t=m.sincosd(lon12);slam12=t.s;clam12=t.c;C1a=new Array(g.nC1_+1);C2a=new Array(g.nC2_+1);C3a=new Array(g.nC3_);meridian=lat1===-90||slam12===0;if(meridian){calp1=
clam12;salp1=slam12;calp2=1;salp2=0;ssig1=sbet1;csig1=calp1*cbet1;ssig2=sbet2;csig2=calp2*cbet2;sig12=Math.atan2(Math.max(0,csig1*ssig2-ssig1*csig2),csig1*csig2+ssig1*ssig2);nvals=this.Lengths(this._n,sig12,ssig1,csig1,dn1,ssig2,csig2,dn2,cbet1,cbet2,outmask|g.DISTANCE|g.REDUCEDLENGTH,C1a,C2a);s12x=nvals.s12b;m12x=nvals.m12b;if((outmask&g.GEODESICSCALE)!==0){vals.M12=nvals.M12;vals.M21=nvals.M21}if(sig12<1||m12x>=0){if(sig12<3*g.tiny_)sig12=m12x=s12x=0;m12x*=this._b;s12x*=this._b;vals.a12=sig12/m.degree}else meridian=
false}if(!meridian&&sbet1===0&&(this.f<=0||lam12<=Math.PI-this.f*Math.PI)){calp1=calp2=0;salp1=salp2=1;s12x=this.a*lam12;sig12=omg12=lam12/this._f1;m12x=this._b*Math.sin(sig12);if(outmask&g.GEODESICSCALE)vals.M12=vals.M21=Math.cos(sig12);vals.a12=lon12/this._f1}else if(!meridian){nvals=this.InverseStart(sbet1,cbet1,dn1,sbet2,cbet2,dn2,lam12,C1a,C2a);sig12=nvals.sig12;salp1=nvals.salp1;calp1=nvals.calp1;if(sig12>=0){salp2=nvals.salp2;calp2=nvals.calp2;dnm=nvals.dnm;s12x=sig12*this._b*dnm;m12x=m.sq(dnm)*
this._b*Math.sin(sig12/dnm);if(outmask&g.GEODESICSCALE)vals.M12=vals.M21=Math.cos(sig12/dnm);vals.a12=sig12/m.degree;omg12=lam12/(this._f1*dnm)}else{numit=0;salp1a=g.tiny_;calp1a=1;salp1b=g.tiny_;calp1b=-1;for(tripn=false,tripb=false;numit<maxit2_;++numit){nvals=this.Lambda12(sbet1,cbet1,dn1,sbet2,cbet2,dn2,salp1,calp1,numit<maxit1_,C1a,C2a,C3a);v=nvals.lam12-lam12;salp2=nvals.salp2;calp2=nvals.calp2;sig12=nvals.sig12;ssig1=nvals.ssig1;csig1=nvals.csig1;ssig2=nvals.ssig2;csig2=nvals.csig2;eps=nvals.eps;
omg12=nvals.domg12;dv=nvals.dlam12;if(tripb||!(Math.abs(v)>=(tripn?8:2)*tol0_))break;if(v>0&&(numit<maxit1_||calp1/salp1>calp1b/salp1b)){salp1b=salp1;calp1b=calp1}else if(v<0&&(numit<maxit1_||calp1/salp1<calp1a/salp1a)){salp1a=salp1;calp1a=calp1}if(numit<maxit1_&&dv>0){dalp1=-v/dv;sdalp1=Math.sin(dalp1);cdalp1=Math.cos(dalp1);nsalp1=salp1*cdalp1+calp1*sdalp1;if(nsalp1>0&&Math.abs(dalp1)<Math.PI){calp1=calp1*cdalp1-salp1*sdalp1;salp1=nsalp1;t=m.hypot(salp1,calp1);salp1/=t;calp1/=t;tripn=Math.abs(v)<=
16*tol0_;continue}}salp1=(salp1a+salp1b)/2;calp1=(calp1a+calp1b)/2;t=m.hypot(salp1,calp1);salp1/=t;calp1/=t;tripn=false;tripb=Math.abs(salp1a-salp1)+(calp1a-calp1)<tolb_||Math.abs(salp1-salp1b)+(calp1-calp1b)<tolb_}lengthmask=outmask|(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)?g.DISTANCE:g.NONE);nvals=this.Lengths(eps,sig12,ssig1,csig1,dn1,ssig2,csig2,dn2,cbet1,cbet2,lengthmask,C1a,C2a);s12x=nvals.s12b;m12x=nvals.m12b;if((outmask&g.GEODESICSCALE)!==0){vals.M12=nvals.M12;vals.M21=nvals.M21}m12x*=this._b;
s12x*=this._b;vals.a12=sig12/m.degree;omg12=lam12-omg12}}if(outmask&g.DISTANCE)vals.s12=0+s12x;if(outmask&g.REDUCEDLENGTH)vals.m12=0+m12x;if(outmask&g.AREA){salp0=salp1*cbet1;calp0=m.hypot(calp1,salp1*sbet1);if(calp0!==0&&salp0!==0){ssig1=sbet1;csig1=calp1*cbet1;ssig2=sbet2;csig2=calp2*cbet2;k2=m.sq(calp0)*this._ep2;eps=k2/(2*(1+Math.sqrt(1+k2))+k2);A4=m.sq(this.a)*calp0*salp0*this._e2;t=m.hypot(ssig1,csig1);ssig1/=t;csig1/=t;t=m.hypot(ssig2,csig2);ssig2/=t;csig2/=t;C4a=new Array(g.nC4_);this.C4f(eps,
C4a);B41=g.SinCosSeries(false,ssig1,csig1,C4a);B42=g.SinCosSeries(false,ssig2,csig2,C4a);vals.S12=A4*(B42-B41)}else vals.S12=0;if(!meridian&&omg12<.75*Math.PI&&sbet2-sbet1<1.75){somg12=Math.sin(omg12);domg12=1+Math.cos(omg12);dbet1=1+cbet1;dbet2=1+cbet2;alp12=2*Math.atan2(somg12*(sbet1*dbet2+sbet2*dbet1),domg12*(sbet1*sbet2+dbet1*dbet2))}else{salp12=salp2*calp1-calp2*salp1;calp12=calp2*calp1+salp2*salp1;if(salp12===0&&calp12<0){salp12=g.tiny_*calp1;calp12=-1}alp12=Math.atan2(salp12,calp12)}vals.S12+=
this._c2*alp12;vals.S12*=swapp*lonsign*latsign;vals.S12+=0}if(swapp<0){t=salp1;salp1=salp2;salp2=t;t=calp1;calp1=calp2;calp2=t;if(outmask&g.GEODESICSCALE){t=vals.M12;vals.M12=vals.M21;vals.M21=t}}salp1*=swapp*lonsign;calp1*=swapp*latsign;salp2*=swapp*lonsign;calp2*=swapp*latsign;if(outmask&g.AZIMUTH){vals.azi1=m.atan2d(salp1,calp1);vals.azi2=m.atan2d(salp2,calp2)}return vals};g.Geodesic.prototype.GenDirect=function(lat1,lon1,azi1,arcmode,s12_a12,outmask){var line;if(!outmask)outmask=g.STANDARD;else if(outmask==
g.LONG_UNROLL)outmask|=g.STANDARD;line=new l.GeodesicLine(this,lat1,lon1,azi1,outmask|(arcmode?g.NONE:g.DISTANCE_IN));return line.GenPosition(arcmode,s12_a12,outmask)};g.Geodesic.prototype.Direct=function(lat1,lon1,azi1,s12,outmask){return this.GenDirect(lat1,lon1,azi1,false,s12,outmask)};g.Geodesic.prototype.ArcDirect=function(lat1,lon1,azi1,a12,outmask){return this.GenDirect(lat1,lon1,azi1,true,a12,outmask)};g.Geodesic.prototype.Line=function(lat1,lon1,azi1,caps){return new l.GeodesicLine(this,
lat1,lon1,azi1,caps)};g.Geodesic.prototype.Polygon=function(polyline){return new p.PolygonArea(this,polyline)};g.WGS84=new g.Geodesic(c.WGS84.a,c.WGS84.f)})(GeographicLib.Geodesic,GeographicLib.GeodesicLine,GeographicLib.PolygonArea,GeographicLib.Math,GeographicLib.Constants);
(function(g,l,m){l.GeodesicLine=function(geod,lat1,lon1,azi1,caps){var t,cbet1,sbet1,eps,s,c;if(!caps)caps=g.STANDARD|g.DISTANCE_IN;this.a=geod.a;this.f=geod.f;this._b=geod._b;this._c2=geod._c2;this._f1=geod._f1;this._caps=(!caps?g.ALL:caps|g.LATITUDE|g.AZIMUTH)|g.LONG_UNROLL;this.lat1=m.LatFix(lat1);this.lon1=lon1;this.azi1=m.AngNormalize(azi1);t=m.sincosd(m.AngRound(this.azi1));this._salp1=t.s;this._calp1=t.c;t=m.sincosd(m.AngRound(this.lat1));sbet1=this._f1*t.s;cbet1=t.c;t=m.hypot(sbet1,cbet1);
sbet1/=t;cbet1/=t;cbet1=Math.max(g.tiny_,cbet1);this._dn1=Math.sqrt(1+geod._ep2*m.sq(sbet1));this._salp0=this._salp1*cbet1;this._calp0=m.hypot(this._calp1,this._salp1*sbet1);this._ssig1=sbet1;this._somg1=this._salp0*sbet1;this._csig1=this._comg1=sbet1!==0||this._calp1!==0?cbet1*this._calp1:1;t=m.hypot(this._ssig1,this._csig1);this._ssig1/=t;this._csig1/=t;this._k2=m.sq(this._calp0)*geod._ep2;eps=this._k2/(2*(1+Math.sqrt(1+this._k2))+this._k2);if(this._caps&g.CAP_C1){this._A1m1=g.A1m1f(eps);this._C1a=
new Array(g.nC1_+1);g.C1f(eps,this._C1a);this._B11=g.SinCosSeries(true,this._ssig1,this._csig1,this._C1a);s=Math.sin(this._B11);c=Math.cos(this._B11);this._stau1=this._ssig1*c+this._csig1*s;this._ctau1=this._csig1*c-this._ssig1*s}if(this._caps&g.CAP_C1p){this._C1pa=new Array(g.nC1p_+1);g.C1pf(eps,this._C1pa)}if(this._caps&g.CAP_C2){this._A2m1=g.A2m1f(eps);this._C2a=new Array(g.nC2_+1);g.C2f(eps,this._C2a);this._B21=g.SinCosSeries(true,this._ssig1,this._csig1,this._C2a)}if(this._caps&g.CAP_C3){this._C3a=
new Array(g.nC3_);geod.C3f(eps,this._C3a);this._A3c=-this.f*this._salp0*geod.A3f(eps);this._B31=g.SinCosSeries(true,this._ssig1,this._csig1,this._C3a)}if(this._caps&g.CAP_C4){this._C4a=new Array(g.nC4_);geod.C4f(eps,this._C4a);this._A4=m.sq(this.a)*this._calp0*this._salp0*geod._e2;this._B41=g.SinCosSeries(false,this._ssig1,this._csig1,this._C4a)}};l.GeodesicLine.prototype.GenPosition=function(arcmode,s12_a12,outmask){var vals={},sig12,ssig12,csig12,B12,AB1,ssig2,csig2,tau12,s,c,serr,omg12,lam12,lon12,
E,sbet2,cbet2,somg2,comg2,salp2,calp2,dn2,B22,AB2,J12,t,B42,salp12,calp12;if(!outmask)outmask=g.STANDARD;else if(outmask==g.LONG_UNROLL)outmask|=g.STANDARD;outmask&=this._caps&g.OUT_MASK;vals.lat1=this.lat1;vals.azi1=this.azi1;vals.lon1=outmask&g.LONG_UNROLL?this.lon1:m.AngNormalize(this.lon1);if(arcmode)vals.a12=s12_a12;else vals.s12=s12_a12;if(!(arcmode||this._caps&g.DISTANCE_IN&g.OUT_MASK)){vals.a12=Number.NaN;return vals}B12=0;AB1=0;if(arcmode){sig12=s12_a12*m.degree;t=m.sincosd(s12_a12);ssig12=
t.s;csig12=t.c}else{tau12=s12_a12/(this._b*(1+this._A1m1));s=Math.sin(tau12);c=Math.cos(tau12);B12=-g.SinCosSeries(true,this._stau1*c+this._ctau1*s,this._ctau1*c-this._stau1*s,this._C1pa);sig12=tau12-(B12-this._B11);ssig12=Math.sin(sig12);csig12=Math.cos(sig12);if(Math.abs(this.f)>.01){ssig2=this._ssig1*csig12+this._csig1*ssig12;csig2=this._csig1*csig12-this._ssig1*ssig12;B12=g.SinCosSeries(true,ssig2,csig2,this._C1a);serr=(1+this._A1m1)*(sig12+(B12-this._B11))-s12_a12/this._b;sig12=sig12-serr/Math.sqrt(1+
this._k2*m.sq(ssig2));ssig12=Math.sin(sig12);csig12=Math.cos(sig12)}}ssig2=this._ssig1*csig12+this._csig1*ssig12;csig2=this._csig1*csig12-this._ssig1*ssig12;dn2=Math.sqrt(1+this._k2*m.sq(ssig2));if(outmask&(g.DISTANCE|g.REDUCEDLENGTH|g.GEODESICSCALE)){if(arcmode||Math.abs(this.f)>.01)B12=g.SinCosSeries(true,ssig2,csig2,this._C1a);AB1=(1+this._A1m1)*(B12-this._B11)}sbet2=this._calp0*ssig2;cbet2=m.hypot(this._salp0,this._calp0*csig2);if(cbet2===0)cbet2=csig2=g.tiny_;salp2=this._salp0;calp2=this._calp0*
csig2;if(arcmode&&outmask&g.DISTANCE)vals.s12=this._b*((1+this._A1m1)*sig12+AB1);if(outmask&g.LONGITUDE){somg2=this._salp0*ssig2;comg2=csig2;E=this._salp0<0?-1:1;omg12=outmask&g.LONG_UNROLL?E*(sig12-(Math.atan2(ssig2,csig2)-Math.atan2(this._ssig1,this._csig1))+(Math.atan2(E*somg2,comg2)-Math.atan2(E*this._somg1,this._comg1))):Math.atan2(somg2*this._comg1-comg2*this._somg1,comg2*this._comg1+somg2*this._somg1);lam12=omg12+this._A3c*(sig12+(g.SinCosSeries(true,ssig2,csig2,this._C3a)-this._B31));lon12=
lam12/m.degree;vals.lon2=outmask&g.LONG_UNROLL?this.lon1+lon12:m.AngNormalize(m.AngNormalize(this.lon1)+m.AngNormalize(lon12))}if(outmask&g.LATITUDE)vals.lat2=m.atan2d(sbet2,this._f1*cbet2);if(outmask&g.AZIMUTH)vals.azi2=m.atan2d(salp2,calp2);if(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)){B22=g.SinCosSeries(true,ssig2,csig2,this._C2a);AB2=(1+this._A2m1)*(B22-this._B21);J12=(this._A1m1-this._A2m1)*sig12+(AB1-AB2);if(outmask&g.REDUCEDLENGTH)vals.m12=this._b*(dn2*(this._csig1*ssig2)-this._dn1*(this._ssig1*
csig2)-this._csig1*csig2*J12);if(outmask&g.GEODESICSCALE){t=this._k2*(ssig2-this._ssig1)*(ssig2+this._ssig1)/(this._dn1+dn2);vals.M12=csig12+(t*ssig2-csig2*J12)*this._ssig1/this._dn1;vals.M21=csig12-(t*this._ssig1-this._csig1*J12)*ssig2/dn2}}if(outmask&g.AREA){B42=g.SinCosSeries(false,ssig2,csig2,this._C4a);if(this._calp0===0||this._salp0===0){salp12=salp2*this._calp1-calp2*this._salp1;calp12=calp2*this._calp1+salp2*this._salp1;if(salp12===0&&calp12<0){salp12=g.tiny_*this._calp1;calp12=-1}}else{salp12=
this._calp0*this._salp0*(csig12<=0?this._csig1*(1-csig12)+ssig12*this._ssig1:ssig12*(this._csig1*ssig12/(1+csig12)+this._ssig1));calp12=m.sq(this._salp0)+m.sq(this._calp0)*this._csig1*csig2}vals.S12=this._c2*Math.atan2(salp12,calp12)+this._A4*(B42-this._B41)}if(!arcmode)vals.a12=sig12/m.degree;return vals};l.GeodesicLine.prototype.Position=function(s12,outmask){return this.GenPosition(false,s12,outmask)};l.GeodesicLine.prototype.ArcPosition=function(a12,outmask){return this.GenPosition(true,a12,outmask)}})(GeographicLib.Geodesic,
GeographicLib.GeodesicLine,GeographicLib.Math);
(function(p,g,m,a){var transit,transitdirect;transit=function(lon1,lon2){var lon12,cross;lon1=m.AngNormalize(lon1);lon2=m.AngNormalize(lon2);lon12=m.AngDiff(lon1,lon2);cross=lon1<0&&lon2>=0&&lon12>0?1:lon2<0&&lon1>=0&&lon12<0?-1:0;return cross};transitdirect=function(lon1,lon2){lon1=lon1%720;lon2=lon2%720;return(lon2>=0&&lon2<360||lon2<-360?0:1)-(lon1>=0&&lon1<360||lon1<-360?0:1)};p.PolygonArea=function(geod,polyline){this._geod=geod;this.a=this._geod.a;this.f=this._geod.f;this._area0=4*Math.PI*geod._c2;
this.polyline=!polyline?false:polyline;this._mask=g.LATITUDE|g.LONGITUDE|g.DISTANCE|(this.polyline?g.NONE:g.AREA|g.LONG_UNROLL);if(!this.polyline)this._areasum=new a.Accumulator(0);this._perimetersum=new a.Accumulator(0);this.Clear()};p.PolygonArea.prototype.Clear=function(){this.num=0;this._crossings=0;if(!this.polyline)this._areasum.Set(0);this._perimetersum.Set(0);this._lat0=this._lon0=this.lat=this.lon=Number.NaN};p.PolygonArea.prototype.AddPoint=function(lat,lon){var t;if(this.num===0){this._lat0=
this.lat=lat;this._lon0=this.lon=lon}else{t=this._geod.Inverse(this.lat,this.lon,lat,lon,this._mask);this._perimetersum.Add(t.s12);if(!this.polyline){this._areasum.Add(t.S12);this._crossings+=transit(this.lon,lon)}this.lat=lat;this.lon=lon}++this.num};p.PolygonArea.prototype.AddEdge=function(azi,s){var t;if(this.num){t=this._geod.Direct(this.lat,this.lon,azi,s,this._mask);this._perimetersum.Add(s);if(!this.polyline){this._areasum.Add(t.S12);this._crossings+=transitdirect(this.lon,t.lon2)}this.lat=
t.lat2;this.lon=t.lon2}++this.num};p.PolygonArea.prototype.Compute=function(reverse,sign){var vals={number:this.num},t,tempsum,crossings;if(this.num<2){vals.perimeter=0;if(!this.polyline)vals.area=0;return vals}if(this.polyline){vals.perimeter=this._perimetersum.Sum();return vals}t=this._geod.Inverse(this.lat,this.lon,this._lat0,this._lon0,this._mask);vals.perimeter=this._perimetersum.Sum(t.s12);tempsum=new a.Accumulator(this._areasum);tempsum.Add(t.S12);crossings=this._crossings+transit(this.lon,
this._lon0);if(crossings&1)tempsum.Add((tempsum.Sum()<0?1:-1)*this._area0/2);if(!reverse)tempsum.Negate();if(sign)if(tempsum.Sum()>this._area0/2)tempsum.Add(-this._area0);else{if(tempsum.Sum()<=-this._area0/2)tempsum.Add(+this._area0)}else if(tempsum.Sum()>=this._area0)tempsum.Add(-this._area0);else if(tempsum<0)tempsum.Add(-this._area0);vals.area=tempsum.Sum();return vals};p.PolygonArea.prototype.TestPoint=function(lat,lon,reverse,sign){var vals={number:this.num+1},t,tempsum,crossings,i;if(this.num===
0){vals.perimeter=0;if(!this.polyline)vals.area=0;return vals}vals.perimeter=this._perimetersum.Sum();tempsum=this.polyline?0:this._areasum.Sum();crossings=this._crossings;for(i=0;i<(this.polyline?1:2);++i){t=this._geod.Inverse(i===0?this.lat:lat,i===0?this.lon:lon,i!==0?this._lat0:lat,i!==0?this._lon0:lon,this._mask);vals.perimeter+=t.s12;if(!this.polyline){tempsum+=t.S12;crossings+=transit(i===0?this.lon:lon,i!==0?this._lon0:lon)}}if(this.polyline)return vals;if(crossings&1)tempsum+=(tempsum<0?
1:-1)*this._area0/2;if(!reverse)tempsum*=-1;if(sign)if(tempsum>this._area0/2)tempsum-=this._area0;else{if(tempsum<=-this._area0/2)tempsum+=this._area0}else if(tempsum>=this._area0)tempsum-=this._area0;else if(tempsum<0)tempsum+=this._area0;vals.area=tempsum;return vals};p.PolygonArea.prototype.TestEdge=function(azi,s,reverse,sign){var vals={number:this.num?this.num+1:0},t,tempsump,crossings;if(this.num===0)return vals;vals.perimeter=this._perimetersum.Sum()+s;if(this.polyline)return vals;tempsum=
this._areasum.Sum();crossings=this._crossings;t=this._geod.Direct(this.lat,this.lon,azi,s,this._mask);tempsum+=t.S12;crossings+=transitdirect(this.lon,t.lon2);t=this._geod(t.lat2,t.lon2,this._lat0,this._lon0,this._mask);perimeter+=t.s12;tempsum+=t.S12;crossings+=transit(t.lon2,this._lon0);if(crossings&1)tempsum+=(tempsum<0?1:-1)*this._area0/2;if(!reverse)tempsum*=-1;if(sign)if(tempsum>this._area0/2)tempsum-=this._area0;else{if(tempsum<=-this._area0/2)tempsum+=this._area0}else if(tempsum>=this._area0)tempsum-=
this._area0;else if(tempsum<0)tempsum+=this._area0;vals.area=tempsum;return vals}})(GeographicLib.PolygonArea,GeographicLib.Geodesic,GeographicLib.Math,GeographicLib.Accumulator);window["GeographicLib"]=GeographicLib;window["GeographicLib"]["Geodesic"]=GeographicLib.Geodesic;window["GeographicLib"]["Geodesic"]["Geodesic"]=GeographicLib.Geodesic.Geodesic;var l,ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},da="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this;
function ea(a,b){if(b){for(var c=da,d=a.split("."),e=0;e<d.length-1;e++){var g=d[e];g in c||(c[g]={});c=c[g]}d=d[d.length-1];e=c[d];g=b(e);g!=e&&null!=g&&ba(c,d,{configurable:!0,writable:!0,value:g})}}ea("Array.prototype.find",function(a){return a?a:function(a,c){var b;a:{b=this;b instanceof String&&(b=String(b));for(var e=b.length,g=0;g<e;g++){var f=b[g];if(a.call(c,f,g,b)){b=f;break a}}b=void 0}return b}});ea("Number.isNaN",function(a){return a?a:function(a){return"number"===typeof a&&isNaN(a)}});
var q={};window.M=q;window.Melown=q;window.ga=null!=window.ga?window.ga:{};window.MelownMap_=null!=window.MelownMap_?window.MelownMap_:null;window.Q=null!=window.Q?window.Q:{};window.$=null!=window.$?window.$:{};q.Xe=Array;q.vr={};q.vr.create=function(a){var b=new q.Xe(2);a&&(b[0]=a[0],b[1]=a[1]);return b};q.xf={};q.xf.create=function(a){var b=new q.Xe(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};q.xf.eb=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};q.xf.Zk=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]};q.F={};q.F.create=function(a){var b=new q.Xe(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b};q.F.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};
q.F.add=function(a,b,c){if(!c||a==c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c};q.F.ps=function(a,b,c){if(!c||a==c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};q.F.as=function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};q.F.scale=function(a,b,c){if(!c||a==c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c};
q.F.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=Math.sqrt(c*c+d*d+e*e);if(g){if(1==g)return b[0]=c,b[1]=d,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;g=1/g;b[0]=c*g;b[1]=d*g;b[2]=e*g;return b};q.F.xi=function(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var g=b[0],f=b[1];b=b[2];c[0]=e*b-a*f;c[1]=a*g-d*b;c[2]=d*f-e*g;return c};q.F.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};q.F.eb=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};
q.F.os=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e};q.F.direction=function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(d*d+e*e+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=e*b;c[2]=a*b;return c};q.F.Tr=function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d};q.F.fk=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};q.$c={};
q.$c.create=function(a){var b=new q.Xe(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9]);return b};q.$c.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};q.$c.ma=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};
q.$c.zd=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b};q.$c.nr=function(a,b){b||(b=q.i.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
q.$c.fk=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};q.i={};q.i.create=function(a){var b=new q.Xe(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b};
q.i.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};q.i.ma=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
q.i.zd=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[3],g=a[6],f=a[7],k=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=g;a[11]=a[14];a[12]=e;a[13]=f;a[14]=k;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b};
q.i.Mr=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],g=a[4],f=a[5],k=a[6],h=a[7],m=a[8],n=a[9],p=a[10],t=a[11],u=a[12],w=a[13],v=a[14];a=a[15];return u*n*k*e-m*w*k*e-u*f*p*e+g*w*p*e+m*f*v*e-g*n*v*e-u*n*d*h+m*w*d*h+u*c*p*h-b*w*p*h-m*c*v*h+b*n*v*h+u*f*d*t-g*w*d*t-u*c*k*t+b*w*k*t+g*c*v*t-b*f*v*t-m*f*d*a+g*n*d*a+m*c*k*a-b*n*k*a-g*c*p*a+b*f*p*a};
q.i.inverse=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],f=a[4],k=a[5],h=a[6],m=a[7],n=a[8],p=a[9],t=a[10],u=a[11],w=a[12],v=a[13],C=a[14],N=a[15],x=c*k-d*f,D=c*h-e*f,G=c*m-g*f,U=d*h-e*k,r=d*m-g*k,y=e*m-g*h,Z=n*v-p*w,I=n*C-t*w,K=n*N-u*w,ja=p*C-t*v,ka=p*N-u*v,ha=t*N-u*C,aa=1/(x*ha-D*ka+G*ja+U*K-r*I+y*Z);b[0]=(k*ha-h*ka+m*ja)*aa;b[1]=(-d*ha+e*ka-g*ja)*aa;b[2]=(v*y-C*r+N*U)*aa;b[3]=(-p*y+t*r-u*U)*aa;b[4]=(-f*ha+h*K-m*I)*aa;b[5]=(c*ha-e*K+g*I)*aa;b[6]=(-w*y+C*G-N*D)*aa;b[7]=(n*y-t*G+u*D)*aa;
b[8]=(f*ka-k*K+m*Z)*aa;b[9]=(-c*ka+d*K-g*Z)*aa;b[10]=(w*r-v*G+N*x)*aa;b[11]=(-n*r+p*G-u*x)*aa;b[12]=(-f*ja+k*I-h*Z)*aa;b[13]=(c*ja-d*I+e*Z)*aa;b[14]=(-w*U+v*D-C*x)*aa;b[15]=(n*U-p*D+t*x)*aa;return b};q.i.ss=function(a,b){b||(b=q.i.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
q.i.$m=function(a,b){b||(b=q.$c.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};q.i.mr=function(a,b){var c=a[0],d=a[1],e=a[2],g=a[4],f=a[5],k=a[6],h=a[8],m=a[9],n=a[10],p=n*f-k*m,t=-n*g+k*h,u=m*g-f*h,w=c*p+d*t+e*u;if(!w)return null;w=1/w;b||(b=q.$c.create());b[0]=p*w;b[1]=(-n*d+e*m)*w;b[2]=(k*d-e*f)*w;b[3]=t*w;b[4]=(n*c-e*h)*w;b[5]=(-k*c+e*g)*w;b[6]=u*w;b[7]=(-m*c+d*h)*w;b[8]=(f*c-d*g)*w;return b};
q.i.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],g=a[2],f=a[3],k=a[4],h=a[5],m=a[6],n=a[7],p=a[8],t=a[9],u=a[10],w=a[11],v=a[12],C=a[13],N=a[14];a=a[15];var x=b[0],D=b[1],G=b[2],U=b[3],r=b[4],y=b[5],Z=b[6],I=b[7],K=b[8],ja=b[9],ka=b[10],ha=b[11],aa=b[12],Ea=b[13],Ha=b[14];b=b[15];c[0]=x*d+D*k+G*p+U*v;c[1]=x*e+D*h+G*t+U*C;c[2]=x*g+D*m+G*u+U*N;c[3]=x*f+D*n+G*w+U*a;c[4]=r*d+y*k+Z*p+I*v;c[5]=r*e+y*h+Z*t+I*C;c[6]=r*g+y*m+Z*u+I*N;c[7]=r*f+y*n+Z*w+I*a;c[8]=K*d+ja*k+ka*p+ha*v;c[9]=K*e+ja*h+ka*t+ha*
C;c[10]=K*g+ja*m+ka*u+ha*N;c[11]=K*f+ja*n+ka*w+ha*a;c[12]=aa*d+Ea*k+Ha*p+b*v;c[13]=aa*e+Ea*h+Ha*t+b*C;c[14]=aa*g+Ea*m+Ha*u+b*N;c[15]=aa*f+Ea*n+Ha*w+b*a;return c};q.i.Za=function(a,b,c){c||(c=b);var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c};
q.i.Sh=function(a,b,c){c||(c=b);var d=b[0],e=b[1],g=b[2];b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*g+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*g+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*g+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*g+a[15]*b;return c};
q.i.translate=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;var g=a[0],f=a[1],k=a[2],h=a[3],m=a[4],n=a[5],p=a[6],t=a[7],u=a[8],w=a[9],v=a[10],C=a[11];c[0]=g;c[1]=f;c[2]=k;c[3]=h;c[4]=m;c[5]=n;c[6]=p;c[7]=t;c[8]=u;c[9]=w;c[10]=v;c[11]=C;c[12]=g*d+m*e+u*b+a[12];c[13]=f*d+n*e+w*b+a[13];c[14]=k*d+p*e+v*b+a[14];c[15]=h*d+t*e+C*b+a[15];return c};
q.i.scale=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};
q.i.rotate=function(a,b,c,d){var e=c[0],g=c[1];c=c[2];var f=Math.sqrt(e*e+g*g+c*c);if(!f)return null;1!=f&&(f=1/f,e*=f,g*=f,c*=f);var k=Math.sin(b),h=Math.cos(b),m=1-h;b=a[0];var f=a[1],n=a[2],p=a[3],t=a[4],u=a[5],w=a[6],v=a[7],C=a[8],N=a[9],x=a[10],D=a[11],G=e*e*m+h,U=g*e*m+c*k,r=c*e*m-g*k,y=e*g*m-c*k,Z=g*g*m+h,I=c*g*m+e*k,K=e*c*m+g*k,e=g*c*m-e*k,g=c*c*m+h;d?a!=d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*G+t*U+C*r;d[1]=f*G+u*U+N*r;d[2]=n*G+w*U+x*r;d[3]=p*G+v*U+D*r;d[4]=b*y+t*
Z+C*I;d[5]=f*y+u*Z+N*I;d[6]=n*y+w*Z+x*I;d[7]=p*y+v*Z+D*I;d[8]=b*K+t*e+C*g;d[9]=f*K+u*e+N*g;d[10]=n*K+w*e+x*g;d[11]=p*K+v*e+D*g;return d};q.i.ks=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[4],g=a[5],f=a[6],k=a[7],h=a[8],m=a[9],n=a[10],p=a[11];c?a!=c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=e*b+h*d;c[5]=g*b+m*d;c[6]=f*b+n*d;c[7]=k*b+p*d;c[8]=e*-d+h*b;c[9]=g*-d+m*b;c[10]=f*-d+n*b;c[11]=k*-d+p*b;return c};
q.i.ls=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],f=a[2],k=a[3],h=a[8],m=a[9],n=a[10],p=a[11];c?a!=c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+h*-d;c[1]=g*b+m*-d;c[2]=f*b+n*-d;c[3]=k*b+p*-d;c[8]=e*d+h*b;c[9]=g*d+m*b;c[10]=f*d+n*b;c[11]=k*d+p*b;return c};
q.i.ms=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],f=a[2],k=a[3],h=a[4],m=a[5],n=a[6],p=a[7];c?a!=c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+h*d;c[1]=g*b+m*d;c[2]=f*b+n*d;c[3]=k*b+p*d;c[4]=e*-d+h*b;c[5]=g*-d+m*b;c[6]=f*-d+n*b;c[7]=k*-d+p*b;return c};
q.i.ro=function(a,b,c,d,e,g,f){f||(f=q.i.create());var k=b-a,h=d-c,m=g-e;f[0]=2*e/k;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2*e/h;f[6]=0;f[7]=0;f[8]=(b+a)/k;f[9]=(d+c)/h;f[10]=-(g+e)/m;f[11]=-1;f[12]=0;f[13]=0;f[14]=-(g*e*2)/m;f[15]=0;return f};q.i.perspective=function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return q.i.ro(-b,b,-a,a,c,d,e)};
q.i.ds=function(a,b,c,d,e,g,f){f||(f=q.i.create());var k=b-a,h=d-c,m=g-e;f[0]=2/k;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2/h;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=-2/m;f[11]=0;f[12]=-(a+b)/k;f[13]=-(d+c)/h;f[14]=-(g+e)/m;f[15]=1;return f};
q.i.Wr=function(a,b,c,d){d||(d=q.i.create());var e=a[0],g=a[1];a=a[2];var f=c[0],k=c[1],h=c[2];c=b[1];var m=b[2];if(e==b[0]&&g==c&&a==m)return q.i.ma(d);var n,p,t,u;c=e-b[0];m=g-b[1];b=a-b[2];u=1/Math.sqrt(c*c+m*m+b*b);c*=u;m*=u;b*=u;n=k*b-h*m;h=h*c-f*b;f=f*m-k*c;(u=Math.sqrt(n*n+h*h+f*f))?(u=1/u,n*=u,h*=u,f*=u):f=h=n=0;k=m*f-b*h;p=b*n-c*f;t=c*h-m*n;(u=Math.sqrt(k*k+p*p+t*t))?(u=1/u,k*=u,p*=u,t*=u):t=p=k=0;d[0]=n;d[1]=k;d[2]=c;d[3]=0;d[4]=h;d[5]=p;d[6]=m;d[7]=0;d[8]=f;d[9]=t;d[10]=b;d[11]=0;d[12]=
-(n*e+h*g+f*a);d[13]=-(k*e+p*g+t*a);d[14]=-(c*e+m*g+b*a);d[15]=1;return d};q.i.fk=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};q.nc={};q.nc.create=function(a){var b=new q.Xe(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};q.nc.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};
q.nc.Jr=function(a,b){var c=a[0],d=a[1],e=a[2];if(!b||a==b)return a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a;b[0]=c;b[1]=d;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};q.nc.inverse=function(a,b){if(!b||a==b)return a[0]*=1,a[1]*=1,a[2]*=1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};q.nc.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};
q.nc.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],f=Math.sqrt(c*c+d*d+e*e+g*g);if(0==f)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;b[3]=g*f;return b};q.nc.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],g=a[2];a=a[3];var f=b[0],k=b[1],h=b[2];b=b[3];c[0]=d*b+a*f+e*h-g*k;c[1]=e*b+a*k+g*f-d*h;c[2]=g*b+a*h+d*k-e*f;c[3]=a*b-d*f-e*k-g*h;return c};
q.nc.Za=function(a,b,c){c||(c=b);var d=b[0],e=b[1],g=b[2];b=a[0];var f=a[1],k=a[2];a=a[3];var h=a*d+f*g-k*e,m=a*e+k*d-b*g,n=a*g+b*e-f*d,d=-b*d-f*e-k*g;c[0]=h*a+d*-b+m*-k-n*-f;c[1]=m*a+d*-f+n*-b-h*-k;c[2]=n*a+d*-k+h*-f-m*-b;return c};q.nc.$m=function(a,b){b||(b=q.$c.create());var c=a[0],d=a[1],e=a[2],g=a[3],f=c+c,k=d+d,h=e+e,m=c*f,n=c*k,c=c*h,p=d*k,d=d*h,e=e*h,f=g*f,k=g*k,g=g*h;b[0]=1-(p+e);b[1]=n-g;b[2]=c+k;b[3]=n+g;b[4]=1-(m+e);b[5]=d-f;b[6]=c-k;b[7]=d+f;b[8]=1-(m+p);return b};
q.nc.nr=function(a,b){b||(b=q.i.create());var c=a[0],d=a[1],e=a[2],g=a[3],f=c+c,k=d+d,h=e+e,m=c*f,n=c*k,c=c*h,p=d*k,d=d*h,e=e*h,f=g*f,k=g*k,g=g*h;b[0]=1-(p+e);b[1]=n-g;b[2]=c+k;b[3]=0;b[4]=n+g;b[5]=1-(m+e);b[6]=d-f;b[7]=0;b[8]=c-k;b[9]=d+f;b[10]=1-(m+p);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};q.nc.ns=function(a,b,c,d){d||(d=a);var e=c;0>a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]&&(e=-1*c);d[0]=1-c*a[0]+e*b[0];d[1]=1-c*a[1]+e*b[1];d[2]=1-c*a[2]+e*b[2];d[3]=1-c*a[3]+e*b[3];return d};
q.nc.fk=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};q.Math={};q.Math.mat4Multiply=q.i.multiply;q.Math.mat4Inverse=q.i.inverse;q.Math.mat4ToMat3=q.i.$m;q.Math.mat4ToInverseMat3=q.i.mr;q.Math.mat4Transpose=q.i.zd;q.Math.mat3Transpose=q.$c.zd;q.Math.vec3Normalize=q.F.normalize;q.Math.vec3Dot=q.F.eb;q.Math.vec3Cross=q.F.xi;q.Math.vec3Length=q.F.length;
q.so=function(a,b,c,d,e,g){var f=b-a,k=d-c,h=g-e;a=q.i.create([2*e/f,0,(b+a)/f,0,0,2*e/k,(d+c)/k,0,0,0,-(g+e)/h,-2*g*e/h,0,0,-1,0]);q.i.zd(a);return a};q.Up=function(a,b,c,d){a=c*Math.tan(a*Math.PI/180);b*=a;return q.so(-b,b,-a,a,c,d)};q.Sp=function(a,b,c,d){var e=d-c;a=q.i.create([1/(.5*a*b),0,0,0,0,1/(.5*a),0,0,0,0,-2/e,-((d+c)/e),0,0,0,1]);q.i.zd(a);return a};
q.dc=function(a,b){var c=Math.cos(b),d=Math.sin(b);switch(a){case 0:c=[1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1];break;case 1:c=[c,0,-d,0,0,1,0,0,d,0,c,0,0,0,0,1];break;default:c=[c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1]}q.i.zd(c);return c};q.vg=function(a,b,c){a=[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1];q.i.zd(a);return a};q.Dq=function(a){return q.vg(a,a,a)};q.ed=function(a,b,c){a=[1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1];q.i.zd(a);return a};q.ts=function(a){return q.ed(a[0],a[1],0)};q.us=function(a){return q.ed(a[0],a[1],a[2])};
q.isEqual=function(a,b,c){return Math.abs(a-b)<c};q.de=function(a,b,c){a<b?a=b:a>c&&(a=c);return a};q.Ka=function(a){return a*Math.PI/180};q.Vk=function(a){return a/Math.PI*180};q.Cp=function(a,b,c){return a+(b-a)*c};q.Oa=function(a,b){return"boolean"===typeof a?a:b};q.Bd=function(a,b,c){var d=Number.Br;return"number"===typeof a?q.de(a,b,d):c};q.li=function(a,b){return"string"===typeof a?a:b};
q.es=function(a,b){if(0>a)return a=-a+"",b--,a.length>=b?"-"+a:"-"+(Array(b-a.length+1).join("0")+a);a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a};q.Sn=function(a){var b=(a&31744)>>10;fraction=a&1023;return(a>>15?-1:1)*(b?31===b?fraction?NaN:Infinity:Math.pow(2,b-15)*(1+fraction/1024):fraction/1024*6.103515625E-5)};q.Kq=function(a){var b={copy:"&copy;",Y:(new Date).getFullYear()};return a&&""!=a?a.replace(/\{([_$a-zA-Z0-9][_$a-zA-Z0-9]*)\}/g,function(a,d){return d in b?b[d]:a}):""};
q.Em=function(a){return a&&""!=a?q.Kq(a).replace(/\[([^\]]*)\]/g,function(a,c){c=c.trim();urls_=c.split(" ");return-1!=urls_[0].indexOf("//")?1<urls_.length?"<a href="+urls_[0]+" target='_blank'>"+c.substring(urls_[0].length)+"</a>":"<a href="+urls_[0]+" target='_blank'>"+urls_[0]+"</a>":c}):""};q.Lq=function(a,b,c){return a&&""!=a?a.replace(/\{([_$a-zA-Z(-9][_$a-zA-Z(-9]*)\}/g,function(a,e){return e in b?b[e]:c(e)}):""};
q.Or=function(a){return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?[parseInt(a[4],16),parseInt(a[3],16),parseInt(a[2],16),parseInt(a[1],16)]:[0,0,0,255]};q.Tq=function(){return"("+q.pn+").call(self);"};
q.Zc=function(a,b,c,d,e,g){var f=new XMLHttpRequest;f.onreadystatechange=function(){switch(f.readyState){case 4:if(400<=f.status||0==f.status)c&&c(f.status);else{var e=f.response,g=e;if(!d)try{g=JSON.parse(e)}catch(m){console.log("JSON Parse Error ("+a+"): "+(m.message?m.message:""));c&&c(f.status);break}b&&b(g)}}}.bind(this);f.open("GET",a,!0);f.withCredentials=e;g&&g.token&&f.setRequestHeader("Accept","token/"+g.token+", */*");f.send("")};
q.Dc=function(a,b,c,d,e,g){var f=new XMLHttpRequest;f.onreadystatechange=function(){switch(f.readyState){case 0:case 1:case 2:case 3:break;case 4:if(400<=f.status||0==f.status){c&&c(f.status);break}var a=f.response;if(!a){c&&c();break}a=g&&"arraybuffer"!=g?a:new DataView(a);b&&b(a);break;default:c&&c()}}.bind(this);f.open("GET",a,!0);f.responseType=g?g:"arraybuffer";f.withCredentials=d;e&&e.token&&f.setRequestHeader("Accept","token/"+e.token+", */*");f.send("")};
window.performance=window.performance||{};performance.now=performance.now||performance.Yr||performance.Zr||performance.bs||performance.webkitNow||function(){return(new Date).getTime()};window.ym=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};"undefined"===typeof Array.isArray&&(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});
q.isEqual=q.isEqual;q.clamp=q.de;q.mix=q.Cp;q.radians=q.Ka;q.degrees=q.Vk;q.loadJSON=q.Zc;q.loadBinary=q.Dc;
q.ta={Rd:!1,ic:function(){var a=q.ta;a.ri=a.Cm(a.Pn)||"An unknown browser";a.version=a.Dm(navigator.userAgent.toLowerCase())||a.Dm(navigator.appVersion)||"an unknown version";a.be=a.Cm(a.Qn)||"an unknown os: ua: "+navigator.userAgent+" pl: "+navigator.platform;a.Ud="iphone/ipod"==a.be||"android"==a.be||"ipad"==a.be||"windows ce"==a.be||"windows phone"==a.be||"kindle"==a.be;a.Dp="android"==a.be;a.Rd=!0},uo:function(){q.ta.Rd||q.ta.ic();return q.ta.ri},vo:function(){q.ta.Rd||q.ta.ic();return q.ta.ri},
Eo:function(){q.ta.Rd||q.ta.ic();return q.ta.ri},Ml:function(){q.ta.Rd||q.ta.ic();return q.ta.Ud},ip:function(){q.ta.Rd||q.ta.ic();return q.ta.Dp},Cm:function(a){for(var b=q.ta,c=0;c<a.length;c++){var d=a[c].ya,e=a[c].uq;b.jn=a[c].Je||a[c].ma;if(d){if(-1!=d.toLowerCase().indexOf(a[c].za))return null!=a[c].version&&(b.version=a[c].version),a[c].ma}else if(e)return a[c].ma}},Dm:function(a){var b=q.ta;if(null!=b.version)return b.version;var c=a.indexOf(b.jn);if(-1!=c)return parseFloat(a.substring(c+
b.jn.length+1))},Pn:[{ya:navigator.userAgent,za:"chrome",ma:"chrome"},{ya:navigator.userAgent,za:"firefox",ma:"firefox"},{ya:navigator.vendor,za:"apple",ma:"safari",Je:"version"},{uq:window.opera,ma:"opera",Je:"version"},{ya:navigator.vendor,za:"icab",ma:"icab"},{ya:navigator.vendor,za:"kde",ma:"konqueror"},{ya:navigator.vendor,za:"camino",ma:"camino"},{ya:navigator.userAgent,za:"netscape",ma:"netscape"},{ya:navigator.userAgent,za:"msie",ma:"explorer",Je:"msie"},{ya:navigator.userAgent,za:"trident/",
ma:"explorer",version:"11"},{ya:navigator.userAgent,za:"edge/",ma:"explorer",version:"12"},{ya:navigator.userAgent,za:"omniweb",Je:"omniweb/",ma:"omniweb"},{ya:navigator.userAgent,za:"silk",Je:"silk/",ma:"silk"},{ya:navigator.userAgent,za:"gecko",ma:"mozilla",Je:"rv"},{ya:navigator.userAgent,za:"mozilla",ma:"netscape",Je:"mozilla"}],Qn:[{ya:navigator.userAgent,za:"windows ce",ma:"windows ce"},{ya:navigator.userAgent,za:"windows phone",ma:"windows phone"},{ya:navigator.platform,za:"win",ma:"windows"},
{ya:navigator.platform,za:"mac",ma:"mac"},{ya:navigator.userAgent,za:"iphone",ma:"iphone/ipod"},{ya:navigator.userAgent,za:"ipod",ma:"iphone/ipod"},{ya:navigator.userAgent,za:"ipad",ma:"ipad"},{ya:navigator.userAgent,za:"android",ma:"android"},{ya:navigator.userAgent,za:"silk",ma:"kindle"},{ya:navigator.userAgent,za:"blackberry",ma:"blackberry"},{ya:navigator.platform,za:"linux",ma:"linux"}]};q.getBrowser=q.ta.uo;q.getBrowserVersion=q.ta.vo;q.getOS=q.ta.Eo;q.isPlatformMobileDevice=q.ta.Ml;
q.isPlatformAndroid=q.ta.ip;q.qa={};q.qa.Qr=function(a){if("string"!==typeof a)return!1;var b=document.location.hostname;return q.qa.parse(a).hostname===b};q.qa.parse=function(a){if("string"!==typeof a)return null;var b=document.createElement("a");b.href=a;return b};
q.qa.Fo=function(a){var b={};a=q.qa.parse(a).search.substring(1).split("&");if(1!=a.length||""!=a[0])for(var c=0;c<a.length;c++){var d=a[c].split("=");"undefined"===typeof b[d[0]]?b[d[0]]=d[1]:"string"===typeof b[d[0]]?b[d[0]]=[b[d[0]],d[1]]:b[d[0]].push(d[1])}return b};q.qa.Co=function(a){var b=document.createElement("a");b.href=a;return b.hostname};
q.qa.jh=function(a){if(-1!=a.indexOf("http://"))return"http:";if(-1!=a.indexOf("https://"))return"https:";var b=document.createElement("a");b.href=a;return b.protocol};q.qa.gh=function(a){var b=document.createElement("a");b.href=a;return b.origin};q.qa.eh=function(a){return a.split("?")[0].split("/").slice(0,-1).join("/")+"/"};
q.qa.rl=function(a,b){if(!a||!b)return a;a=a.trim();b=b.trim();var c=q.qa.eh(b),d=q.qa.jh(b),e=q.qa.gh(b);return-1!=a.indexOf("://")?a:0==a.indexOf("//")?d+a:0==a.indexOf("/")?e+a:c+a};q.Url=q.qa;q.qa.getParamsFromUrl=q.qa.Fo;q.cb={};q.cb.tp=function(a,b,c,d){!a instanceof Image||"string"!==typeof b||(d||(a.crossOrigin=c?"use-credentials":"anonymous"),a.src=b)};q.cb.cj=function(a,b,c,d,e){var g=new Image;g.onerror=c;g.onload=b;q.cb.tp(g,a,d,e);return g};q.cb.Zc=function(a,b,c){q.Dc(a,b,c)};
q.cb.Dc=function(a,b,c){q.Dc(a,b,c)};q.cb.Jl=function(a,b,c,d,e){var g=new XMLHttpRequest;g.onreadystatechange=function(){switch(g.readyState){case 0:case 1:case 2:case 3:break;case 4:null!=b&&b(g.getAllResponseHeaders(),g.status);break;default:null!=c&&c()}}.bind(this);g.onerror=function(){null!=c&&c()}.bind(this);g.open("HEAD",a,!0);g.withCredentials=d;e&&e.token&&g.setRequestHeader("Accept","token/"+e.token+", */*");g.send("")};q.Http=q.cb;q.cb.imageFactory=q.cb.cj;q.cb.loadJSON=q.cb.Zc;
q.cb.loadBinary=q.cb.Dc;q.cb.headRequest=q.cb.Jl;function la(a){a=this.m=a.m;if(null!=a){this.P=null;this.P=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.P);var b=[0,0,0,1,0,0,1,0,0,1,1,0,1,1,0,0,1,0,0,1,0,0,0,0,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,1,1,0,0,1,0,1,1,1,0,1,1,1,0,1,0,0,1,1];a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);this.P.ia=3;this.P.W=b.length/3;this.s=36;this.kj=this.P.W/3}}la.prototype.D=function(){this.m.deleteBuffer(this.P)};
la.prototype.Ua=function(a,b){var c=this.m;if(null!=c){var d=a.getAttribute(b);c.bindBuffer(c.ARRAY_BUFFER,this.P);c.vertexAttribPointer(d,this.P.ia,c.FLOAT,!1,0,0);c.drawArrays(c.LINES,0,this.P.W)}};function oa(a,b,c,d){this.Gd=a;this.Ha=null;this.ja=b;this.Rk=null;this.cm=8;this.Gp=new Uint8Array(this.cm);this.mo=new Uint8Array(this.cm);this.Sk=this.Tn=this.Fd({});this.Nl=null==c?!1:c;this.tn=d?!0:!1}l=oa.prototype;
l.ic=function(){this.Ha=document.createElement("canvas");if(null!=this.Ha&&(this.Ha.width=this.ja[0],this.Ha.height=this.ja[1],this.Ha.style.display="block",null!=this.Ha.getContext)){try{this.m=this.Ha.getContext("webgl",{preserveDrawingBuffer:this.Nl,antialias:this.tn,stencil:!0})||this.Ha.getContext("experimental-webgl",{preserveDrawingBuffer:this.Nl})}catch(a){}this.m&&(this.m.getExtension("OES_standard_derivatives"),this.Gd.appendChild(this.Ha),this.m.Ak=this.Ha.width,this.m.zk=this.Ha.height,
this.m.clearColor(0,0,0,1),this.m.enable(this.m.DEPTH_TEST),this.m.viewport(0,0,this.m.Ak,this.m.zk),this.m.clear(this.m.COLOR_BUFFER_BIT|this.m.DEPTH_BUFFER_BIT))}};l.D=function(){this.Gd.removeChild(this.Ha);delete this.Ha;this.Ha=null};l.resize=function(a,b){this.ja=a;null!=this.Ha&&1!=b&&(this.Ha.width=this.ja[0],this.Ha.height=this.ja[1]);null!=this.m&&(this.m.Ak=this.Ha.width,this.m.zk=this.Ha.height)};function ta(a){a.m.viewport(0,0,a.m.Ak,a.m.zk)}
l.clear=function(a,b,c){null!=c&&this.m.clearColor(c[0]/255,c[1]/255,c[2]/255,c[3]/255);this.m.clear((a?this.m.COLOR_BUFFER_BIT:0)|(b?this.m.DEPTH_BUFFER_BIT:0))};
l.useProgram=function(a,b,c){if(this.Rk!=a){this.m.useProgram(a.Ja);this.Rk=a;ua(a,"uSampler",0);c&&ua(a,"uSampler2",1);c=this.Gp;for(var d=this.mo,e=0,g=c.length;e<g;e++)c[e]=0;e=0;for(g=b.length;e<g;e++){var f=a.getAttribute(b[e]);-1!=f&&(c[f]=1)}e=0;for(g=c.length;e<g;e++)d[e]!=c[e]&&(c[e]?(this.m.enableVertexAttribArray(e),d[e]=1):(this.m.disableVertexAttribArray(e),d[e]=0))}};
l.bindTexture=function(a,b){0!=a.Ec&&(this.m.activeTexture(b?this.m.TEXTURE1:this.m.TEXTURE0),this.m.bindTexture(this.m.TEXTURE_2D,a.L))};q.zr=function(){return!0};function wa(a,b){null!=b?a.m.bindFramebuffer(a.m.FRAMEBUFFER,b.kl):(a.m.bindTexture(a.m.TEXTURE_2D,null),a.m.bindRenderbuffer(a.m.RENDERBUFFER,null),a.m.bindFramebuffer(a.m.FRAMEBUFFER,null))}
oa.prototype.Fd=function(a){null==a.Dd&&(a.Dd=!1);null==a.tf&&(a.tf=!1);null==a.mn&&(a.mn=0);null==a.Jg&&(a.Jg=!0);null==a.Ig&&(a.Ig=!0);null==a.Bf&&(a.Bf=!1);null==a.Sc&&(a.Sc=!0);return a};
oa.prototype.vd=function(a){var b=this.m,c=this.Sk;c.Dd!=a.Dd&&(1==a.Dd?(b.blendEquationSeparate(b.FUNC_ADD,b.FUNC_ADD),b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND)):b.disable(b.BLEND));c.tf!=a.tf&&(1==a.tf?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST));c.Jg!=a.Jg&&(1==a.Jg?b.depthMask(!0):b.depthMask(!1));c.Ig!=a.Ig&&(0!=a.Ig?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST));c.Bf!=a.Bf&&(0!=a.Bf?b.depthFunc(b.LEQUAL):b.depthFunc(b.LESS));
c.Sc!=a.Sc&&(1==a.Sc?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE));this.Sk=a};function xa(a,b,c,d){this.v=null;this.j=a;this.m=a.m;this.C=b;this.jd=[];this.rf=0;this.Vc=c;this.s=d;this.L=this.Ca=null;this.Li(c,d)}xa.prototype.D=function(){};
xa.prototype.Li=function(a,b){null==a&&(a="Arial, 'Helvetica Neue', Helvetica, sans-serif");null==b&&(b=10);var c=1/512,d=1/512,e=document.createElement("canvas");e.width=512;e.height=512;e=e.getContext("2d");e.beginPath();e.font=b+"pt "+a;e.textAlign="left";e.textBaseline="top";e.fillStyle="#ffffff";e.strokeStyle="#000000";e.lineWidth=5;e.lineCap="round";e.lineJoin="round";var g=Math.round(.5*e.lineWidth),f=e.lineWidth+2,k=f,h=f,m=Math.floor(2.5*e.measureText("e").width);this.jd=[];this.rf=m;this.s=
b;this.Vc=a;for(var n=[],p=33;191>p;p++)n.push(p);for(p=192;688>p;p++)n.push(p);for(var n=n.concat(32,8230,8216,8217,8218,8219,8220,8221,8222,8242,8243,8252),p=0,t=n.length;p<t;p++){var u=String.fromCharCode(n[p]),w=Math.round(e.measureText(u).width),v=w+e.lineWidth;512<=k+w+f&&(k=f,h+=m+f);e.strokeText(u,k+g,h);e.fillText(u,k+g,h);this.jd[n[p]]={rk:k*c,vk:h*d,sk:(k+v)*c,wk:(h+m)*d,pj:v,up:m,Ee:v-2};k+=v+f}this.Ca=e.getImageData(0,0,512,512);this.L=new Aa(this.j,null);Da(this.L,this.Ca,"linear");
this.L.Cd=512;this.L.Ze=512;this.L.s=1048576};xa.prototype.size=function(){return this.s};function Fa(a,b,c,d,e){this.f=a;this.v=null;this.ve=c||[0,0,0];this.j=d;this.m=d.m;this.l=e;this.nd=[];this.Yd=0;null!=b&&null!=b[0]&&null!=b[1]&&(this.v=new Ga(b[0][0],b[0][1],b[0][2],b[1][0],b[1][1],b[1][2]));this.yb=this.s=0}
Fa.prototype.D=function(){for(var a=0,b=this.nd.length;a<b;a++){var c=this.nd[a];switch(c.S){case "flat-line":c.P&&this.m.deleteBuffer(c.P);break;case "flat-tline":case "pixel-line":case "pixel-tline":c.P&&this.m.deleteBuffer(c.P);c.Ke&&this.m.deleteBuffer(c.Ke);break;case "line-label":c.P&&this.m.deleteBuffer(c.P);c.tb&&this.m.deleteBuffer(c.tb);break;case "icon":case "label":c.P&&this.m.deleteBuffer(c.P),c.tb&&this.m.deleteBuffer(c.tb),c.ae&&this.m.deleteBuffer(c.ae)}}};Fa.prototype.size=function(){return this.s};
function Ma(a,b){var c=a.m,d=b.vertexBuffer,e=b.normalBuffer,g=b.color,f=1/255,k={};k.S=b.type;k.Ja=b.program;k.Rc=[g[0]*f,g[1]*f,g[2]*f,g[3]*f];k.Af=b["z-index"]+256;k.Gf=b["click-event"];k.bg=b["hover-event"];k.$f=b.hitable;k.Nf=b.eventInfo;k.$g=b["enter-event"];k.xh=b["leave-event"];k.xd=b.state;k.hd=b.center;k.da=b.lod;k.Tl=b["line-width"];k.Ne=b["zbuffer-offset"];k.Yd=!1;k.aa=!0;if(null!=b.texture){var g=b.texture,h=g[0];k.L=[Na(a.l,h.url,h.filter||"linear",h.tiled||!1),g[1],g[2],g[3],g[4]];
h=b.background;0!=h[3]&&(k.Ek=[h[0]*f,h[1]*f,h[2]*f,h[3]*f])}switch(k.S){case "flat-tline":k.Ja=0!=h[3]?a.l.mq:a.l.nq;break;case "pixel-line":k.Ja=a.l.jq;break;case "pixel-tline":k.Ja=0!=h[3]?a.l.oq:a.l.pq}k.P=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,k.P);c.bufferData(c.ARRAY_BUFFER,d,c.STATIC_DRAW);k.P.ia=4;k.P.W=d.length/4;k.Ke=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,k.Ke);c.bufferData(c.ARRAY_BUFFER,e,c.STATIC_DRAW);k.Ke.ia=4;k.Ke.W=e.length/4;a.nd.push(k);a.s+=4*d.length+4*e.length;a.yb+=
d.length/4}
function Oa(a,b,c){var d=a.m,e=b.vertexBuffer,g=b.texcoordsBuffer,f=b.originBuffer,k=b.color,h=b.stick,m=1/255,n={};n.S=c?"label":"icon";n.Ja=b.program;n.Rc=[k[0]*m,k[1]*m,k[2]*m,k[3]*m];n.Af=b["z-index"]+256;n.zf=b.visibility;n.Sc=b.culling;n.Gf=b["click-event"];n.bg=b["hover-event"];n.$g=b["enter-event"];n.xh=b["leave-event"];n.$f=b.hitable;n.Nf=b.eventInfo;n.xd=b.state;n.hd=b.center;n.uf=[h[0],h[1],h[2],h[3]*m,h[4]*m,h[5]*m,h[6]*m];n.da=b.lod;n.Ne=b["zbuffer-offset"];n.Yd=!1;n.aa=!0;1!=c?(b=b.icon,
n.L=Na(a.l,b.url,b.filter||"linear",b.tiled||!1)):n.L=a.l.Vc.L;n.P=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,n.P);d.bufferData(d.ARRAY_BUFFER,e,d.STATIC_DRAW);n.P.ia=4;n.P.W=e.length/4;n.tb=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,n.tb);d.bufferData(d.ARRAY_BUFFER,g,d.STATIC_DRAW);n.tb.ia=4;n.tb.W=g.length/4;n.ae=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,n.ae);d.bufferData(d.ARRAY_BUFFER,f,d.STATIC_DRAW);n.ae.ia=3;n.ae.W=f.length/3;a.nd.push(n);a.s+=4*n.P.W+4*n.ae.W+4*n.tb.W;a.yb+=n.P.W/
4}
Fa.prototype.Ua=function(a,b,c){if(null==this.f||!1!==this.l.mp[this.f]){if(1==c){c=q.i.create();var d=q.i.create(),e=this.l.fa,g=this.l.Sr[this.f];if(null!=g){var f=g[1],f=[f[0]-e[0],f[1]-e[1],f[2]];q.i.multiply(q.ed(f[0],f[1],f[2]),g[0],d);q.i.multiply(a,d,d)}else f=[this.ve[0]-e[0],this.ve[1]-e[1],this.ve[2]],q.i.multiply(a,q.ed(f[0],f[1],f[2]),d);q.i.multiply(b,d,c);a=d;b=c}c=this.l.va;for(var d=this.l.me,e=this.l.fg,g=this.l.Kj,f=0,k=this.nd.length;f<k;f++){var h=this.nd[f];if(("icon"==h.S||"label"==
h.S)&&0<h.zf){var m=h.hd;if(q.F.length([m[0]-c[0],m[1]-c[1],m[2]-c[2]])>h.zf)continue}if(!g||h.$f)h.$r=a,h.og=b,m=h.Af,d[m][e[m]]=h,e[m]++}}};
q.ao=function(a,b,c,d,e){var g=d.og;if(d.aa){if(0!=d.xd){var f=d.Nf.id;if(null!=f&&null!=c.bj)if(1==d.xd){if(c.bj[0].id==f)return}else{if(c.bj[0].id!=f)return}else if(2==d.xd)return}var k=d.$f&&c.Kj,f=d.Rc;if(k){var h=c.Kl,f=[(h&255)/255,(h>>8&255)/255,(h>>16&255)/255,1];c.ap[h]=[d.Nf,d.hd,d.Gf,d.bg,d.$g,d.xh];c.Kl++}switch(d.S){case "flat-line":a.vd(q.mi);h=c.kq;a.useProgram(h,["aPosition"]);Pa(h,"uColor",f);Qa(h,"uMVP",g,Ra(c,d.Ne));a=h.getAttribute("aPosition");b.bindBuffer(b.ARRAY_BUFFER,d.P);
b.vertexAttribPointer(a,d.P.ia,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLES,0,d.P.W);break;case "flat-tline":case "pixel-line":case "pixel-tline":a.vd(q.mi);var h=d.Ja,m=[0,0,0,0];if("pixel-line"!=d.S){if(k)k=c.Le;else{var n=d.L;if(null==n||null==n[0])break;k=n[0];m=[0,n[1]/n[0].Ze,(n[1]+n[2])/n[0].Ze,0];m[0]="flat-tline"==d.S?1/d.Tl/(k.Cd/n[2]):1/k.Cd/1}if(0==k.Ec)break;a.bindTexture(k)}a.useProgram(h,["aPosition","aNormal"]);Pa(h,"uColor",f);Sa(h,"uScale",e);Qa(h,"uMVP",g,Ra(c,d.Ne));"pixel-line"!=
d.S&&(null!=d.Ek&&Pa(h,"uColor2",d.Ek),Pa(h,"uParams",m),ua(h,"uSampler",0));a=h.getAttribute("aPosition");c=h.getAttribute("aNormal");b.bindBuffer(b.ARRAY_BUFFER,d.P);b.vertexAttribPointer(a,d.P.ia,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,d.Ke);b.vertexAttribPointer(c,d.Ke.ia,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLES,0,d.P.W);break;case "line-label":k=k?c.Le:c.Vc.L;a.vd(q.Bk);h=c.sm;a.bindTexture(k);a.useProgram(h,["aPosition","aTexCoord"]);ua(h,"uSampler",0);Qa(h,"uMVP",g,Ra(c,d.Ne));Pa(h,"uVec",
c.fj);Pa(h,"uColor",f);a=h.getAttribute("aPosition");c=h.getAttribute("aTexCoord");b.bindBuffer(b.ARRAY_BUFFER,d.P);b.vertexAttribPointer(a,d.P.ia,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,d.tb);b.vertexAttribPointer(c,d.tb.ia,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLES,0,d.P.W);break;case "icon":case "label":if(k=k?c.Le:d.L,0!=k.Ec){if(180!=d.Sc){h=d.hd;m=c.va;h=[h[0]-m[0],h[1]-m[1],h[2]-m[2]];if(0!=d.zf){m=q.F.length(h);if(m>d.zf)break;m=1/m;h[0]*=m;h[1]*=m;h[2]*=m}else q.F.normalize(h);d.im=[0,
0,0];q.F.normalize(d.hd,d.im);if(-q.F.eb(h,d.im)<Math.cos(q.Ka(d.Sc)))break}else if(0!=d.zf&&(h=d.hd,m=c.va,h=[h[0]-m[0],h[1]-m[1],h[2]-m[2]],m=q.F.length(h),m>d.zf))break;a.vd(q.Bk);m=0;0!=d.uf[0]&&(h=d.uf,m=c.Mk*h[0],m<h[1]?m=0:0!=h[2]&&(n=Ta(c,d.hd,g),n[0]=Math.round(n[0]),c.fe([[n[0],n[1],n[2]],[n[0],n[1]-m,n[2]]],h[2],[h[3],h[4],h[5],h[6]],null,null,null,!0)));h=c.iq;a.bindTexture(k);a.useProgram(h,["aPosition","aTexCoord","aOrigin"]);ua(h,"uSampler",0);Qa(h,"uMVP",g,Ra(c,d.Ne));Pa(h,"uScale",
[e[0],e[1],"label"==d.S?1:1/k.Cd,2*m]);Pa(h,"uColor",f);a=h.getAttribute("aPosition");c=h.getAttribute("aTexCoord");e=h.getAttribute("aOrigin");b.bindBuffer(b.ARRAY_BUFFER,d.P);b.vertexAttribPointer(a,d.P.ia,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,d.tb);b.vertexAttribPointer(c,d.tb.ia,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,d.ae);b.vertexAttribPointer(e,d.ae.ia,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLES,0,d.P.W)}}}};
function Xa(a,b,c,d){this.m=a.m;this.v=b.v;this.Sb=c;this.C=d;this.Kc=this.Lc=this.ha=null;performance.now();a=b.T;c=b.Fg;d=b.gn;var e=b.xr||3,g=b.sr||2;b=b.rr||2;var f=this.m;a&&f&&(this.ha=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,this.ha),f.bufferData(f.ARRAY_BUFFER,new Float32Array(a),f.STATIC_DRAW),this.ha.ia=e,this.ha.W=a.length/e,null!=c&&(this.Lc=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,this.Lc),f.bufferData(f.ARRAY_BUFFER,new Float32Array(c),f.STATIC_DRAW),this.Lc.ia=g,this.Lc.W=c.length/
g),null!=d&&(this.Kc=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,this.Kc),f.bufferData(f.ARRAY_BUFFER,new Float32Array(d),f.STATIC_DRAW),this.Kc.ia=b,this.Kc.W=d.length/b),this.s=this.ha.W*e*4,this.s+=null==c?0:this.Lc.W*g*4,this.s+=null==d?0:this.Kc.W*b*4,this.yb=this.ha.W/3,this.Ad=!0)}Xa.prototype.D=function(){this.m&&this.Ad&&(this.ha&&this.m.deleteBuffer(this.ha),this.Lc&&this.m.deleteBuffer(this.Lc),this.Kc&&this.m.deleteBuffer(this.Kc),this.Kc=this.Lc=this.ha=null)};
Xa.prototype.Ua=function(a,b,c,d,e){var g=this.m;null!=g&&this.Ad&&(b=a.getAttribute(b),g.bindBuffer(g.ARRAY_BUFFER,this.ha),g.vertexAttribPointer(b,this.ha.ia,g.FLOAT,!1,0,0),this.Lc&&c&&(c=a.getAttribute(c),g.bindBuffer(g.ARRAY_BUFFER,this.Lc),g.vertexAttribPointer(c,this.Lc.ia,g.FLOAT,!1,0,0)),this.Kc&&d&&(d=a.getAttribute(d),g.bindBuffer(g.ARRAY_BUFFER,this.Kc),g.vertexAttribPointer(d,this.Kc.ia,g.FLOAT,!1,0,0)),e&&e&&(a=a.getAttribute(e),g.bindBuffer(g.ARRAY_BUFFER,q.Oe),g.vertexAttribPointer(a,
q.Oe.ia,g.FLOAT,!1,0,0)),g.drawArrays(g.TRIANGLES,0,this.ha.W))};Xa.prototype.size=function(){return this.s};function Ya(a,b,c,d,e,g){this.v=null;this.j=a;this.m=a.m;this.C=b;performance.now();null!=this.m&&(this.T=[],this.ha=null,this.kj=c,this.rh=e,this.qh=g,this.Dj=d,this.ic())}l=Ya.prototype;l.D=function(){this.m.deleteBuffer(this.ha)};
l.ic=function(){if(this.kj){this.rh&&bb(this,0,this.qh);for(var a=0;a<this.Dj;a++){var b=a,c=a+1,d=this.T.length;this.T[d]=b;this.T[d+1]=c;this.T[d+2]=1;this.T[d+3]=b;this.T[d+4]=c;this.T[d+5]=-1;this.T[d+6]=c;this.T[d+7]=b;this.T[d+8]=1;this.T[d+9]=b;this.T[d+10]=c;this.T[d+11]=1;this.T[d+12]=c;this.T[d+13]=b;this.T[d+14]=1;this.T[d+15]=c;this.T[d+16]=b;this.T[d+17]=-1;this.yb+=2;this.rh&&bb(this,a+1,this.qh)}}else if(this.rh)for(a=0;a<=this.Dj;a++)bb(this,a,this.qh);this.compile()};
function bb(a,b,c){var d=a.T.length,e=2*Math.PI/c;for(i=0;i<c;i++)a.T[d]=b,a.T[d+1]=-1,a.T[d+2]=0,a.T[d+3]=b,a.T[d+4]=-2,a.T[d+5]=e*i,a.T[d+6]=b,a.T[d+7]=-2,a.T[d+8]=e*(i+1),d+=9;a.yb+=c}l.compile=function(){var a=this.m;this.ha=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.ha);a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.T),a.STATIC_DRAW);this.ha.ia=3;this.ha.W=this.T.length/3;this.s=24*this.ha.W;this.yb=this.ha.W/3};
l.Ua=function(a,b,c){var d=this.m;null==d||null==this.ha||c>this.Dj||(a=a.getAttribute(b),d.bindBuffer(d.ARRAY_BUFFER,this.ha),d.vertexAttribPointer(a,this.ha.ia,d.FLOAT,!1,0,0),a=0,this.kj&&(a+=6*(c-1)),this.rh&&(a+=3*c*this.qh),d.drawArrays(d.TRIANGLES,0,a))};l.size=function(){return this.s};function z(a,b,c){this.j=a;this.m=a.m;this.Ja=null;this.tk=[];this.pi=[];this.xp=new Float32Array(16);this.createProgram(b,c)}
z.prototype.createShader=function(a,b){var c=this.m;if(!a||!c)return null;var d;d=1!=b?c.createShader(c.FRAGMENT_SHADER):c.createShader(c.VERTEX_SHADER);c.shaderSource(d,a);c.compileShader(d);return c.getShaderParameter(d,c.COMPILE_STATUS)?d:(alert("An error occurred compiling the shaders: "+c.getShaderInfoLog(d)),null)};
z.prototype.createProgram=function(a,b){var c=this.m;if(null!=c){var d=this.createShader(a,!0),e=this.createShader(b,!1),g=c.createProgram();c.attachShader(g,d);c.attachShader(g,e);c.linkProgram(g);c.getProgramParameter(g,c.LINK_STATUS)||alert("Unable to initialize the shader program.");c.useProgram(g);this.Ja=g}};function ua(a,b,c){var d=a.m;null!=d&&null!=a.Ja&&(a=a.getUniform(b),null!=a&&d.uniform1i(a,c))}
function Qa(a,b,c,d){var e=a.m;null!=e&&null!=a.Ja&&(b=a.getUniform(b),null!=b&&(d?(d=1+d,a=a.xp,a[0]=c[0],a[1]=c[1],a[2]=c[2]*d,a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6]*d,a[7]=c[7],a[8]=c[8]*d,a[9]=c[9]*d,a[10]=c[10]*d,a[11]=c[11]*d,a[12]=c[12],a[13]=c[13],a[14]=c[14]*d,a[15]=c[15],e.uniformMatrix4fv(b,!1,a)):e.uniformMatrix4fv(b,!1,c)))}function Sa(a,b,c){var d=a.m;null!=d&&null!=a.Ja&&(a=a.getUniform(b),null!=a&&d.uniform2fv(a,c))}
function cb(a,b,c){var d=a.m;null!=d&&null!=a.Ja&&(a=a.getUniform(b),null!=a&&d.uniform3fv(a,c))}function Pa(a,b,c){var d=a.m;null!=d&&null!=a.Ja&&(a=a.getUniform(b),null!=a&&d.uniform4fv(a,c))}function db(a,b,c){var d=a.m;null!=d&&null!=a.Ja&&(a=a.getUniform(b),null!=a&&d.uniform1f(a,c))}function eb(a,b,c){var d=a.m;null!=d&&null!=a.Ja&&(a=a.getUniform(b),null!=a&&d.uniform1fv(a,c))}
z.prototype.getAttribute=function(a){var b=this.m;if(null!=b&&null!=this.Ja)return null==this.pi[a]?(b=b.getAttribLocation(this.Ja,a),this.pi[a]=b):this.pi[a]};z.prototype.getUniform=function(a){var b=this.m;if(null!=b&&null!=this.Ja)return null==this.tk[a]?(b=b.getUniformLocation(this.Ja,a),this.tk[a]=b):this.tk[a]};q.xn="attribute vec3 aPosition;\nuniform mat4 uMVP;\nvoid main(){ \ngl_Position = uMVP * vec4(aPosition, 1.0);\n}";q.wn="precision mediump float;\nvoid main() {\ngl_FragColor = vec4(0.0, 0.0, 1.0, 1.0);\n}";
q.sp="attribute vec3 aPosition;\nuniform mat4 uMVP;\nvoid main(){ \ngl_Position = uMVP * vec4(aPosition, 1.0);\n}";q.rp="precision mediump float;\nuniform vec4 uColor;\nvoid main() {\ngl_FragColor = uColor;\n}";q.op="attribute vec4 aPosition;\nattribute vec4 aNormal;\nuniform mat4 uMVP;\nuniform vec2 uScale;\nvoid main(){ \nvec4 pp0 = (uMVP * vec4(aPosition.xyz, 1.0));\nif (aNormal.w == 0.0) {\ngl_Position = pp0 + vec4((vec3(aNormal.x*uScale.x*pp0.w, aNormal.y*uScale.y*pp0.w, 0.0)), 0.0);\n} else {\nvec2 pp1 = pp0.xy / pp0.w;\nvec4 pp3 = (uMVP * vec4(aNormal.xyz, 1.0));\nvec2 pp2 = pp3.xy / pp3.w;\nvec2 n = normalize(pp2 - pp1);\ngl_Position = pp0 + vec4((vec3(-n.y*uScale.x*aNormal.w*pp0.w, n.x*uScale.y*aNormal.w*pp0.w, 0.0)), 0.0);\n}\n}";
q.np="precision mediump float;\nuniform vec4 uColor;\nvoid main() {\ngl_FragColor = uColor;\n}";q.qp="attribute vec3 aPosition;\nuniform mat4 uMVP;\nuniform vec3 uScale;\nuniform vec3 uPoints[32];\nvoid main(){ \nvec4 pp0 = (uMVP * vec4(uPoints[int(aPosition.x)], 1.0));\nif (aPosition.y < 0.0) {\nif (aPosition.y == -1.0) {\ngl_Position = pp0;\n} else {\ngl_Position = pp0 + vec4((vec3(-sin(aPosition.z)*uScale.x*uScale.z, cos(aPosition.z)*uScale.y*uScale.z, 0.0)), 0.0);\n}\n} else {\nvec2 pp1 = pp0.xy / pp0.w;\nvec4 pp3 = (uMVP * vec4(uPoints[int(aPosition.y)], 1.0));\nvec2 pp2 = pp3.xy / pp3.w;\nvec2 n = normalize(pp2 - pp1);\ngl_Position = pp0 + vec4((vec3(-n.y*uScale.x*aPosition.z*uScale.z, n.x*uScale.y*aPosition.z*uScale.z, 0.0)), 0.0);\n}\n}";
q.pp="precision mediump float;\nuniform vec4 uColor;\nvoid main() {\ngl_FragColor = uColor;\n}";q.Zm="attribute vec4 aPosition;\nattribute vec4 aNormal;\nuniform mat4 uMVP;\nuniform vec2 uScale;\nuniform vec4 uParams;\nvarying vec2 vTexCoord;\nvoid main(){ \nvec4 p=vec4(aPosition.xyz, 1.0);\np.xy+=aNormal.xy;\nif (aNormal.w == 0.0){\nfloat tcy=(uParams[1]+uParams[2])*0.5;\nfloat tdy=uParams[1]-tcy;\nfloat ty=(aNormal.x == 0.0 && aNormal.y == 0.0)?tcy:tcy+tdy*cos(aNormal.z);\nvTexCoord=vec2(abs(aPosition.w)*uParams[0], ty);\n} else {\nvTexCoord=vec2(abs(aPosition.w)*uParams[0], aPosition.w < 0.0 ? uParams[1] : uParams[2]);\n}\ngl_Position = uMVP * p;\n}";
q.dn="attribute vec4 aPosition;\nattribute vec4 aNormal;\nuniform mat4 uMVP;\nuniform vec2 uScale;\nuniform vec4 uParams;\nvarying vec2 vTexCoord;\nvoid main(){ \nvec4 pp0 = (uMVP * vec4(aPosition.xyz, 1.0));\nvTexCoord=vec2(abs(aPosition.w)*uParams[0], aPosition.w < 0.0 ? uParams[1] : uParams[2]);\nif (aNormal.w == 0.0) {\ngl_Position = pp0 + vec4((vec3(aNormal.x*uScale.x*pp0.w, aNormal.y*uScale.y*pp0.w, 0.0)), 0.0);\n} else {\nvec2 pp1 = pp0.xy / pp0.w;\nvec4 pp3 = (uMVP * vec4(aNormal.xyz, 1.0));\nvec2 pp2 = pp3.xy / pp3.w;\nvec2 n = normalize(pp2 - pp1);\ngl_Position = pp0 + vec4((vec3(-n.y*uScale.x*aNormal.w*pp0.w, n.x*uScale.y*aNormal.w*pp0.w, 0.0)), 0.0);\n}\n}";
q.Ym="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform vec4 uColor2;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 c=texture2D(uSampler, vTexCoord)*uColor;\ngl_FragColor = c;\n}";q.Qm="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform vec4 uColor2;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 c=texture2D(uSampler, vTexCoord)*uColor;\nvec4 c2=uColor2;\nc.xyz*=c.w; c2.xyz*=c2.w;\nc=mix(c,c2,1.0-c.w);\nc.xyz/=(c.w+0.00001);\ngl_FragColor = c;\n}";
q.eq="attribute vec3 aPosition;\nattribute vec3 aNormal;\nuniform mat4 uMVP;\nuniform mat4 uRot;\nuniform vec4 uColor;\nvarying vec4 vColor;\nvoid main(){ \nfloat l = dot((uRot*vec4(aNormal,1.0)).xyz, vec3(0.0,0.0,1.0)) * 0.5;\nvec3 c = uColor.xyz;\nc = (l > 0.0) ? mix(c,vec3(1.0,1.0,1.0),l) : mix(vec3(0.0,0.0,0.0),c,1.0+l);\nvColor = vec4(c, uColor.w);\ngl_Position = uMVP * vec4(aPosition, 1.0);\n}";q.cq="precision mediump float;\nvarying vec4 vColor;\nvoid main() {\ngl_FragColor = vColor;\n}";
q.Wq="attribute vec4 aPosition;\nattribute vec4 aTexCoord;\nuniform mat4 uMVP;\nuniform vec4 uVec;\nvarying vec2 vTexCoord;\nvoid main(){ \nvTexCoord = aTexCoord.xy;\nif (dot(uVec.xyz, vec3(aTexCoord.z, aTexCoord.w, aPosition.w)) < 0.0) {\ngl_Position = uMVP * vec4(2.0, 0.0, 0.0, 1.0);\n}else{\ngl_Position = uMVP * vec4(aPosition.xyz, 1.0);\n}\n}";q.Xq="attribute vec3 aPosition;\nattribute vec4 aTexCoord;\nuniform mat4 uMVP;\nuniform vec4 uPosition;\nuniform float uDepth;\nvarying vec2 vTexCoord;\nvoid main(){ \nvTexCoord = aTexCoord.xy;\ngl_Position = uMVP*vec4(aPosition[0]+uPosition[0],-aPosition[1]+uPosition[1],uPosition[2],1.0);\n}";
q.cp="attribute vec4 aPosition;\nattribute vec4 aTexCoord;\nattribute vec3 aOrigin;\nuniform mat4 uMVP;\nuniform vec4 uScale;\nvarying vec2 vTexCoord;\nvoid main(){ \nvTexCoord = aTexCoord.xy * uScale[2];\nvec4 pos = (uMVP * vec4(aOrigin, 1.0));\ngl_Position = pos + vec4(aPosition.x*uScale.x*pos.w, (aPosition.y+uScale.w)*uScale.y*pos.w, 0.0, 0.0);\n}";q.ik="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 c=texture2D(uSampler, vTexCoord);\nif(c.w < 0.01){ discard; }\ngl_FragColor = c*uColor;\n}";
q.Gm="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMVP;\nvarying vec2 vTexCoord;\nvoid main(){ \ngl_Position = uMVP * vec4(aPosition, 1.0);\nvTexCoord = aTexCoord;\n}";q.Oq="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nconst vec4 gray = vec4(0.125, 0.125, 0.125, 1.0);\nvoid main() {\nfloat fade = smoothstep(0.51, 0.55, vTexCoord.t);\ngl_FragColor = mix(texture2D(uSampler, vTexCoord), gray, fade);\n}";q.Rq="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uSampler, vTexCoord);\n}";
q.vn="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform mat3 uNorm;\nvarying vec3 vNormal;\nvarying vec4 vPosition;\nvoid main(){ \nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nvec4 c = uMV * vec4(aPosition, 1.0);\nvNormal = uNorm * (aPosition.xyz - vec3(0.5));\nvPosition = camSpacePos;\n}";q.un="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uNFactor;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec3 ldir = normalize(-vPosition.xyz);\nvec4 c = texture2D(uSampler, vec2(0,0));\nfloat l = dot(normalize(vNormal*uNFactor),ldir);\nc = mix(vec4(0.0,0.0,0.0,1.0),fogColor,max(0.0,-l*3.0));\ngl_FragColor = c;\n}";
q.Fr="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uNFactor;\nuniform vec2 uRadius;\nuniform vec3 uPos;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec3 ldir = normalize(-vPosition.xyz);\nvec3 diff = uPos;\nfloat a = dot(ldir, ldir);\nfloat b = 2 * dot(ldir, diff);\nfloat c = dot(diff, diff) - (uRadius[0] * uRadius[0]);\nfloat i = 0;\nfloat discr = b * b - 4 * a * c;\nif (discr > 0.0) {}\n}\ngl_FragColor = fogColor;\n}";
q.Zo="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nuniform mat4 uGridMat;\nuniform float uGridStep1, uGridStep2;\nconst int HMSize = 5;\nconst float HMSize1 = float(HMSize-1);\nuniform float uHeight[HMSize*HMSize];\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nfloat round(float x) { return floor(x + 0.5); }\nvoid main() {\nvec3 pos = aPosition;\nfloat z = uHeight[int(round(pos.y*HMSize1)*float(HMSize) + round(pos.x*HMSize1))];\nvec4 camSpacePos = uMV * vec4(pos.xy, z, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvec4 gridCoord = uGridMat * vec4(pos, 1.0);\nvTexCoord1 = aTexCoord;\nvTexCoord1 = gridCoord.xy * vec2(uGridStep1);\nvTexCoord2 = gridCoord.xy * vec2(uGridStep2);\n}";
q.Xo="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uGridBlend;\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec4 gridColor = mix(texture2D(uSampler, vTexCoord1), texture2D(uSampler, vTexCoord2), uGridBlend);\ngl_FragColor = mix(fogColor, gridColor, vFogFactor);\n}";q.Wo="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nuniform mat4 uGridMat;\nuniform float uGridStep1, uGridStep2;\nconst int HMSize = 5;\nconst float HMSize1 = float(HMSize-1);\nuniform float uHeight[HMSize*HMSize];\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vDepth;\nfloat round(float x) { return floor(x + 0.5); }\nvoid main() {\nvec3 pos = aPosition;\nfloat z = uHeight[int(round(pos.y*HMSize1)*float(HMSize) + round(pos.x*HMSize1))];\nvec4 camSpacePos = uMV * vec4(pos.xy, z, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvDepth = camDist;\nvec4 gridCoord = uGridMat * vec4(pos, 1.0);\nvTexCoord1 = aTexCoord;\nvTexCoord1 = gridCoord.xy * vec2(uGridStep1);\nvTexCoord2 = gridCoord.xy * vec2(uGridStep2);\n}";
q.Vo="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uGridBlend;\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vDepth;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\ngl_FragColor = fract(vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0) * vDepth) + (-0.5/255.0);\n}";q.gs="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform vec4 uParams;\nuniform float uPoints[9*3];\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nvec3 quadPoint(int i1, int i2, int i3, float t, float t2) {\nfloat p1x = uPoints[i1], p1y = uPoints[i1+1], p1z = uPoints[i1+2];\nfloat p3x = uPoints[i3], p3y = uPoints[i3+1], p3z = uPoints[i3+2];\nfloat p2x = 2.0*uPoints[i2]-p1x*0.5-p3x*0.5;\nfloat p2y = 2.0*uPoints[i2+1]-p1y*0.5-p3y*0.5;\nfloat p2z = 2.0*uPoints[i2+2]-p1z*0.5-p3z*0.5;\nreturn vec3(t2*t2*p1x+2.0*t2*t*p2x+t*t*p3x, t2*t2*p1y+2.0*t2*t*p2y+t*t*p3y, t2*t2*p1z+2.0*t2*t*p2z+t*t*p3z); }\nvoid main() {\nvec3 indices = aPosition;\nfloat t = aPosition.y * uParams[2];\nfloat t2 = (1.0-t);\nvec3 p1 = quadPoint(0, 3, 6, t, t2);\nvec3 p2 = quadPoint(9, 9+3, 9+6, t, t2);\nvec3 p3 = quadPoint(18, 18+3, 18+6, t, t2);\nt = aPosition.x * uParams[2];\nt2 = (1.0-t);\nfloat p2x = 2.0*p2.x-p1.x*0.5-p3.x*0.5;\nfloat p2y = 2.0*p2.y-p1.y*0.5-p3.y*0.5;\nfloat p2z = 2.0*p2.z-p1.z*0.5-p3.z*0.5;\nvec4 p = vec4(t2*t2*p1.x+2.0*t2*t*p2x+t*t*p3.x, t2*t2*p1.y+2.0*t2*t*p2y+t*t*p3.y, t2*t2*p1.z+2.0*t2*t*p2z+t*t*p3.z, 1);\nvec4 camSpacePos = uMV * p;\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uParams[1] * camDist);\nvTexCoord = aTexCoord;\n}";
q.fs="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\ngl_FragColor = texture2D(uSampler, vTexCoord*4.0);\n}";q.Zp="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform vec4 uParams;\nuniform float uPoints[9*3];\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nvec3 quadPoint(int i1, int i2, int i3, float t, float t2) {\nfloat p1x = uPoints[i1], p1y = uPoints[i1+1], p1z = uPoints[i1+2];\nfloat p3x = uPoints[i3], p3y = uPoints[i3+1], p3z = uPoints[i3+2];\nfloat p2x = 2.0*uPoints[i2]-p1x*0.5-p3x*0.5;\nfloat p2y = 2.0*uPoints[i2+1]-p1y*0.5-p3y*0.5;\nfloat p2z = 2.0*uPoints[i2+2]-p1z*0.5-p3z*0.5;\nreturn vec3(t2*t2*p1x+2.0*t2*t*p2x+t*t*p3x, t2*t2*p1y+2.0*t2*t*p2y+t*t*p3y, t2*t2*p1z+2.0*t2*t*p2z+t*t*p3z); }\nvoid main() {\nvec3 indices = aPosition;\nfloat t = aPosition.y * uParams[2];\nfloat t2 = (1.0-t);\nvec3 p1 = quadPoint(0, 3, 6, t, t2);\nvec3 p2 = quadPoint(9, 9+3, 9+6, t, t2);\nvec3 p3 = quadPoint(18, 18+3, 18+6, t, t2);\nt = aPosition.x * uParams[2];\nt2 = (1.0-t);\nfloat p2x = 2.0*p2.x-p1.x*0.5-p3.x*0.5;\nfloat p2y = 2.0*p2.y-p1.y*0.5-p3.y*0.5;\nfloat p2z = 2.0*p2.z-p1.z*0.5-p3.z*0.5;\nvec4 p = vec4(t2*t2*p1.x+2.0*t2*t*p2x+t*t*p3.x, t2*t2*p1.y+2.0*t2*t*p2y+t*t*p3.y, t2*t2*p1.z+2.0*t2*t*p2z+t*t*p3.z, 1);\nvec4 camSpacePos = uMV * p;\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uParams[1] * camDist);\nvTexCoord = aTexCoord * uParams[0];\nvTexCoord2 = aTexCoord * uParams[3];\n}";
q.Xp="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uParams2;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\ngl_FragColor = texture2D(uSampler, vTexCoord * 4.0);\n}";q.ir="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform vec4 uParams;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uParams[1] * camDist);\nvTexCoord = aTexCoord;\n}";
q.fr="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\ngl_FragColor = mix(fogColor, texture2D(uSampler, vTexCoord), vFogFactor);\n}";q.Sm="attribute vec3 aPosition;\nattribute vec2 aTexCoord2;\nuniform mat4 uMV, uProj;\nuniform vec4 uParams;\nuniform vec4 uTransform;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uParams[1] * camDist);\nvTexCoord = vec2(uTransform[0] * aTexCoord2[0] + uTransform[2], uTransform[1] * aTexCoord2[1] + uTransform[3]);\n}";
q.$q="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uAlpha;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec4 c = texture2D(uSampler, vTexCoord);\ngl_FragColor = mix(fogColor, c, vFogFactor);\ngl_FragColor[3] = c.w * uAlpha;\n}";q.ar="precision mediump float;\nuniform sampler2D uSampler;\nuniform sampler2D uSampler2;\nuniform float uAlpha;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec4 c = texture2D(uSampler, vTexCoord);\nvec4 c2 = texture2D(uSampler2, vTexCoord);\ngl_FragColor = mix(fogColor, c, vFogFactor);\ngl_FragColor[3] = c.w * uAlpha * c2.x;\n}";
q.qo="attribute vec3 aPosition;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\n}";q.po="precision mediump float;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\ngl_FragColor = vec4(fogColor.xyz, 1.0-vFogFactor);\n}";
q.Um="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nattribute vec3 aNormal;\nuniform mat4 uMV, uProj;\nuniform mat3 uNorm;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord;\nvPosition = camSpacePos;\nvNormal = aNormal * uNorm;\n}";
q.hr="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nuniform mat4 uMaterial;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec3 ldir = normalize(-vPosition.xyz);\nvec3 normal = normalize(vNormal);\nvec3 eyeDir = ldir;\nvec3 refDir = reflect(-ldir, normal);\nfloat specW = pow(max(dot(refDir, eyeDir), 0.0), uMaterial[3][0]);\nfloat diffW = max(dot(normal, ldir), 0.0);\nvec4 lcolor = uMaterial[0]+(uMaterial[1]*diffW)+(uMaterial[2]*specW);\nvec4 tcolor = texture2D(uSampler, vTexCoord);\ngl_FragColor = mix(fogColor, vec4(lcolor.xyz*(1.0/255.0), 1.0) * tcolor, vFogFactor);\n}";
q.gr="precision mediump float;\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nuniform mat4 uMaterial;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec3 ldir = normalize(-vPosition.xyz);\nvec3 normal = normalize(vNormal);\nvec3 eyeDir = ldir;\nvec3 refDir = reflect(-ldir, normal);\nfloat specW = pow(max(dot(refDir, eyeDir), 0.0), uMaterial[3][0]);\nfloat diffW = max(dot(normal, ldir), 0.0);\nvec4 lcolor = uMaterial[0]+(uMaterial[1]*diffW)+(uMaterial[2]*specW);\ngl_FragColor = mix(fogColor, vec4(lcolor.xyz*(1.0/255.0), 1.0), vFogFactor); gl_FragColor.w=uMaterial[3][1];\n}";
q.er="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nattribute vec3 aBarycentric;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord;\nvBarycentric = camSpacePos.xyz;\n}";q.dr="precision mediump float;\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nvoid main() {\n#ifdef GL_OES_standard_derivatives\nvec3 nx = dFdx(vBarycentric);\nvec3 ny = dFdy(vBarycentric);\nvec3 normal=normalize(cross(nx,ny));\ngl_FragColor = vec4(vec3(max(0.0,normal.z*(204.0/255.0))+(32.0/255.0)),1.0);\n#else\ngl_FragColor = vec4(1.0,1.0,1.0,1.0);\n#endif\n}";
q.Wm="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nattribute vec3 aBarycentric;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord;\nvBarycentric = aBarycentric;\n}";q.Vm="precision mediump float;\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nfloat edgeFactor(){\n#ifdef GL_OES_standard_derivatives\nvec3 d = fwidth(vBarycentric);\nvec3 a3 = smoothstep(vec3(0.0), d*1.0, vBarycentric);\nreturn min(min(a3.x, a3.y), a3.z);\n#else\nfloat a = min(min(vBarycentric.x, vBarycentric.y), vBarycentric.z);\nreturn a > 0.1 ? 1.0 : smoothstep(0.0,1.0,a*10.0);\n#endif\n}\nvoid main() {\ngl_FragColor = mix(fogColor, vec4( mix(vec3(0.0), texture2D(uSampler, vTexCoord).rgb, edgeFactor()) , 1.0), vFogFactor);\n}";
q.jr="precision mediump float;\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nfloat edgeFactor(){\n#ifdef GL_OES_standard_derivatives\nvec3 d = fwidth(vBarycentric);\nvec3 a3 = smoothstep(vec3(0.0), d*1.0, vBarycentric);\nreturn min(min(a3.x, a3.y), a3.z);\n#else\nfloat a = min(min(vBarycentric.x, vBarycentric.y), vBarycentric.z);\nreturn a > 0.1 ? 1.0 : smoothstep(0.0,1.0,a*10.0);\n#endif\n}\nvoid main() {\nif (edgeFactor() < 0.5){ gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0); } else { discard; }}";
q.kr="attribute vec3 aPosition;\nattribute vec2 aTexCoord2;\nattribute vec3 aBarycentric;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord2;\nvBarycentric = aBarycentric;\n}";q.cr="attribute vec3 aPosition;\nuniform mat4 uMV, uProj;\nvarying float vDepth;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvDepth = camDist;\n}";
q.br="precision mediump float;\nuniform sampler2D uSampler;\nvarying float vDepth;\nvoid main() {\ngl_FragColor = fract(vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0) * vDepth) + (-0.5/255.0);\n}";q.fp="\nattribute vec4 aPosition;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uData;\nuniform vec4 uColor;\nuniform float uDepth;\nvarying vec4 vColor;\nvarying vec2 vTexcoords;\nvoid main(void){\nint i=int(aPosition.x);\nif(i==0) gl_Position=uProjectionMatrix*vec4(floor(uData[0][0]+0.1),floor(uData[0][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[0][2], uData[0][3]);\nif(i==1) gl_Position=uProjectionMatrix*vec4(floor(uData[1][0]+0.1),floor(uData[1][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[1][2], uData[1][3]);\nif(i==2) gl_Position=uProjectionMatrix*vec4(floor(uData[2][0]+0.1),floor(uData[2][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[2][2], uData[2][3]);\nif(i==3) gl_Position=uProjectionMatrix*vec4(floor(uData[3][0]+0.1),floor(uData[3][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[3][2], uData[3][3]);\nvec4 c=uColor*(1.0/255.0);\nc.w*=1.0;\nvColor=c;\n}";
q.ep="precision mediump float;\nvarying vec4 vColor;\nvarying vec2 vTexcoords;\nuniform sampler2D uSampler;\nvoid main(void){\nvec4 c=texture2D(uSampler, vec2(vTexcoords.x, vTexcoords.y) );\nc*=vColor;\nif(c.w < 0.01){ discard; }\ngl_FragColor = c;\n}";function Aa(a,b,c,d,e,g,f){this.j=a;this.m=a.m;this.kl=this.L=null;this.s=0;this.Sb=d;this.Ze=this.Cd=0;this.$j=g||!1;this.il=f||"linear";this.Ca=null;this.Ec=!1;this.C=c;null!=b&&this.load(b,null,null,e)}
Aa.prototype.D=function(){this.m.deleteTexture(this.L);this.L=null};Aa.prototype.size=function(){return this.s};
function gb(a,b,c,d,e,g){var f=a.m;a.L=f.createTexture();f.bindTexture(f.TEXTURE_2D,a.L);1==g?(g=f.REPEAT,a.$j=!0):g=f.CLAMP_TO_EDGE;f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,g);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,g);g=!1;switch(e){case "linear":f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);break;case "trilinear":f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR_MIPMAP_LINEAR);f.texParameteri(f.TEXTURE_2D,
f.TEXTURE_MAG_FILTER,f.LINEAR);g=!0;break;default:f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST)}f.pixelStorei(f.UNPACK_ALIGNMENT,1);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,b,c,0,f.RGBA,f.UNSIGNED_BYTE,d);1==g&&f.generateMipmap(f.TEXTURE_2D);f.bindTexture(f.TEXTURE_2D,null);a.Cd=b;a.Ze=c;a.s=b*c*4;a.Ec=!0}
function Da(a,b,c,d){var e=a.m;performance.now();a.L=e.createTexture();e.bindTexture(e.TEXTURE_2D,a.L);1==d?(d=e.REPEAT,a.$j=!0):d=e.CLAMP_TO_EDGE;e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,d);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,d);d=!1;a.il=c;switch(c){case "linear":e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);break;case "trilinear":e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR);e.texParameteri(e.TEXTURE_2D,
e.TEXTURE_MAG_FILTER,e.LINEAR);d=!0;break;default:e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)}1!=q.Hp&&(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,b),1==d&&e.generateMipmap(e.TEXTURE_2D));e.bindTexture(e.TEXTURE_2D,null);a.Cd=b.naturalWidth;a.Ze=b.naturalHeight;a.s=b.naturalWidth*b.naturalHeight*4;a.Ec=!0}
Aa.prototype.load=function(a,b,c,d){this.Ca=q.cb.cj(a,function(){if(null==this.C||1!=this.C.R)Da(this,this.Ca,this.il,this.$j),this.Ca=null,b&&b()}.bind(this),function(){(null==this.C||1!=this.C.R)&&c&&c()}.bind(this),null,d)};
Aa.prototype.createFramebuffer=function(a,b){if(null!=this.L){var c=this.m,d=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,d);d.width=a;d.height=b;c.bindTexture(c.TEXTURE_2D,this.L);var e=c.createRenderbuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,a,b);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,this.L,0);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.bindTexture(c.TEXTURE_2D,
null);c.bindRenderbuffer(c.RENDERBUFFER,null);c.bindFramebuffer(c.FRAMEBUFFER,null);this.kl=d}};q.hs=1.1;q.rs=1;q.Hp=!1;q.mi=null;
function hb(a,b,c,d,e){this.h=e||{};this.pc(e);this.C=a;this.sm=this.tm=this.um=this.Uj=null;this.Gd=b;this.Kj=this.Op=this.Jj=this.R=!1;this.bj=null;this.Kl=0;this.ap=[];this.Ug=[];this.nm=d;this.bg=this.Gf=null;a=this.Gd.getBoundingClientRect();this.ja=[a.width,a.height];this.Uh=[a.width,a.height];this.Ba=!0;this.Ed=[0,1,0];this.j=new oa(b,this.ja,this.h.Yj,this.h.Zj);this.N=new ib(this,45,2,12E5);q.i.create();q.i.create();q.i.create();q.i.create();this.Pf=this.le=this.Fm=this.di=this.Zf=this.aj=
null;this.ag=1024;this.Vc=this.$e=this.ye=this.ze=this.ai=null;this.Ue=0;this.me=Array(512);this.fg=Array(512);b=0;for(a=this.me.length;b<a;b++)this.me[b]=[],this.fg[b]=0;this.mp=[];this.Hk={};this.va=[0,0,0];this.Rg=[0,0,0];this.Xm=this.Yk=this.Mk=1;this.Ed=[0,0,0];this.fj=[0,0,0];q.i.create();this.vh=[0,0,100];window.addEventListener("resize",this.Vh.bind(this),!1);this.j.ic();this.Uj=new z(this.j,q.ir,q.fr);this.rq=new z(this.j,q.Sm,q.$q);this.sq=new z(this.j,q.Sm,q.ar);this.lq=new z(this.j,q.Um,
q.gr);this.qq=new z(this.j,q.Um,q.hr);this.hq=new z(this.j,q.qo,q.po);this.um=new z(this.j,q.Wm,q.Vm);this.tm=new z(this.j,q.Wm,q.jr);this.tq=new z(this.j,q.kr,q.Vm);this.gq=new z(this.j,q.er,q.dr);new z(this.j,q.Zo,q.Xo);this.Tj=new z(this.j,q.Zp,q.Xp);new z(this.j,q.Gm,q.Oq);this.rm=new z(this.j,q.Gm,q.Rq);new z(this.j,q.vn,q.un);this.qm=new z(this.j,q.cr,q.br);new z(this.j,q.Wo,q.Vo);this.kf=new z(this.j,q.xn,q.wn);this.kq=new z(this.j,q.sp,q.rp);this.jq=new z(this.j,q.op,q.np);this.lf=new z(this.j,
q.qp,q.pp);this.nq=new z(this.j,q.Zm,q.Ym);this.pq=new z(this.j,q.dn,q.Ym);this.mq=new z(this.j,q.Zm,q.Qm);this.oq=new z(this.j,q.dn,q.Qm);new z(this.j,q.eq,q.cq);this.sm=new z(this.j,q.Wq,q.ik);new z(this.j,q.Xq,q.ik);this.Ma=new z(this.j,q.fp,q.ep);this.iq=new z(this.j,q.cp,q.ik);b=q.vb.yn();this.aj=new Xa(this.j,b,null,this.C);b=q.vb.zn();this.Yp=new Xa(this.j,b,null,this.C);b=new Uint8Array(16384);for(a=0;64>a;a++)for(c=0;64>c;c++)d=4*(64*a+c),1>a||63<=a||1>c||63<=c?(b[d]=255,b[d+1]=255,b[d+2]=
255):(b[d]=32,b[d+1]=32,b[d+2]=32),b[d+3]=255;this.Zf=new Aa(this.j);gb(this.Zf,64,64,b,"trilinear",!0);b=q.vb.Jk(32,64);this.di=new Xa(this.j,b,null,this.C);b=q.vb.Jk(128,256);this.Dk=new Xa(this.j,b,null,this.C);b=this.ag;a=new Uint8Array(b*b*4);this.le=new Aa(this.j);gb(this.le,b,b,a);this.le.createFramebuffer(b,b);this.Pf=new Aa(this.j);gb(this.Pf,b,b,a);this.Pf.createFramebuffer(b,b);this.jk=new Aa(this.j,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAMAAADTa0c4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRFAAAA////pdmf3QAABIFJREFUeNrsnNuyqzAIhsP7v/Se6Yxra0L4OUVNCzetVqP5DAQItrVOiLg95739NnfOaR99RDj6esBw+CKZXiMK4PiuBkAcANoHAP3J5fzzAV2jePQIt6f4Ndb/MIChlVcCEFpAACZPfN4KUAF0/ufboDW3AuBMFgBwHTCfg2ftYgDUKBuA1ABuHKvA2P+5XdONIEt7BO2o2MdlAJoTQOsV6GEAswt0Zq/bsBhdeQQkqEDMwmIAnJHzA8i3ASkWRFKBbADyLGB3mlYD6DyhA4DfBlgsBDtirUPcBgC5woStYMgVtgKATWcB6DskKUEkGFLYrGw3+l3ydR16wKbbPDlWp4Xfo9vZwR1jtOMA6GkABrdvNmt1Vluy6pyvxu4Xt62fquyTggCTsIkCoIuv8gAA08w+ATBXAdSRY56xPDFPx/VPWFZp5v65kFMPgFjP70YASMfRsDn01xLPcwkRq1HLMoK647hR8v+nId74MQBjvIbUQePra42ZVXVcBCR3mIY89mYAlNGLflqA0V1seosCQNMg80B0bsLGAIDNwvFyiqu66ngVGGMGVBwyWwIwpty2DqEr/qf0Bq+DbjYkkcr4VUoOxiRjrYn3YY5SC4BQB/cF0Lq4kD1RCJ+tN4g6Jps5zfWu+QmSz9sUABkA0BIAXocmBwCJ99MDIASATkmtLQAIft4IgE/ZDStZ59yQbOQQAGZWYMbZ3FFCAGRHnwHQznegGAE+zwxNi8kALCOgS9tzAC4jYG1Qo0myRm0Ae/z8eleqewBoZLwfUswCsbT1KgBZD6QAzAEoXUe3K+xxVf2uLf5U3nBeMPRyACW/LtrwVX989id3PRQOG5Io6vh9XwC6stHIdGdJozun03lxNlwvH4u6UgDM8/LmJyx7ak12feEebaXmUwCOYJWk1JcYKsl74HL74wAaH93NqkE1FSKXc4cv0AjaPEEPgE4ru/ieWdvzVq/4psG3AYDFHlEAioQCuEgMgPjK1VDrqlkbTABAiQBGK38B0BlBSf9xtiAJQDM4NtDqMlaeyduTtkDjHgAtEQBj5ZGK2QE0aCcMAIxLSw0WVYlGDgOQXWE+afouAM0S398O4Nej3wIQf4cIHSfz9pbWugyep4MFIAFARvspbm8BcE2DOdvWnCJQAWFhJ/hKzh4AaB2A7NxedKmLPc+6PN4cL2S8GYC1QMIEQJvmFsJfxdvkEQAoLV4AogBS8/kNvdXlWe5GKhABvQUAZASDALJffY1XfsrToFXFbvYD1gBo6wC8LR7/uvj9CwHcfWuoUJItsVl5nwWAnhxxqsXatUq0OYCcaS/fkbK61u5H8jwAuUIEZXHNL1Jmub5oSKZWiDR9FttM4HEAigqRpn8TeB2AuWNiByAXSHCGbB7/3qYCfgCgPgADEEskbjCCaJDB/+kR6wP4P1Obl8jsBwDUB4yAxqKkthaATjX0KmCtDyCxm+yIMLjCbwBgrg94FYC3h8vLPPmfAVBSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlLy9fJPgAEAvWMULbGsSjwAAAAASUVORK5CYII=",
this.C,null,!0);b=new Uint8Array(2048);for(a=0;8>a;a++)for(c=0;64>c;c++)d=4*(64*a+c),b[d]=0,b[d+1]=0,b[d+2]=0,b[d+3]=255;b=this.j.m;this.ze=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this.ze);b.bufferData(b.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,2,0,0,1,3,0,0,1]),b.STATIC_DRAW);this.ze.ia=4;this.ze.W=4;this.ye=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.ye);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,2,1,0,3,2]),b.STATIC_DRAW);this.ye.ia=1;this.ye.W=6;b=new Uint8Array(1024);
for(a=0;16>a;a++)for(c=0;16>c;c++)d=4*(16*a+c),b[d]=255,b[d+1]=0,b[d+2]=0,b[d+3]=255;this.ai=new Aa(this.j);gb(this.ai,16,16,b);b=new Uint8Array(1024);for(a=0;16>a;a++)for(c=0;16>c;c++)d=4*(16*a+c),b[d]=255,b[d+1]=255,b[d+2]=255,b[d+3]=255;this.Le=new Aa(this.j);gb(this.Le,16,16,b);b=new Uint8Array(1024);for(a=0;16>a;a++)for(c=0;16>c;c++)d=4*(16*a+c),b[d]=0,b[d+1]=0,b[d+2]=0,b[d+3]=255;this.Qg=new Aa(this.j);gb(this.Qg,16,16,b);e="............................................................ .....xxxxx.......................xxxxx...................... .....xxxxx.......................xxxxx...................... .....xxxxx.......................xxxxx...................... xxxxxxxxxxxxxxxx............xxxxxxxxxxxxxxxx................ xxxxxxxxxxxxxxxx............xxxxxxxxxxxxxxxx................ ............................................................".split(" ");
b=new Uint8Array(2048);for(a=0;8>a;a++)for(c=0;64>c;c++)d=4*(64*a+c),b[d]=0,b[d+1]=0,b[d+2]=0,b[d+3]=0;a=0;for(var g=e.length;a<g;a++){var f=e[a];c=0;for(var k=f.length;c<k;c++)d=4*(64*a+c),"."!=f.charAt(c)&&(b[d]=255,b[d+1]=255,b[d+2]=255,b[d+3]=255)}this.jj=new Aa(this.j);gb(this.jj,64,8,b,"linear",!0);this.Og=new la(this.j);this.Vc=new xa(this.j,this.C);this.Xh=new Float32Array(96);this.Qj=new Ya(this.j,this.C,!0,64,!0,8);this.pm=new Ya(this.j,this.C,!1,64,!0,8);b=Array(196605);for(a=0;196605>
a;a+=9)b[a]=1,b[a+1]=0,b[a+2]=0,b[a+3]=0,b[a+4]=1,b[a+5]=0,b[a+6]=0,b[a+7]=0,b[a+8]=1;a=this.j.m;q.Oe=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,q.Oe);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);q.Oe.ia=3;q.Oe.W=b.length/3;1==window.MelownMobile_&&null!=this.j.Ha&&(this.j.Ha.style.width="100%",this.j.Ha.style.height="100%");b=window.MelownScreenScaleFactor_;jb(this,Math.floor(this.ja[0]*b),Math.floor(this.ja[1]*b))}l=hb.prototype;
l.Vh=function(){if(1!=this.R){var a=this.Gd.getBoundingClientRect();jb(this,Math.floor(a.width),Math.floor(a.height));this.nm&&this.nm()}};
l.D=function(){1!=this.R&&(this.R=!0,null!=this.$p&&this.$p.D(),this.aj&&this.aj.D(),this.Zf&&this.Zf.D(),this.di&&this.di.D(),this.Fm&&this.Fm.D(),this.le&&this.le.D(),this.Pf&&this.Pf.D(),this.ai&&this.ai.D(),this.Le&&this.Le.D(),this.Qg&&this.Qg.D(),this.jj&&this.jj.D(),this.jk&&this.jk.D(),this.Dk&&this.Dk.D(),this.Og&&this.Og.D(),this.Vc&&this.Vc.D(),this.Qj&&this.Qj.D(),this.pm&&this.pm.D(),this.j.D())};
function jb(a,b,c){var d=a.N;d.Pe=b/c;d.Ba=!0;a.ja=[b,c];a.Uh=[b,c];a.j.resize(a.ja,void 0);a.j.clear(!0,!1);1!=a.Op&&1!=a.Jj&&1!=a.Kj&&nb(a);d=[];d[0]=2/b;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=-2/c;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=.5*-b*d[0];d[13]=.5*-c*d[5];d[14]=0;d[15]=1;a.$e=d}function Ta(a,b,c){b=q.i.Sh(c,[b[0],b[1],b[2],1]);return 0!=b[3]?(c=[0,0,0],c[0]=.5*(b[0]/b[3]+1)*a.ja[0],c[1]=.5*(-(b[1]/b[3])+1)*a.ja[1],c[2]=b[2]/b[3],c):[0,0,0]}
l.Ve=function(a,b){if(null==this.N)return[0,0,1];var c=[2*a/this.ja[0]-1,1-2*b/this.ja[1],1],d=[c[0],c[1],-1,1],e;q.i.create();e=q.i.inverse(ob(this.N));c=[0,0,0,0];q.i.Sh(e,d,c);c[2]=-1;c[3]=0;q.i.create();d=q.i.inverse(pb(this.N));e=[0,0,0,0];q.i.Sh(d,c,e);return e=q.F.normalize([e[0],e[1],e[2]])};
function qb(a,b){var c=a.j.m;switch(b){case "base":var d=a.Uh[0],e=a.Uh[1];c.clearColor(0,0,0,1);wa(a.j,null);c=a.N;c.Pe=d/e;c.Ba=!0;a.ja=[d,e];a.j.resize(a.ja,!0);a.N.update();a.Jj=!1;break;case "depth":wa(a.j,a.le),a.Uh=[a.ja[0],a.ja[1]],c.clearColor(1,1,1,1),c.enable(c.DEPTH_TEST),d=a.ag,c.viewport(0,0,d,d),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),a.ja=[d,d],a.j.clear(),a.N.update(),a.Jj=!0}}function Ra(a,b){return 1E-4*(b[0]+b[1]*a.Yk+b[2]*a.Xm)}
function Na(a,b,c,d){var e=b+"*"+c+"*"+d,g=a.Hk[e];null==g&&(g=new Aa(a.j,b,a.C,null,null,d,c),a.Hk[e]=g);return g}l.pc=function(a){if("object"===typeof a&&null!==a)for(var b in a)this.ec(b,a[b])};l.ec=function(a,b){switch(a){case "rendererAntialiasing":this.h.Zj=q.Oa(b,!0);break;case "rendererAllowScreenshots":this.h.Yj=q.Oa(b,!1)}};l.Wc=function(a){switch(a){case "rendererAntialiasing":return this.h.Zj;case "rendererAllowScreenshots":return this.h.Yj}};function S(a){this.l=a;this.j=a.j}l=S.prototype;
l.clear=function(a){null!=a&&this.j.clear(a.clearDepth||!0,a.clearColor||!1,a.color||[255,255,255,255],null!=a.depth?a.depth:1);return this};l.Fd=function(a){return null==a||"object"!==typeof a?this:this.j.Fd({Dd:null!=a.blend?a.blend:!1,tf:null!=a.stencil?a.stencil:!1,mn:null!=a.zoffset?a.zoffset:0,Jg:null!=a.zwrite?a.zwrite:!0,Ig:null!=a.ztest?a.ztest:!0,Bf:null!=a.zequal?a.zequal:!0,Sc:null!=a.culling?a.culling:!0})};l.vd=function(a){null!=a&&this.j.vd(a);return this};
l.createTexture=function(a){if(null==a||"object"!==typeof a)return null;var b=a.source;if(null==b)return null;var c=a.filter||"linear",d=a.repeat||!1;if(b instanceof Uint8Array){var e=a.width;a=a.height;if(e&&a){var g=new Aa(this.j);gb(g,e,a,b,filter,d);return g}}return b instanceof Image?(g=new Aa(this.j),Da(g,b,c,d),g):null};l.Aq=function(a){a&&a.D();return this};
l.Nn=function(a){return null==a||"object"!==typeof a?null:new Xa(this.j,{T:a.vertices,Fg:a.uvs,gn:a.normals,xr:a["vertex-size"],sr:a["uv-size"],rr:a["normal-size"]||3,zs:a["vertex-attr"],ys:a["uv-attr"],xs:a["normal-attr"],v:a.bbox},0,this.l.C)};l.yq=function(a){a&&a.D();return this};l.createShader=function(a){if(null==a||"object"!==typeof a)return null;var b=a["vertex-shader"];a=a["fragment-shader"];if(null!=b&&a)return new z(this.j,b,a)};l.zq=function(a){null!=a&&null!=a.D&&resource.D();return this};
l.rn=function(){return this};l.Cn=function(){return this};
l.fo=function(a){if(null==a||"object"!==typeof a||null==!a.mesh||!a["shader-variables"])return this;var b=a.vertex||"aPosition",c=a.uv||"aTexCoord",d=a.normal||"aNormal",e=a["shader-variables"],g=a.shader||"textured",f=this.l,k=a.mesh;a=a.texture;var h=pb(f.N),m=ob(f.N),n=f.Ue;if("string"===typeof g)switch(g){case "hit":e.uMV||(e.uMV=["mat4",h]);e.uProj||(e.uProj=["mat4",m]);a=d=c=null;g=f.qm;break;case "shaded":c=null;case "textured":case "textured-and-shaded":e.uMV||(e.uMV=["mat4",h]),e.uProj||
(e.uProj=["mat4",m]),e.uFogDensity||(e.uFogDensity=["float",n]),d="textured"==g?null:"aNormal",g="textured"==g?f.Uj:"shaded"==g?f.lq:f.qq}h=[b];c&&h.push(c);d&&h.push(d);f.j.useProgram(g,h);for(var p in e)if(h=e[p],2==h.length)switch(h[0]){case "floatArray":eb(g,p,h[1]);break;case "float":db(g,p,h[1]);break;case "mat3":h=h[1];m=g.m;null!=m&&null!=g.Ja&&(n=g.getUniform(p),null!=n&&m.uniformMatrix3fv(n,!1,h));break;case "mat4":Qa(g,p,h[1]);break;case "vec2":Sa(g,p,h[1]);break;case "vec3":cb(g,p,h[1]);
break;case "vec4":Pa(g,p,h[1]);break;case "sampler":ua(g,p,h[1])}a&&f.j.bindTexture(a);k.Ua(g,b,c,d,null);return this};l.drawImage=function(a){if(null==a||"object"!==typeof a||null==a.texture||null==a.rect)return this;var b=a.rect;this.l.drawImage(b[0],b[1],b[2],b[3],a.texture,a.color||[255,255,255,255],null!=a.depth?a.depth:0,null!=a["depth-test"]?a["depth-test"]:!1,null!=a.blend?a.blend:!1,null!=a["write-depth"]?a["write-depth"]:!1,null!=a["use-state"]?a["use-state"]:!1);return this};
l.Ai=function(a){if(null==a||"object"!==typeof a||null==a.texture||null==a.mvp)return this;this.l.Ai(a.mvp,a.texture,a.color||[255,255,255,255],null!=a["depth-test"]?a["depth-test"]:!1,null!=a.blend?a.blend:!1,null!=a["write-depth"]?a["write-depth"]:!1,null!=a["use-state"]?a["use-state"]:!1);return this};
l.fe=function(a){if(null==a||"object"!==typeof a||null==a.points)return this;this.l.fe(a.points,a.size||2,a.color||[255,255,255,255],null!=a["depth-test"]?a["depth-test"]:!1,null!=a.blend?a.blend:!1,null!=a["write-depth"]?a["write-depth"]:!1,null!=a["use-state"]?a["use-state"]:!1);return this};l.bo=function(){return this};l.Se=function(){return this};
l.Xn=function(a){if(null==a||"object"!==typeof a)return this;var b=a.text,c=a.coords;if(!b||!c)return this;var d=a.size||16;rb(this.l,c[0]-.5*sb(d,b),c[1],d,b,a.color||[255,255,255,255],a.depth,a["use-state"]||!1);return this};l.ie=function(a,b){return Ta(this.l,a,b)};l.wo=function(){return this.l.ja.slice()};l.pc=function(a){this.l.pc(a);return this};l.ec=function(a,b){this.l.ec(a,b);return this};l.Wc=function(a){return this.l.Wc(a,value_)};S.prototype.clear=S.prototype.clear;
S.prototype.createState=S.prototype.Fd;S.prototype.setState=S.prototype.vd;S.prototype.createTexture=S.prototype.createTexture;S.prototype.removeTexture=S.prototype.Aq;S.prototype.createMesh=S.prototype.Nn;S.prototype.removeMesh=S.prototype.yq;S.prototype.createshader=S.prototype.Kr;S.prototype.removeResource=S.prototype.zq;S.prototype.addJob=S.prototype.rn;S.prototype.clearJobs=S.prototype.Cn;S.prototype.drawMesh=S.prototype.fo;S.prototype.drawImage=S.prototype.drawImage;
S.prototype.drawBillboard=S.prototype.Ai;S.prototype.drawLineString=S.prototype.fe;S.prototype.drawJobs=S.prototype.bo;S.prototype.drawBBox=S.prototype.Se;S.prototype.drawDebugText=S.prototype.Xn;S.prototype.getCanvasCoords=S.prototype.ie;S.prototype.getCanvasSize=S.prototype.wo;S.prototype.setConfigParams=S.prototype.pc;S.prototype.setConfigParam=S.prototype.ec;S.prototype.getConfigParam=S.prototype.Wc;
function Ga(a,b,c,d,e,g){this.K=[];this.ea=[];this.K[0]=null!=a?a:Number.POSITIVE_INFINITY;this.K[1]=null!=b?b:Number.POSITIVE_INFINITY;this.K[2]=null!=c?c:Number.POSITIVE_INFINITY;this.ea[0]=null!=d?d:Number.NEGATIVE_INFINITY;this.ea[1]=null!=e?e:Number.NEGATIVE_INFINITY;this.ea[2]=null!=g?g:Number.NEGATIVE_INFINITY;wb(this)}Ga.prototype.clone=function(){return new Ga(this.K[0],this.K[1],this.K[2],this.ea[0],this.ea[1],this.ea[2])};function xb(a,b){return a.ea[b]-a.K[b]}
function wb(a){a.mg=Math.abs(Math.max(a.ea[0]-a.K[0],a.ea[1]-a.K[1],a.ea[2]-a.K[2]))}Ga.prototype.Sg=function(a){return null!=a?(a[0]=.5*(this.K[0]+this.ea[0]),a[1]=.5*(this.K[1]+this.ea[1]),a):[.5*(this.K[0]+this.ea[0]),.5*(this.K[1]+this.ea[1]),.5*(this.K[2]+this.ea[2])]};
function ib(a,b,c,d){this.sa=a;this.fa=[0,0,0];this.te=[0,0,0];this.Pe=1;this.Ji=b;this.ff=c;this.ge=d;this.bk=!1;this.ef=q.i.create();this.mf=q.i.create();this.Xd=q.i.create();this.vm=q.i.create();this.og=q.i.create();this.gm=q.i.create();this.zc=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];this.Fk=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.Am=[0,0,0,0];this.Ba=!0}l=ib.prototype;l.setPosition=function(a){this.fa=a;this.Ba=!0};
l.setOrientation=function(a){this.bk=!1;this.te=a;this.Ba=!0};l.clone=function(a){a=new ib(this.sa,null!=a?a:this.Nd(),this.ff,this.ge);a.setPosition(this.Od());a.setOrientation(this.Tb());a.Pe=this.Pe;a.Ba=!0;a.update();return a};l.Od=function(){return[this.fa[0],this.fa[1],this.fa[2]]};l.Tb=function(){return[this.te[0],this.te[1],this.te[2]]};l.Nd=function(){return this.Ji};function pb(a){a.Ba&&a.update();return a.ef}function ob(a){a.Ba&&a.update();return a.Xd}
function yb(a){a.Ba&&a.update();return a.og}function zb(a,b){a.Ba&&a.update();q.i.Za(a.ef,b,a.Am);var c=q.F.length(a.Am);return c<a.ff?[Number.POSITIVE_INFINITY,c]:[a.Xd[0]/c,c]}
l.Pc=function(a,b){this.Ba&&this.update();var c=a.K,d=a.ea,e=this.Fk;if(b)var g=c[0]-b[0],f=c[1]-b[1],c=c[2]-b[2],k=d[0]-b[0],h=d[1]-b[1],m=d[2]-b[2];else g=c[0],f=c[1],c=c[2],k=d[0],h=d[1],m=d[2];d=e[0];d[0]=g;d[1]=f;d[2]=c;d=e[1];d[0]=g;d[1]=f;d[2]=m;d=e[2];d[0]=g;d[1]=h;d[2]=c;d=e[3];d[0]=g;d[1]=h;d[2]=m;d=e[4];d[0]=k;d[1]=f;d[2]=c;d=e[5];d[0]=k;d[1]=f;d[2]=m;d=e[6];d[0]=k;d[1]=h;d[2]=c;d=e[7];d[0]=k;d[1]=h;d[2]=m;g=q.xf.Zk;f=this.zc;for(c=0;6>c;c++){k=!0;for(h=0;8>h;h++)if(0<=g(f[c],e[h])){k=
!1;break}if(k)return!1}return!0};
l.update=function(a){this.bk||(q.i.multiply(q.dc(2,q.Ka(-this.te[2])),q.dc(0,q.Ka(-this.te[1]-90)),this.mf),q.i.multiply(this.mf,q.dc(2,q.Ka(-this.te[0])),this.mf));q.i.multiply(this.mf,q.ed(-this.fa[0],-this.fa[1],-this.fa[2]),this.ef);this.Xd=1==this.Rp?q.Sp(this.kn,this.Pe,this.ff,this.ge):q.Up(this.Ji,this.Pe,this.ff,this.ge);q.i.set(this.Xd,this.vm);if(a){a=1+a;var b=this.Xd;b[2]*=a;b[6]*=a;b[10]*=a;b[15]*=a}q.i.multiply(this.Xd,this.ef,this.og);q.i.multiply(this.vm,this.ef,this.gm);this.zc[0]=
[0,0,1,1];this.zc[1]=[0,0,-1,1];this.zc[2]=[1,0,0,1];this.zc[3]=[-1,0,0,1];this.zc[4]=[0,1,0,1];this.zc[5]=[0,-1,0,1];a=q.i.create();q.i.zd(this.gm,a);for(b=0;6>b;b++)this.zc[b]=q.i.Sh(a,this.zc[b]);this.Ba=!1};
function nb(a,b,c){if(b){var d=q.i.create();q.i.multiply(q.vg(2,2,2),q.ed(-.5,-.5,-.5),d);var e=q.i.create(),g=a.N.Od();q.i.multiply(q.ed(g[0],g[1],g[2]-400),q.Dq(Math.min(.9*a.N.ge,6E5)),e);g=q.i.create();q.i.multiply(yb(a.N),e,g);q.i.multiply(g,d,g);a.j.useProgram(c,["aPosition","aTexCoord"]);a.j.bindTexture(b);ua(c,"uSampler",0);Qa(c,"uMVP",g);a.j.m.depthMask(!1);a.di.Ua(c,"aPosition","aTexCoord");a.j.m.depthMask(!0);a.j.m.enable(a.j.m.CULL_FACE)}}
hb.prototype.fe=function(a,b,c,d,e,g,f){var k=this.j.m,h=0,m=a.length;if(32<m)for(var n=0;n<m;n+=31)this.fe(a.slice(n,n+32),b,c,d,e,g,f);else{for(n=0;n<m;n++){var p=a[n];this.Xh[h]=p[0];this.Xh[h+1]=p[1];this.Xh[h+2]=p[2]||0;h+=3}1!=f&&(1!=d&&k.disable(k.DEPTH_TEST),1==e&&(k.blendEquationSeparate(k.FUNC_ADD,k.FUNC_ADD),k.blendFuncSeparate(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA,k.ONE,k.ONE_MINUS_SRC_ALPHA),k.enable(k.BLEND)),!1===g&&k.depthMask(!1),k.disable(k.CULL_FACE));this.j.useProgram(this.lf,["aPosition"]);
Qa(this.lf,"uMVP",this.$e);cb(this.lf,"uScale",[2/this.ja[0],2/this.ja[1],.5*b]);Pa(this.lf,"uColor",null!=c?c:[255,255,255,255]);cb(this.lf,"uPoints",this.Xh);this.Qj.Ua(this.lf,"aPosition",m);1!=f&&(1!=d&&k.enable(k.DEPTH_TEST),1==e&&k.disable(k.BLEND),!1===g&&k.depthMask(!1),k.enable(k.CULL_FACE))}};
hb.prototype.drawImage=function(a,b,c,d,e,g,f,k,h,m,n){if(null!=e&&null!=this.$e){var p=this.j.m;1!=n&&(1!=k&&p.disable(p.DEPTH_TEST),1==h&&(p.blendEquationSeparate(p.FUNC_ADD,p.FUNC_ADD),p.blendFuncSeparate(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA),p.enable(p.BLEND)),!1===m&&p.depthMask(!1),p.disable(p.CULL_FACE));this.j.useProgram(this.Ma,["aPosition"]);this.j.bindTexture(e);e=this.ze;p.bindBuffer(p.ARRAY_BUFFER,e);p.vertexAttribPointer(this.Ma.getAttribute("aPosition"),e.ia,
p.FLOAT,!1,0,0);e=this.ye;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,e);Qa(this.Ma,"uProjectionMatrix",this.$e);Qa(this.Ma,"uData",[a,b,0,0,a+c,b,1,0,a+c,b+d,1,1,a,b+d,0,1]);Pa(this.Ma,"uColor",null!=g?g:[255,255,255,255]);db(this.Ma,"uDepth",null!=f?f:0);p.drawElements(p.TRIANGLES,e.W,p.UNSIGNED_SHORT,0);1!=n&&(!1===m&&p.depthMask(!0),1!=k&&p.enable(p.DEPTH_TEST),1==h&&p.disable(p.BLEND),p.enable(p.CULL_FACE))}};
hb.prototype.Ai=function(a,b,c,d,e,g,f){var k=this.j.m;1!=f&&(1!=d&&k.disable(k.DEPTH_TEST),1==e&&(k.blendEquationSeparate(k.FUNC_ADD,k.FUNC_ADD),k.blendFuncSeparate(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA,k.ONE,k.ONE_MINUS_SRC_ALPHA),k.enable(k.BLEND)),!1===g&&k.depthMask(!1),k.disable(k.CULL_FACE));this.j.useProgram(this.Ma,["aPosition","aTexCoord"]);this.j.bindTexture(b);ua(this.Ma,"uSampler",0);b=this.ze;k.bindBuffer(k.ARRAY_BUFFER,b);k.vertexAttribPointer(this.Ma.getAttribute("aPosition"),b.ia,k.FLOAT,
!1,0,0);b=this.ye;k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,b);Qa(this.Ma,"uProjectionMatrix",a);Qa(this.Ma,"uData",[0,0,0,0,1,0,1,0,1,1,1,1,0,1,0,1]);Pa(this.Ma,"uColor",null!=c?c:[255,255,255,255]);db(this.Ma,"uDepth",0);k.drawElements(k.TRIANGLES,b.W,k.UNSIGNED_SHORT,0);1!=f&&(!1===g&&k.depthMask(!0),1!=d&&k.enable(k.DEPTH_TEST),1==e&&k.disable(k.BLEND),k.enable(k.CULL_FACE))};
function rb(a,b,c,d,e,g,f,k){if(null!=a.$e){var h=a.j.m;1!=k&&(h.disable(h.CULL_FACE),null==f?h.disable(h.DEPTH_TEST):(h.depthFunc(h.LEQUAL),h.enable(h.DEPTH_TEST)));a.j.useProgram(a.Ma,["aPosition"]);a.j.bindTexture(a.jk);var m=a.ze;h.bindBuffer(h.ARRAY_BUFFER,m);h.vertexAttribPointer(a.Ma.getAttribute("aPosition"),m.ia,h.FLOAT,!1,0,0);m=a.ye;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,m);Qa(a.Ma,"uProjectionMatrix",a.$e);Pa(a.Ma,"uColor",g);db(a.Ma,"uDepth",null!=f?f:0);g=d-1;var n=Math.round(.5*d),p=1/
256,t=sb(d,e)+2,u=0,w=(u&15)<<4,v=u>>4<<4;Qa(a.Ma,"uData",[b-2,c-2,w*p,.0078125*v,b-2+t,c-2,(w+15)*p,.0078125*v,b-2+t,c+d+1,(w+15)*p,.0078125*(v+15),b-2,c+d+1,w*p,.0078125*(v+15)]);h.drawElements(h.TRIANGLES,m.W,h.UNSIGNED_SHORT,0);for(var t=0,C=e.length;t<C;t++){u=e.charCodeAt(t)-32;w=(u&15)<<4;v=u>>4<<4;switch(u){case 12:case 14:case 27:case 28:case 64:case 73:case 76:case 84:Qa(a.Ma,"uData",[b,c,w*p,.0078125*v,b+n,c,(w+8)*p,.0078125*v,b+n,c+d,(w+8)*p,.0078125*(v+16),b,c+d,w*p,.0078125*(v+16)]);
b+=n;break;default:Qa(a.Ma,"uData",[b,c,w*p,.0078125*v,b+g,c,(w+15)*p,.0078125*v,b+g,c+d,(w+15)*p,.0078125*(v+16),b,c+d,w*p,.0078125*(v+16)]),b+=g}h.drawElements(h.TRIANGLES,m.W,h.UNSIGNED_SHORT,0)}1!=k&&(h.enable(h.CULL_FACE),null==f&&h.enable(h.DEPTH_TEST))}}function sb(a,b){for(var c=a-1,d=Math.round(.5*a),e=0,g=0,f=b.length;g<f;g++)switch(b.charCodeAt(g)-32){case 12:case 14:case 27:case 28:case 64:case 73:case 76:case 84:e+=d;break;default:e+=c}return e}
function Ab(a){var b=a.j,c=b.m;c.stencilMask(255);c.clear(c.STENCIL_BUFFER_BIT);c.stencilFunc(c.EQUAL,0,255);c.stencilOp(c.KEEP,c.KEEP,c.INCR);q.mi=a.j.Fd({Dd:!0,tf:!0,Sc:!1});q.Bk=a.j.Fd({Dd:!0,Sc:!1});var d=[1/a.ja[0],1/a.ja[1]],e=513,g=0;0<a.Ug.length&&(e=a.Ug[0],g++);for(var f=0,k=a.me.length;f<k;f++){var h=a.fg[f],m=a.me[f];0<h&&f>=e&&(c.clear(c.STENCIL_BUFFER_BIT),a.Ug.length>g?(e=a.Ug[g],g++):e=513);for(var n=0;n<h;n++)q.ao(b,c,a,m[n],d)}}
function Bb(a){for(var b=0,c=a.me.length;b<c;b++){for(var d=a.fg[b],e=a.me[b],g=0;g<d;g++)e[g]=null;a.fg[b]=0}}q.vb={};q.vb.pf=function(a,b,c,d,e){a[e]=b[0];a[e+1]=b[1];a[e+2]=b[2];a[e+3]=c[0];a[e+4]=c[1];a[e+5]=c[2];a[e+6]=d[0];a[e+7]=d[1];a[e+8]=d[2]};q.vb.nf=function(a,b,c,d,e){a[e]=b[0];a[e+1]=b[1];a[e+2]=c[0];a[e+3]=c[1];a[e+4]=d[0];a[e+5]=d[1]};
q.vb.yn=function(){var a=5;a--;for(var b=q.vb,c=a*a*2,d=new Float32Array(9*c),c=new Float32Array(6*c),e=1*a,g=0,f=0,k=0;k<a;k++)for(var h=0;h<a;h++){var m=h*e,n=(h+1)*e,p=k*e,t=(k+1)*e;b.pf(d,[m,p,0],[n,p,0],[n,t,0],g);b.nf(c,[m,p],[n,p],[n,t],f);g+=9;f+=6;b.pf(d,[n,t,0],[m,t,0],[m,p,0],g);b.nf(c,[n,t],[m,t],[m,p],f);g+=9;f+=6}return{v:new Ga(0,0,0,1,1,1),T:d,Fg:c}};
q.vb.zn=function(){var a=16;a--;for(var b=q.vb,c=a*a*2,d=new Float32Array(9*c),c=new Float32Array(6*c),e=1/a,g=0,f=0,k=0;k<a;k++)for(var h=0;h<a;h++){var m=h,n=h+1,p=k,t=k+1,u=h*e,w=(h+1)*e,v=k*e,C=(k+1)*e;b.pf(d,[m,p,0],[m,t,0],[n,t,0],g);b.nf(c,[u,v],[u,C],[w,C],f);g+=9;f+=6;b.pf(d,[n,t,0],[n,p,0],[m,p,0],g);b.nf(c,[w,C],[w,v],[u,v],f);g+=9;f+=6}return{v:new Ga(0,0,0,1,1,1),T:d,Fg:c}};
q.vb.ei=function(a,b){b*=Math.PI;a*=2*Math.PI;return[Math.cos(a)*Math.sin(b)*.5+.5,Math.sin(a)*Math.sin(b)*.5+.5,.5*Math.cos(b)+.5]};q.vb.Jk=function(a,b){for(var c=q.vb,d=a*b*2,e=new Float32Array(9*d),d=new Float32Array(6*d),g=0,f=0,k=0;k<a;k++)for(var h=0;h<b;h++)c.yp(h/b,k/a,(h+1)/b,(k+1)/a,e,g,d,f),g+=18,f+=12;return{v:new Ga(0,0,0,1,1,1),T:e,Fg:d}};
q.vb.yp=function(a,b,c,d,e,g,f,k){var h=q.vb,m=[a,b],n=h.ei(a,d),p=[a,d],t=h.ei(c,b),u=[c,b],w=h.ei(c,d);c=[c,d];h.pf(e,n,h.ei(a,b),t,g);h.nf(f,p,m,u,k);h.pf(e,t,w,n,g+9);h.nf(f,u,c,p,k+6)};q.Oe=null;
function Cb(a,b,c,d){this.h=d||{};this.pc(d);this.C=a;this.Bb=this.C.Ti();this.Mb=b;this.Mn=a.Mn;this.R=!1;this.fn=0;this.h=d||{};this.Ah=!1;this.Wp=new Float32Array(27);c=c.trim();this.Aa=q.qa.eh(c);this.Rb=q.qa.jh(c);this.fc=q.qa.gh(c);this.fa=new Db(this,["obj",0,0,"fix",0,0,0,0,0,0]);this.hj=this.fa.clone();this.De={};this.Cb={};this.G={};this.wi={};this.bb=[];this.Fb={};this.Tf={};this.Ra=[];this.Pa=[];this.fi=[];this.Eb=Array(500);this.Ll=null;this.If=new Eb(0,{});this.Tk="";this.pg=[];this.Uc=
this.yf=this.Hb=0;this.Wn=["base","hit"];this.Of=[];this.bh=!1;this.Nc={cg:{},kh:{},Lh:{}};this.Ud=!1;this.Ub=new Fb(this,1048576*this.h.Eh);this.oc=new Fb(this,1048576*this.h.Ch);this.Gc=new Fb(this,1048576*this.h.Ih);Gb(this);Hb(this);this.Xb=new Ib(this,this.h.Dh);this.l=this.C.l;this.N=this.l.N;this.sc=10;this.va=[0,0,0];this.Ed=[0,0,1];this.gj=this.Ff=this.ti=0;this.u=new Pb(this);this.ci=new Qb(this);this.w={N:null,Id:null,Zg:null,Vd:null,qk:null,pk:null,zg:!1,yg:!1,wf:!1,vf:!1,ek:this.h.Jh,
$n:!1,dl:!1,bl:!1,Di:!1,al:!1,Ei:!1,da:30,Mq:!1,Wl:0,Nq:0,Wl:0,Ec:[],mj:0,yh:0};var e;a=this.Mb.srses;this.De={};if(null==a)e=!1;else{for(e in a)b=new Rb(this,e,a[e]),this.De[e]=b;e=!0}e&&(e=this.Mb.referenceFrame,null==e?e=!1:(this.Cb=new Sb(this,e),e=0==this.Cb.Ad?!1:!0));if(e)if(e=this.Mb.credits,this.G={},null==e)e=!1;else{for(var g in e)Tb(this,g,new Ub(this,e[g]));e=!0}var f;if(g=e){g=this.Mb.stylesheets;this.fi=[];if(null!=g)for(f in g)e=new Vb(this,f,g[f]),this.fi[f]=e;g=!0}if(f=g)if(f=this.Mb.surfaces,
this.bb=[],null==f)f=!1;else{g=0;for(e=f.length;g<e;g++)a=new Wb(this,f[g]),this.bb.push(a),a.g=this.bb.length-1;f=!0}if(f){f=this.Mb.glue;this.Tf=[];if(null!=f)for(g=0,e=f.length;g<e;g++)a=new Wb(this,f[g],"glue"),this.Tf[a.f.join(";")]=a;f=!0}if(f){f=this.Mb.virtualSurfaces;this.Fb=[];if(this.h.Kh&&null!=f)for(g=0,e=f.length;g<e;g++)a=new Xb(this,f[g]),this.Fb[a.Om]=a;f=!0}var k;if(f){f=this.Mb.boundLayers;this.Pa=[];if(null!=f)for(var h in f)g=new Yb(this,f[h],h),this.Pa[h]=g;f=!0}if(h=f){h=this.Mb.freeLayers;
this.Ra=[];if(null!=h)for(k in h)f=new Wb(this,h[k],"free"),this.Ra[k]=f;h=!0}if(k=h){k=this.Mb.namedViews;this.pg=[];if(null!=k)for(var m in k)h=new Eb(0,k[m]),this.pg[m]=h;m=this.Mb.view;null!=m&&(this.Ll=JSON.parse(JSON.stringify(m)));k=!0}k&&(m=this.Mb.browserOptions,this.si={},null!=m&&(this.si=JSON.parse(JSON.stringify(m))));this.u.Vl=0;this.u.Ul=0;this.u.mj=performance.now();this.u.yh=this.mj;this.ml=!Zb($b(this));this.Sj=Array(6E4);this.Rj=Array(6E4);this.Bi=Array(6E4);this.sb=new ac(this);
null!=this.Mb.position&&this.setPosition(this.Mb.position,!1);this.qf(this.Ll);this.sd=.5*this.l.ja[0];this.jo=this.co=this.Fi=this.wc=this.Yo=!1;this.el=0;this.io=this.$k=this.ko=this.Vn=this.ho=this.lo=this.Yn=this.Zn=!1;this.Gi=0;this.Ci=this.h.sj;this.Rn=2;this.Me=this.Ue=0;this.Gk=this.Pg=1;this.cl=this.l.j.Fd({});this.Un=this.l.j.Fd({Bf:!0,Dd:!0});bc(this);this.nb=[];this.Mg("map",this.eo.bind(this),!0)}l=Cb.prototype;
l.D=function(){this.R=!0;this.sb.D();for(var a in this.Ra)this.Ra[a].sb.D();this.Ub.clear();this.oc.clear();this.Gc.clear();null!=this.l&&(this.l.D(),this.l=null)};function Gb(a){a.Ud=a.h.yj;!a.Ud&&a.h.xj&&(a.Ud=q.ta.Ml());Hb(a)}function Hb(a){var b=1/(a.Ud?Math.pow(2,Math.max(0,a.h.jg-1)):1),b=.5*(b+1/(a.Ud?Math.pow(2,a.h.jg):1)),c=a.oc;c.lg=1048576*a.h.Ch*b;cc(c);c=a.Ub;c.lg=1048576*a.h.Eh*b;cc(c);c=a.Gc;c.lg=1048576*a.h.Ih*(.8>b?.5:1);cc(c)}
function bc(a){var b=0;a.Ud&&(b=a.h.jg);a.Ag=a.h.Aj*Math.pow(2,b)}l.ih=function(){return this.C.gp.ih()};l.Vi=function(){return dc(this.De)};function Tb(a,b,c){a.G[b]=c;a.wi[c.f]=c;c.Ol=b}l.Pi=function(){return dc(this.G)};l.Qd=function(a){a:{for(var b=this.bb,c=0,d=b.length;c<d;c++)if(b[c].f==a){a=b[c];break a}a=null}return a};l.Wi=function(){for(var a=[],b=0,c=this.bb.length;b<c;b++)a.push(this.bb[b].f);return a};function kc(a,b){var c=a.Pa,d;for(d in c)if(c[d].Ip==b)return c[d];return null}
l.Oi=function(){return dc(this.Pa)};l.Ri=function(){var a=[],b;for(b in this.Ra)a.push(b);return a};function lc(a,b){return null==b?null:-1!=b.indexOf("+proj")?new Rb(a,{srsDef:b}):a.De[b]}
l.qf=function(a,b){if(null!=a){if("string"===typeof a){a=this.pg[a];if(!a)return;a=a.Ib()}var c=JSON.stringify(a);if(c!=this.Tk||b)this.If.parse(a),this.Tk=c,this.yf++;mc(this);nc(this);c=this.If.Ra;this.Of=[];for(var d in c){var e=this.Ra[d];e&&(e.Me=c[d].depthShift||0,this.Of.push(e),c[d].style?oc(e,c[d].style):oc(e,e.Lj))}pc(this)}};l.Xi=function(){return this.If.Ib()};function qc(a){a.yf++;mc(a);nc(a);pc(a)}function rc(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c].f==b)return c;return-1}
function dc(a){var b=[],c;for(c in a)b.push(c);return b}l.setPosition=function(a){this.fa=new Db(this,a);pc(this)};l.Fa=function(a,b,c){return this.Cb.Fa(a,b,c)};function $b(a){return a.Cb.Nb.Th}l.Od=function(){return this.fa.clone()};l.pc=function(a){if("object"===typeof a&&null!==a)for(var b in a)this.ec(b,a[b])};l.Ni=function(a,b){if(!Zb($b(this))){var c=sc(this).Ar(a[0],a[1],b[0],b[1]),c=c.Hr-c.Ir;isNaN(c)&&(c=0);return c}return 0};
l.rb=function(a,b){if(!a)return b;a=a.trim();return-1!=a.indexOf("://")?a:0==a.indexOf("//")?this.Rb+a:0==a.indexOf("/")?this.fc+a:this.Aa+a};
l.ec=function(a,b){switch(a){case "map":this.h.c=q.li(b,null);break;case "mapCache":this.h.Ch=q.Bd(b,10,900);Hb(this);break;case "mapGPUCache":this.h.Eh=q.Bd(b,10,360);Hb(this);break;case "mapMetatileCache":this.h.Ih=q.Bd(b,10,60);Hb(this);break;case "mapTexelSizeFit":this.h.Aj=q.Bd(b,1E-4,1.1);break;case "mapLowresBackground":this.h.Gh=q.Bd(b,0,0);break;case "mapDownloadThreads":this.h.Dh=q.Bd(b,1,6);break;case "mapMaxProcessingTime":this.h.Hh=q.Bd(b,1,50);break;case "mapMobileMode":this.h.yj=q.Oa(b,
!1);Gb(this);break;case "mapMobileModeAutodect":this.h.xj=q.Oa(b,!1);break;case "mapMobileDetailDegradation":this.h.jg=q.Bd(b,1,2);break;case "mapNavSamplesPerViewExtent":this.h.pd=q.Bd(b,1E-11,4);break;case "mapFog":this.h.sj=q.Oa(b,!1);break;case "mapIgnoreNavtiles":this.h.vj=q.Oa(b,!1);break;case "mapAllowHires":this.h.Xl=q.Oa(b,!0);break;case "mapAllowLowres":this.h.Yl=q.Oa(b,!0);break;case "mapAllowSmartSwitching":this.h.Zl=q.Oa(b,!0);break;case "mapDisableCulling":this.h.rj=q.Oa(b,!1);break;
case "mapPreciseCulling":this.h.zj=q.Oa(b,!1);break;case "mapHeightLodBlend":this.h.bf=q.Oa(b,!0);break;case "mapHeightNodeBlend":this.h.uj=q.Oa(b,!0);break;case "mapBasicTileSequence":this.h.$l=q.Oa(b,!0);break;case "mapSmartNodeParsing":this.h.am=q.Oa(b,!0);break;case "mapStoreLoadStats":this.h.Jh=q.Oa(b,!0);this.w.ek=this.h.Jh;break;case "mapXhrImageLoad":this.h.kg=q.Oa(b,!1);break;case "mapLoadMode":this.h.Fh=q.li(b,"topdown");break;case "mapGeodataLoadMode":this.h.tj=q.li(b,"fit");break;case "mapHeightfiledWhenUnloaded":this.h.ig=
q.Oa(b,!1);break;case "mapVirtualSurfaces":this.h.Kh=q.Oa(b,!0);break;case "mario":this.h.bm=q.Oa(b,!0)}};
l.Wc=function(a){switch(a){case "map":return this.h.c;case "mapCache":return this.h.Ch;case "mapGPUCache":return this.h.Eh;case "mapMetatileCache":return this.h.Ih;case "mapTexelSizeFit":return this.h.Aj;case "mapLowresBackground":return this.h.Gh;case "mapDownloadThreads":return this.h.Dh;case "mapMaxProcessingTime":return this.h.Hh;case "mapMobileMode":return this.h.yj;case "mapMobileModeAutodect":return this.h.xj;case "mapMobileDetailDegradation":return this.h.jg;case "mapNavSamplesPerViewExtent":return this.h.pd;
case "mapFog":return this.h.sj;case "mapIgnoreNavtiles":return this.h.vj;case "mapAllowHires":return this.h.Xl;case "mapAllowLowres":return this.h.Yl;case "mapAllowSmartSwitching":return this.h.Zl;case "mapDisableCulling":return this.h.rj;case "mapPreciseCulling":return this.h.zj;case "mapHeightLodBlend":return this.h.bf;case "mapHeightNodeBlend":return this.h.uj;case "mapBasicTileSequence":return this.h.$l;case "mapSmartNodeParsing":return this.h.am;case "mapStoreLoadStats":return this.h.Jh;case "mapXhrImageLoad":return this.h.kg;
case "mapLoadMode":return this.h.Fh;case "mapGeodataLoadMode":return this.h.tj;case "mapHeightfiledWhenUnloaded":return this.h.ig;case "mapVirtualSurfaces":return this.h.Kh;case "mario":return this.h.bm}};function pc(a){a.Ba=!0;a.$o=!0}l.Ve=function(a,b){return this.l.Ve(a,b)};
l.Si=function(a,b,c,d){this.$o&&(this.Uc=1,qb(this.l,"depth"),tc(this),qb(this.l,"base"),this.Uc=0);var e;e=this.l;var g=e.j.m,f=e.Ve(a,b),k=e.N.Od();if(g.checkFramebufferStatus(g.FRAMEBUFFER)!=g.FRAMEBUFFER_COMPLETE)e=[0,0,0,null,f,Number.MAX_VALUE,k];else{a=Math.floor(e.ag/e.ja[0]*a);g=e.le;b=e.ag-Math.floor(e.ag/e.ja[1]*b)-1;if(null!=g.L){g.j.bindTexture(g);wa(g.j,g);var h=g.m,m=new Uint8Array(4);h.readPixels(a,b,1,1,h.RGBA,h.UNSIGNED_BYTE,m);wa(g.j,null);g=m}else g=void 0;a=1/255*g[0]+g[1]+255*
g[2]+65025*g[3];g=!(255==g[0]&&255==g[1]&&255==g[2]&&255==g[3]);e.vh=[k[0]+f[0]*a,k[1]+f[1]*a,k[2]+f[2]*a];e=[e.vh[0],e.vh[1],e.vh[2],g,f,a,k]}var f=!1,k=this.va,n;a=e[4];if(Zb($b(this)))g=[0,0,Math.min(-1E3,this.Cb.Hd.mh[0])],b=[0,0,1],h=q.Math.vec3Dot(b,a),g=[g[0]-k[0],g[1]-k[1],g[2]-k[2]],g=q.Math.vec3Dot(g,b)/h,0<=g&&(!e[3]||g<e[5])&&(n=[a[0]*g+k[0],a[1]*g+k[1],a[2]*g+k[2]],f=!0);else if(h=$b(this).Pd().b+this.Cb.Hd.mh[0],m=[k[0],k[1],k[2]],g=q.Math.vec3Dot(a,a),b=2*q.Math.vec3Dot(a,m),h=q.Math.vec3Dot(m,
m)-h*h,h=b*b-4*g*h,0<h&&(h=Math.sqrt(h),m=(-b-h)/(2*g),g=(-b+h)/(2*g),g=m<g?m:g,!e[3]||g<e[5]))n=[a[0]*g+k[0],a[1]*g+k[1],a[2]*g+k[2]],f=!0;if(!e[3]&&!f)return null;f||(n=[e[0]+k[0],e[1]+k[1],e[2]+k[2]]);n=this.Fa(n,"physical","navigation");"float"==c&&(d=null!=d?d:uc(this,n,100,this.h.pd),c=this.Yc(n,d),n[2]-=c[0]);return n};
l.eo=function(){1!=this.Uc&&ta(this.l.j);this.Nc={cg:{},kh:{},Lh:{}};var a=Zb($b(this));if(!a)var b=this.fa.Rf(Zb($b(this)),!0);q.i.create();this.fa.check();var c=this.fa.o[4],d=uc(this,vc(this.fa),this.fa.o[8],this.h.pd),d=this.Yc(vc(this.fa),d,!0);this.u.Uo=d[0];this.u.To=c;"float"==this.fa.o[3]&&(c+=d[0]);d=this.fa.Rf(Zb($b(this)));this.N.setPosition(d.bc);var e=this.N,g=d.ak;e.bk=!0;e.mf=g.slice();e.Ba=!0;this.Ed=d.Gg;this.va=d.bc;this.ti=d.Qp+c;this.Ff=c;this.sc=wc(this.fa);this.sc=Math.max(this.Ff,
wc(this.fa));this.sc=q.de(this.sc,.1,this.N.ge);this.l.sc=this.sc;e=this.N;e.kn=this.fa.o[8];e.Ba=!0;c=this.Fa([vc(this.fa)[0],vc(this.fa)[1],c],"navigation","physical");c[0]+=d.bc[0];c[1]+=d.bc[1];c[2]+=d.bc[2];this.N.setPosition([0,0,0]);this.va=c;c=Math.max(this.ti,this.sc)/6E5;d=Math.max(2,40*c);c=Math.max(1,c);e=this.N;e.Ji=.5*this.fa.Nd();e.ff=d;e.ge=6E6*c;e.Ba=!0;this.l.Ba=!0;this.l.Ci=this.Ci;this.l.va=this.va;this.l.Rg=this.fa.Tb();this.l.Mk=Math.cos(q.Ka(this.l.Rg[1]));this.l.Ed=this.Ed;
a?(a=q.Ka(this.l.Rg[0]),this.l.fj=[-Math.sin(a),Math.cos(a),0,0,0]):(a=b.Gg,this.l.fj=[a[0],a[1],a[2],0],this.An=q.F.length(this.va),a=[0,0,0],q.F.normalize(this.va,a),this.Bn=a);this.l.Yk=1/Math.max(1,Math.log(this.sc)/Math.log(1.04));this.l.Xm=Math.abs(this.l.Rg[1]/-90);1!=this.Uc?this.l.j.clear(!0,!1):this.l.j.clear(!0,!0,[255,255,255,255]);this.l.j.vd(this.cl);1!=this.Uc&&.8>this.h.Gh&&(2==this.el?nb(this.l,this.l.Le,this.l.rm):nb(this.l,this.l.Qg,this.l.rm));bc(this);this.Me=this.Xb.Tg=0;this.Ua()};
l.update=function(){if(1!=this.R&&(this.C.hi&&Date.now()>this.C.hi-6E4&&this.C.bn(),null==this.Gd||"hidden"!=this.Gd.style.visibility)){var a=this.fa,b=this.hj,b=b.o;a.o[0]==b[0]&&q.isEqual(a.o[1],b[1],1E-7)&&q.isEqual(a.o[2],b[2],1E-7)&&a.o[3]==b[3]&&q.isEqual(a.o[4],b[4],.001)&&q.isEqual(a.o[5],b[5],.001)&&q.isEqual(a.o[6],b[6],.001)&&q.isEqual(a.o[7],b[7],.001)&&q.isEqual(a.o[8],b[8],.001)&&q.isEqual(a.o[9],b[9],.001)||this.C.Qc("map-position-changed",{position:this.fa.o.slice(),"last-position":this.hj.o.slice()});
this.gj!=this.Ff&&this.C.Qc("map-position-fixed-height-changed",{height:this.Ff,"last-height":this.gj});this.hj=this.fa.clone();this.gj=this.Ff;a=this.l.Gd.getBoundingClientRect();if(this.l.ja[0]!=a.width||this.l.ja[1]!=a.height)this.l.Vh(),this.Ba=!0;a=this.Ba;b=this.u;if(a){b.Id=0;b.Yg=0;b.Te=0;b.wb=0;b.ji=0;b.$h=0;for(var c=b.Zh=0,d=b.bi.length;c<d;c++)b.bi[c]=0}b.tc++;b.Nm++;b.xm=performance.now();this.Ah||this.Xb.update();this.Ba&&(this.Ba=!1,this.Gk=this.Pg=0,tc(this),this.Ah||this.Xb.update(),
this.C.Qc("map-update",{}));this.u.end(a)}};
q.pn=function(){function a(a,b,c){if(Ba>=Ua){var d=Ia;Ua+=65536;Ia=Array(Ua);for(var e=0,f=Ba;e<f;e++)Ia[e]=d[e]}Ia[Ba]={ne:a,Ng:b,wg:c};Ba++}function b(){for(var a=0,b=Ia,c=0,d=Ba;c<d;c++){var e=b[c],f=e.ne,g=f.type,k=e.wg;if(e.hitable||e.Yd||"icon"==g||"label"==g)e.Yd||(postMessage(e.ne,e.Ng),a++);else{switch(g){case "flat-line":for(var h=f.vertexBuffer.length,m=c+1;m<d;m++){var n=b[m];n.wg==k&&(n.Yd=!0,h+=n.ne.vertexBuffer.length)}for(var p=new Float32Array(h),h=0,m=c;m<d;m++){var n=b[m],r=n.ne;
if(n.wg==k){n=r.vertexBuffer;r.vertexBuffer=null;for(var r=0,t=n.length;r<t;r++)p[h+r]=n[r];h+=t}}f.vertexBuffer=p;e.Ng=[p.buffer];break;case "pixel-line":case "line-label":h=f.vertexBuffer.length;for(m=c+1;m<d;m++)n=b[m],n.wg==k&&(n.Yd=!0,h+=n.ne.vertexBuffer.length);for(var p=new Float32Array(h),u=new Float32Array(h),h=0,m=c;m<d;m++)if(n=b[m],r=n.ne,n.wg==k){n=r.vertexBuffer;r.vertexBuffer=null;if("line-label"==g){var x=r.texcoordsBuffer;r.texcoordsBuffer=null}else x=r.normalBuffer,r.normalBuffer=
null;r=0;for(t=n.length;r<t;r++)p[h+r]=n[r],u[h+r]=x[r];h+=t}f.vertexBuffer=p;"line-label"==g?f.texcoordsBuffer=u:f.normalBuffer=u;e.Ng=[p.buffer,u.buffer]}a++;postMessage(e.ne,e.Ng)}}Ba=0}function c(a,b,c,e,f,g){for(var k in Z){var h=Z[k],m=x(h,"filter",b,c);b.tg=b.properties||{};if(!m||r(m,b,f,g)){var m=a,n=b,O=c,P=e,R=x(h,"visible",n,O),p=x(h,"z-index",n,O);if(0!=R){var t=n.tg,R=x(h,"hover-style",n,O),R=""!=R?G(R,m,P):null;null!=R?(Ja=1,d(m,n,O,h,p,t),Ja=2,d(m,n,O,R,p,t)):(Ja=0,d(m,n,O,h,p,t));
var ya=x(h,"next-pass",n,O);if(null!=ya)for(var u=0,v=ya.length;u<v;u++)p=ya[u][0],h=G(ya[u][1],m,P),R=x(h,"visible",n,O),0!=R&&(R=x(h,"hover-style",n,O),R=""!=R?G(R,m,P):null,null!=R?(Ja=1,d(m,n,O,h,p,t),Ja=2,d(m,n,O,R,p,t)):(Ja=0,d(m,n,O,h,p,t)))}}}}function d(b,c,d,e,f,g){switch(b){case "line-string":(x(e,"point",c,d)||x(e,"label",c,d))&&p(c,d,e,f,g);t(c,d,e,f,g);break;case "point-array":p(c,d,e,f,g);break;case "polygon":var k=style_,h=c.vertices||[];if(0!=h.length&&((x(k,"point",c,d)||x(k,"label",
c,d))&&m(c,h,d,k,f,g,!1),(x(k,"line",c,d)||x(k,"line-label",c,d))&&m(c,h,d,k,f,g,!0),0!=x(k,"polygon",c,d))){var n=c.surface||[];if(0!=n.length){b=x(k,"hover-event",c,d);e=x(k,"click-event",c,d);var R=x(k,"draw-event",c,d),O=x(k,"enter-event",c,d),P=x(k,"leave-event",c,d),r=x(k,"zbuffer-offset",c,d);c=x(k,"polygon-color",c,d);d=[0,0,0];for(var ya=n.length/3*3,k=Array(3*ya),u=0,v=0,w,$a=0;$a<ya;$a++)w=3*n[u++],w=[h[w++],h[w++],h[w]],null!=forceScale_&&(w=[w[0]*forceScale_[0],w[1]*forceScale_[1],w[2]*
forceScale_[2]]),d[0]+=w[0],d[1]+=w[1],d[2]+=w[2],k[v++]=w[0],k[v++]=w[1],k[v++]=w[2];0<ya&&(h=1/ya,d[0]*=h,d[1]*=h,d[2]*=h);d[0]+=ab[0];d[1]+=ab[1];d[2]+=ab[2];a({command:"addRenderJob",type:"flat-line",vertexBuffer:k,color:c,"z-index":f,center:d,"hover-event":b,"click-event":e,"draw-event":R,hitable:b||e||O||P,state:Ja,eventInfo:g,"enter-event":O,"leave-event":P,"zbuffer-offset":r,lod:Ha})}}}}function e(a,b){if(!a||""==a)return!1;for(var c=b.jd,d=0,e=a.length;d<e;d++){var f=a.charCodeAt(d);if(10!=
f&&9!=f&&!c[f])return!1}return!0}function g(a,b){for(var c=0,d=[0,0,0],e=[1,0,0],f=0,g=a.length-1;f<g;f++){var d=a[f],e=a[f+1],e=[e[0]-d[0],e[1]-d[1],e[2]-d[2]],k=vec3Length(e);if(c+k>b){c=(b-c)/k;d=[d[0]+e[0]*c,d[1]+e[1]*c,d[2]+e[2]*c];vec3Normalize(e);break}c+=k}return[d,e]}function f(a,b,c){var d=0;c=c.jd;for(var e=0,f=a.length;e<f;e++){var g=a.charCodeAt(e);10!=g&&(9==g&&(g=32),g=c[g],null!=g&&(d+=g.Ee*b))}return d}function k(a,b,c,d,e,k,m,n){var R=c/d.s,O=f(b,R,d),P,p=0;P=0;for(var r=a.length-
1;P<r;P++)var t=a[P],ya=a[P+1],p=p+vec3Length([ya[0]-t[0],ya[1]-t[1],ya[2]-t[2]]);P=p;p=.5*(P-O);0>p&&(p=0);if(!(O>P)){a:{P=p;for(var r=0,u,O=[0,0,0],R=P+f(b,R,d),t=0,ya=a.length-1;t<ya;t++){u=a[t];var v=a[t+1];u=[v[0]-u[0],v[1]-u[1],v[2]-u[2]];r+=vec3Length(u);r>P&&(vec3Normalize(u),O[0]+=u[0],O[1]+=u[1],O[2]+=u[2]);if(r>R){vec3Normalize(O);if(Ea){R=[0,0,0];vec3Normalize(ja,R);U(R,O,R);break a}R=[-O[1],O[0],0];break a}}R=O}null==R&&(R=[0,1,0]);r=a[0];O=d.jd;c/=d.s;P=d.rf*c;r=[r[0],r[1],r[2]];t=0;
for(ya=b.length;t<ya;t++)if(u=b.charCodeAt(t),10==u)r[0]+=-w[1]*P,r[1]+=w[0]*P;else{9==u&&(u=32);w=O[u];v=1;null!=w&&(v=w.Ee*c);var x=g(a,p),w=g(a,p+v),w=[.5*(w[1][0]+x[1][0]),.5*(w[1][1]+x[1][1]),.5*(w[1][2]+x[1][2])];vec3Normalize(w);n=h(x[0],w,-c*d.s*.7+e,u,c,n,n,R,d,k,m)[1];p+=v}return n}}function h(a,b,c,d,e,f,g,k,h,m,n,p){if(Ea&&!p){p=[0,0,0];var P=[0,0,0];vec3Normalize(ja,P);U(P,b,p)}else p=[-b[1],b[0],0];a=[a[0],a[1],a[2]];var P=[a[0],a[1],a[2]],O=h.jd;h=O[d];var R=0,r=k[0],t=k[1];k=k[2];
9==d||32==d?(h=O[32],null!=h&&(a[0]+=b[0]*h.Ee*e,a[1]+=b[1]*h.Ee*e,R=h.pj*e)):null!=h&&(d=h.pj*e,O=h.up*e,c=[p[0]*c,p[1]*c,p[2]*c],p=[c[0]+p[0]*O,c[1]+p[1]*O,c[2]+p[2]*O],P[0]=a[0]+b[0]*d,P[1]=a[1]+b[1]*d,P[2]=a[2]+b[2]*d,m[f]=a[0]-c[0],m[f+1]=a[1]-c[1],m[f+2]=a[2]-c[2],m[f+3]=k,n[g]=h.rk,n[g+1]=h.vk,n[g+2]=r,n[g+3]=t,m[f+4]=a[0]-p[0],m[f+5]=a[1]-p[1],m[f+6]=a[2]-p[2],m[f+7]=k,n[g+4]=h.rk,n[g+5]=h.wk,n[g+6]=r,n[g+7]=t,m[f+8]=P[0]-c[0],m[f+9]=P[1]-c[1],m[f+10]=P[2]-c[2],m[f+11]=k,n[g+8]=h.sk,n[g+9]=
h.vk,n[g+10]=r,n[g+11]=t,m[f+12]=a[0]-p[0],m[f+13]=a[1]-p[1],m[f+14]=a[2]-p[2],m[f+15]=k,n[g+12]=h.rk,n[g+13]=h.wk,n[g+14]=r,n[g+15]=t,m[f+16]=P[0]-p[0],m[f+17]=P[1]-p[1],m[f+18]=P[2]-p[2],m[f+19]=k,n[g+16]=h.sk,n[g+17]=h.wk,n[g+18]=r,n[g+19]=t,m[f+20]=P[0]-c[0],m[f+21]=P[1]-c[1],m[f+22]=P[2]-c[2],m[f+23]=k,n[g+20]=h.sk,n[g+21]=h.vk,n[g+22]=r,n[g+23]=t,f+=24,g+=24,a[0]+=b[0]*h.Ee*e,a[1]+=b[1]*h.Ee*e,R=h.pj*e);return[a,f,g,R]}function m(a,b,c,d,e,f,g){var k=a.borders||[];if(0!=k.length){var h={},m;
for(m in a)"surface"!=m&&"vertices"!=m&&"borders"!=m&&(h[m]=a[m]);a=k.length;for(m=0;m<a;m++){var n=k[m],P=n.length;if(0<P){var O;O=g?Array(P+1):Array(P);for(var R=0;R<P;R++){var r=3*n[R];O[R]=[b[r++],b[r++],b[r]];g&&0==R&&(O[P]=O[0])}h.points=O;g?t(h,c,d,e,f):p(h,c,d,e,f)}}}}function n(a,b,c){switch(a){case "top-left":return[0,0];case "top-right":return[-b,0];case "top-center":return[.5*-b,0];case "center-left":return[0,.5*-c];case "center-right":return[-b,.5*-c];case "center-center":return[.5*-b,
.5*-c];case "bottom-left":return[0,-c];case "bottom-right":return[-b,-c];case "bottom-center":return[.5*-b,-c]}}function p(b,c,d,g,k){var m=[];b.lines?m=b.lines||[]:b.points&&(m=[b.points]);if(0!=m.length){var p=x(d,"visibility",b,c),r=x(d,"culling",b,c),P=x(d,"hover-event",b,c),O=x(d,"click-event",b,c),t=x(d,"draw-event",b,c),R=x(d,"enter-event",b,c),u=x(d,"leave-event",b,c),v=x(d,"zbuffer-offset",b,c),w=x(d,"point",b,c),y=x(d,"point-flat",b,c),$a=x(d,"point-color",b,c),C=.5*x(d,"point-radius",b,
c),Za=x(d,"icon",b,c);if(1==Za){var G=x(d,"icon-source",b,c);if(G)var N=24*m.length,U=18*m.length,B={Rc:x(d,"icon-color",b,c),Bm:x(d,"icon-scale",b,c),sg:x(d,"icon-offset",b,c),uf:x(d,"icon-stick",b,c),ve:x(d,"icon-origin",b,c),Jm:x(d,"icon-source",b,c),ha:new Float32Array(N),ue:new Float32Array(U),Ie:new Float32Array(N),g:0,dg:0};else Za=!1}var J=x(d,"label",b,c);if(1==J){var G=x(d,"label-source",b,c),K=D(d,G,b),aa=x(d,"label-size",b,c);if("$name"==G&&!e(K,Ka["default"])){var Z=D(d,"$name:en",b);
e(Z,Ka["default"])&&(K=Z)}if(K&&""!=K&&1E-4<Math.abs(aa))var N=24*K.length*m.length,U=18*K.length*m.length,Va={Rc:x(d,"label-color",b,c),s:aa,sg:x(d,"label-offset",b,c),uf:x(d,"label-stick",b,c),ve:x(d,"label-origin",b,c),sn:x(d,"label-align",b,c),Yq:K,Cd:x(d,"label-width",b,c),ha:new Float32Array(N),ue:new Float32Array(U),Ie:new Float32Array(N),g:0,dg:0};else J=!1}var T=0,La=0,X=[],fb,Ca=4*C;8>Ca&&(Ca=8);32<Ca&&(Ca=32);fb=Ca;for(var ha=0,A=2*Math.PI/fb,F=0;F<fb;F++)X[F]=[-Math.sin(ha),Math.cos(ha)],
ha+=A;X[fb]=[0,1];for(var ka=0,fa=[0,0,0],Ea=0,ab=m.length;Ea<ab;Ea++){var ca=m[Ea];if(Array.isArray(ca)&&0<ca.length){var E=ca[0],V=[E[0],E[1],E[2]],ka=ka+ca.length;if(0==y)var sa=12*fb,W=Array(ca.length*sa),pa=Array(12*ca.length*fb);else sa=9*fb,W=Array(ca.length*sa);for(var F=0,ma=ca.length;F<ma;F++){null!=forceScale_&&(V=[V[0]*forceScale_[0],V[1]*forceScale_[1],V[2]*forceScale_[2]]);fa[0]+=V[0];fa[1]+=V[1];fa[2]+=V[2];if(1==Za){var na=V,qa=B,L=qa.Jm,H=qa.g,Ba=qa.dg,Ia=H,ec=Math.abs(L[3]*qa.Bm),
fc=Math.abs(L[4]*qa.Bm),ia=qa.ha,ra=qa.Ie,Ua=qa.ue;ia[H]=0;ia[H+1]=0;ia[H+2]=0;ia[H+3]=0;ia[H+4]=ec;ia[H+5]=0;ia[H+6]=0;ia[H+7]=0;ia[H+8]=ec;ia[H+9]=-fc;ia[H+10]=0;ia[H+11]=0;ra[H]=L[1];ra[H+1]=L[2];ra[H+2]=0;ra[H+3]=0;ra[H+4]=L[1]+L[3];ra[H+5]=L[2];ra[H+6]=0;ra[H+7]=0;ra[H+8]=L[1]+L[3];ra[H+9]=L[2]+L[4];ra[H+10]=0;ra[H+11]=0;H+=12;ia[H]=0;ia[H+1]=0;ia[H+2]=0;ia[H+3]=0;ia[H+4]=0;ia[H+5]=-fc;ia[H+6]=0;ia[H+7]=0;ia[H+8]=ec;ia[H+9]=-fc;ia[H+10]=0;ia[H+11]=0;ra[H]=L[1];ra[H+1]=L[2];ra[H+2]=0;ra[H+3]=
0;ra[H+4]=L[1];ra[H+5]=L[2]+L[4];ra[H+6]=0;ra[H+7]=0;ra[H+8]=L[1]+L[3];ra[H+9]=L[2]+L[4];ra[H+10]=0;ra[H+11]=0;for(var H=H+12,Cd=n(qa.ve,ec,fc),se=Cd[0]+qa.sg[0],te=Cd[1]+qa.sg[1],ue=na[0],ve=na[1],we=na[2],tb=Ia;tb<H;tb+=4)ia[tb]+=se,ia[tb+1]-=te,Ua[Ba]=ue,Ua[Ba+1]=ve,Ua[Ba+2]=we,Ba+=3;qa.g=H;qa.dg=Ba}if(1==J){for(var Mc=V,za=Va,Jb=za.ha,xe=za.Ie,Nc=za.ue,Kb=za.g,Lb=za.dg,ye=Kb,Dd=(""+za.Yq).match(/[^\r\n]+/g),ub=[],va=0,Mb=Dd.length;va<Mb;va++){var kb=Dd[va];do{var Nb;a:{for(var Ed=0,ze=Ka["default"].jd,
gc=0,Fd=kb.length;gc<Fd;gc++){var lb=kb.charCodeAt(gc);if(Ed>za.Cd&&(10==lb||9==lb||32==lb)){Nb=gc;break a}if(10!=lb){9==lb&&(lb=32);var Gd=ze[lb];null!=Gd&&(Ed+=za.s/Ka["default"].s*Gd.Ee)}}Nb=Fd}if(kb.length==Nb){ub.push(kb);break}ub.push(kb.substring(0,Nb));kb=kb.substring(Nb+1)}while(1)}var hc=0,Oc=0,Hd,Id=Ka["default"];Hd=za.s/Id.s*Id.rf;for(var Ob=0,Pc=[],va=0,Mb=ub.length;va<Mb;va++)Pc[va]=f(ub[va],za.s/Ka["default"].s,Ka["default"]),Ob=Math.max(Pc[va],Ob);va=0;for(Mb=ub.length;va<Mb;va++){var Jd=
Pc[va];switch(za.sn){case "left":hc=0;break;case "right":hc=Ob-Jd;break;case "center":hc=.5*(Ob-Jd)}for(var vb=[hc,Oc,0],Kd=ub[va],Qc=Ka["default"],Ae=Jb,Be=xe,ic=Kb,Rc=[1,0,0],Ce=[0,1,0],Ld=za.s/Qc.s,Md=Qc.rf*Ld,mb=[vb[0],vb[1],vb[2]],Sc=[vb[0],vb[1],vb[2]],Tc=0,De=Kd.length;Tc<De;Tc++){var Nd=Kd.charCodeAt(Tc);if(10==Nd)mb[0]+=-Rc[1]*Md,mb[1]+=Rc[0]*Md,Sc=[mb[0],mb[1],mb[2]];else var Od=h(Sc,Rc,0,Nd,Ld,ic,ic,Ce,Qc,Ae,Be,!0),Sc=Od[0],ic=Od[1]}Kb=ic;Oc-=Hd}var Pd=n(za.ve,Ob,-Oc);offsetX_=Pd[0]+za.sg[0];
offsetY_=Pd[1]+za.sg[1];for(var Ee=Mc[0],Fe=Mc[1],Ge=Mc[2],va=ye;va<Kb;va+=4)Jb[va]+=offsetX_,Jb[va+1]-=offsetY_,Nc[Lb]=Ee,Nc[Lb+1]=Fe,Nc[Lb+2]=Ge,Lb+=3;za.g=Kb;za.dg=Lb}for(var Wa=0;Wa<fb;Wa++)1==w&&(1==y?(W[T]=V[0],W[T+1]=V[1],W[T+2]=V[2],W[T+3]=V[0]+X[Wa][0]*C,W[T+4]=V[1]+X[Wa][1]*C,W[T+5]=V[2],W[T+6]=V[0]+X[Wa+1][0]*C,W[T+7]=V[1]+X[Wa+1][1]*C,W[T+8]=V[2],T+=9):(W[T]=V[0],W[T+1]=V[1],W[T+2]=V[2],W[T+3]=0,pa[La]=0,pa[La+1]=0,pa[La+2]=0,pa[La+3]=0,W[T+4]=V[0],W[T+5]=V[1],W[T+6]=V[2],W[T+7]=0,pa[La+
4]=X[Wa][0]*C,pa[La+5]=X[Wa][1]*C,pa[La+6]=0,pa[La+7]=0,W[T+8]=V[0],W[T+9]=V[1],W[T+10]=V[2],W[T+11]=0,pa[La+8]=X[Wa+1][0]*C,pa[La+9]=X[Wa+1][1]*C,pa[La+10]=0,pa[La+11]=0,T+=12,La+=12));V=ca[F+1]}}}0<ka&&(fa[0]/=ka,fa[1]/=ka,fa[2]/=ka);fa[0]+=ja[0];fa[1]+=ja[1];fa[2]+=ja[2];var jc=P||O||R||u;1==w&&(1==y?a({command:"addRenderJob",type:"flat-line",vertexBuffer:W,color:$a,"z-index":g,visibility:p,center:fa,"hover-event":P,"click-event":O,"draw-event":t,"enter-event":R,"leave-event":u,"zbuffer-offset":v,
hitable:jc,state:Ja,eventInfo:k,lod:Ha},[W.buffer]):a({command:"addRenderJob",type:"pixel-line",vertexBuffer:W,normalBuffer:pa,color:$a,"z-index":g,visibility:p,center:fa,"hover-event":P,"click-event":O,"draw-event":t,"enter-event":R,"leave-event":u,"zbuffer-offset":v,hitable:jc,state:Ja,eventInfo:k,lod:Ha},[W.buffer,pa.buffer]));1==Za&&0<B.ha.length&&a({command:"addRenderJob",type:"icon",vertexBuffer:B.ha,originBuffer:B.ue,texcoordsBuffer:B.Ie,icon:I[B.Jm[0]],color:B.Rc,"z-index":g,visibility:p,
culling:r,center:fa,stick:B.uf,"hover-event":P,"click-event":O,"draw-event":t,"enter-event":R,"leave-event":u,"zbuffer-offset":v,hitable:jc,state:Ja,eventInfo:k,lod:Ha},[B.ha.buffer,B.ue.buffer,B.Ie.buffer]);1==J&&0<Va.ha.length&&a({command:"addRenderJob",type:"label",vertexBuffer:Va.ha,originBuffer:Va.ue,texcoordsBuffer:Va.Ie,color:Va.Rc,"z-index":g,visibility:p,culling:r,center:fa,stick:Va.uf,"hover-event":P,"click-event":O,"draw-event":t,"enter-event":R,"leave-event":u,"zbuffer-offset":v,hitable:jc,
state:Ja,eventInfo:k,lod:Ha},[Va.ha.buffer,Va.ue.buffer,Va.Ie.buffer])}}function t(b,c,d,f,g){var h,m=b.lines||[];if(0!=m.length){var n=x(d,"line",b,c),p=x(d,"line-label",b,c);if(n||p){var r=x(d,"hover-event",b,c),P=x(d,"click-event",b,c),t=x(d,"draw-event",b,c),O=x(d,"enter-event",b,c),R=x(d,"leave-event",b,c),u=x(d,"zbuffer-offset",b,c),v=x(d,"line-flat",b,c),w=x(d,"line-color",b,c),y=.5*x(d,"line-width",b,c),$a=x(d,"line-style",b,c),C=x(d,"line-style-texture",b,c),Za=x(d,"line-style-background",
b,c),p=x(d,"line-label",b,c),G=x(d,"line-label-size",b,c),B=0,J=0,N=!v&&2.1>y;if(!N){for(var K=[],aa=[],Z=8,T=0,ka=2*Math.PI/Z,X=0;X<Z;X++)K[X]=[-Math.sin(T),Math.cos(T)],aa[X]=T,T+=ka;K[Z]=[0,1];aa[Z]=0}for(var ha=0,Ca=0;Ca<m.length;Ca++)Array.isArray(m[Ca])&&(ha+=m[Ca].length);var Ba=6*(V||!v?4:3),A=new Float32Array(ha*Ba+ha*(N?0:Z*(V||!v?4:3)*3));if(!v||V)var F=new Float32Array(24*ha+ha*(N?0:12*Z));if(V&&!N)var Ia=Float32Array(ha);T=[0,0,0];ka=[];for(Ca=0;Ca<m.length;Ca++)if(Array.isArray(m[Ca])&&
m[Ca].length){var fa=m[Ca];if(p){var Ua=Array(fa.length),Bd=Array(fa.length);ka.push({bq:Ua,aq:Bd})}for(var ca=fa[0],E,V="solid"!=$a,sa=.001,W=.001,X=0,pa=fa.length-1;X<pa;X++){E=fa[X];h=fa[X+1];null!=forceScale_&&(E=[E[0]*forceScale_[0],E[1]*forceScale_[1],E[2]*forceScale_[2]],h=[h[0]*forceScale_[0],h[1]*forceScale_[1],h[2]*forceScale_[2]]);if(v&&!V){if(Ea){var ma=[h[0]-E[0],h[1]-E[1],h[2]-E[2]],na=Math.sqrt(ma[0]*ma[0]+ma[1]*ma[1]+ma[2]*ma[2]),W=W+na,na=0!=na?1/na:0,qa=[ma[0]*na,ma[1]*na,ma[2]*
na],L=[0,0,0],H=[0,0,0];vec3Normalize(ja,H);U(H,qa,L);L=[L[0]*y,L[1]*y,L[2]*y]}else ma=[h[0]-E[0],h[1]-E[1],0],na=Math.sqrt(ma[0]*ma[0]+ma[1]*ma[1]),W+=na,na=0!=na?y/na:0,L=[-ma[1]*na,ma[0]*na,0];A[B]=E[0]+L[0];A[B+1]=E[1]+L[1];A[B+2]=E[2]+L[2];A[B+3]=E[0]-L[0];A[B+4]=E[1]-L[1];A[B+5]=E[2]-L[2];A[B+6]=h[0]+L[0];A[B+7]=h[1]+L[1];A[B+8]=h[2]+L[2];A[B+9]=E[0]-L[0];A[B+10]=E[1]-L[1];A[B+11]=E[2]-L[2];A[B+12]=h[0]-L[0];A[B+13]=h[1]-L[1];A[B+14]=h[2]-L[2];A[B+15]=h[0]+L[0];A[B+16]=h[1]+L[1];A[B+17]=h[2]+
L[2];B+=18}else ma=[h[0]-E[0],h[1]-E[1],0],na=Math.sqrt(ma[0]*ma[0]+ma[1]*ma[1]),W+=na,v?(na=0!=na?y/na:0,L=[-ma[1]*na,ma[0]*na,0],null!=Ia&&(Ia[X]=0!=na?Math.atan2(ma[0],ma[1])+.5*Math.PI:0),A[B]=E[0],A[B+1]=E[1],A[B+2]=E[2],A[B+3]=sa,F[J]=L[0],F[J+1]=L[1],F[J+2]=0,F[J+3]=y,A[B+4]=E[0],A[B+5]=E[1],A[B+6]=E[2],A[B+7]=-sa,F[J+4]=-L[0],F[J+5]=-L[1],F[J+6]=0,F[J+7]=-y,A[B+8]=h[0],A[B+9]=h[1],A[B+10]=h[2],A[B+11]=W,F[J+8]=L[0],F[J+9]=L[1],F[J+10]=0,F[J+11]=y,A[B+12]=E[0],A[B+13]=E[1],A[B+14]=E[2],A[B+
15]=-sa,F[J+12]=-L[0],F[J+13]=-L[1],F[J+14]=0,F[J+15]=-y,A[B+16]=h[0],A[B+17]=h[1],A[B+18]=h[2],A[B+19]=-W,F[J+16]=-L[0],F[J+17]=-L[1],F[J+18]=0,F[J+19]=-y,A[B+20]=h[0],A[B+21]=h[1],A[B+22]=h[2],A[B+23]=W,F[J+20]=L[0],F[J+21]=L[1],F[J+22]=0,F[J+23]=y):(A[B]=E[0],A[B+1]=E[1],A[B+2]=E[2],A[B+3]=sa,F[J]=h[0],F[J+1]=h[1],F[J+2]=h[2],F[J+3]=y,A[B+4]=E[0],A[B+5]=E[1],A[B+6]=E[2],A[B+7]=-sa,F[J+4]=h[0],F[J+5]=h[1],F[J+6]=h[2],F[J+7]=-y,A[B+8]=h[0],A[B+9]=h[1],A[B+10]=h[2],A[B+11]=-W,F[J+8]=E[0],F[J+9]=E[1],
F[J+10]=E[2],F[J+11]=y,A[B+12]=E[0],A[B+13]=E[1],A[B+14]=E[2],A[B+15]=sa,F[J+12]=h[0],F[J+13]=h[1],F[J+14]=h[2],F[J+15]=y,A[B+16]=h[0],A[B+17]=h[1],A[B+18]=h[2],A[B+19]=-W,F[J+16]=E[0],F[J+17]=E[1],F[J+18]=E[2],F[J+19]=y,A[B+20]=h[0],A[B+21]=h[1],A[B+22]=h[2],A[B+23]=W,F[J+20]=E[0],F[J+21]=E[1],F[J+22]=E[2],F[J+23]=-y),B+=24,J+=24;sa=W}E=[ca[0],ca[1],ca[2]];X=0;for(pa=fa.length;X<pa;X++){null!=forceScale_&&(E=[E[0]*forceScale_[0],E[1]*forceScale_[1],E[2]*forceScale_[2]]);T[0]+=E[0];T[1]+=E[1];T[2]+=
E[2];if(!N)for(h=null!=Ia?Ia[X]:0,Ea&&(qa=[0,0,0],H=[0,0,0],vec3Normalize(ja,H),vec3AnyPerpendicular(H,qa),vec3Normalize(qa),U(H,qa,H)),ca=0;ca<Z;ca++)v&&!V?(A[B]=E[0],A[B+1]=E[1],A[B+2]=E[2],Ea?(sa=K[ca][0],W=K[ca][1],A[B+3]=E[0]+(H[0]*sa+qa[0]*W)*y,A[B+4]=E[1]+(H[1]*sa+qa[1]*W)*y,A[B+5]=E[2]+(H[2]*sa+qa[2]*W)*y,sa=K[ca+1][0],W=K[ca+1][1],A[B+6]=E[0]+(H[0]*sa+qa[0]*W)*y,A[B+7]=E[1]+(H[1]*sa+qa[1]*W)*y,A[B+8]=E[2]+(H[2]*sa+qa[2]*W)*y):(A[B+3]=E[0]+K[ca][0]*y,A[B+4]=E[1]+K[ca][1]*y,A[B+5]=E[2],A[B+
6]=E[0]+K[ca+1][0]*y,A[B+7]=E[1]+K[ca+1][1]*y,A[B+8]=E[2]),B+=9):(sa=X!=pa-1?A[X*Ba+3]:A[(X-1)*Ba+11],A[B]=E[0],A[B+1]=E[1],A[B+2]=E[2],A[B+3]=sa,F[J]=0,F[J+1]=0,F[J+2]=0,F[J+3]=0,A[B+4]=E[0],A[B+5]=E[1],A[B+6]=E[2],A[B+7]=sa,F[J+4]=K[ca][0]*y,F[J+5]=K[ca][1]*y,F[J+6]=aa[ca]+h,F[J+7]=0,A[B+8]=E[0],A[B+9]=E[1],A[B+10]=E[2],A[B+11]=sa,F[J+8]=K[ca+1][0]*y,F[J+9]=K[ca+1][1]*y,F[J+10]=aa[ca+1]+h,F[J+11]=0,B+=12,J+=12);p&&(ca=[E[0],E[1],E[2]+.1*G],Ua[X]=ca,Bd[pa-X-1]=ca);E=fa[X+1]}}0<ha&&(T[0]/=ha,T[1]/=
ha,T[2]/=ha);T[0]+=ab[0];T[1]+=ab[1];T[2]+=ab[2];X=r||P||O||R;n&&(X={command:"addRenderJob",vertexBuffer:A,color:w,"z-index":f,center:T,normalBuffer:F,"hover-event":r,"click-event":P,"draw-event":t,hitable:X,state:Ja,eventInfo:g,"enter-event":O,"leave-event":R,"zbuffer-offset":u,"line-width":2*y,lod:Ha},X.type=v?1==V?"flat-tline":"flat-line":1==V?"pixel-tline":"pixel-line",V&&null!=C&&(X.texture=[I[C[0]],C[1],C[2]],X.background=Za),pa=JSON.stringify({S:X.type,Rc:w,Af:f,yr:u}),F?a(X,[A.buffer,F.buffer],
pa):a(X,[A.buffer],pa));if(p)for(X=0,pa=ka.length;X<pa;X++)n=ka[X].bq,w=ka[X].aq,y=b,p=T,A=c,m=d,F=f,u=g,v=x(m,"line-label-color",y,A),r=x(m,"line-label-source",y,A),C=x(m,"line-label-size",y,A),Za=x(m,"line-label-offset",y,A),1E-4>Math.abs(C)||(V=D(m,r,y),"$name"!=r||e(V,Ka["default"])||(r=D(m,"$name:en",y),e(r,Ka["default"])&&(V=r)),V&&""!=V&&(r=x(m,"hover-event",y,A),P=x(m,"click-event",y,A),t=x(m,"draw-event",y,A),O=x(m,"enter-event",y,A),R=x(m,"leave-event",y,A),y=x(m,"zbuffer-offset",y,A),m=
48*V.length,A=new Float32Array(m),m=new Float32Array(m),$a=r||P||O||R,n=k(n,V,C,Ka["default"],Za,A,m,0),k(w,V,C,Ka["default"],Za,A,m,n),w=JSON.stringify({S:"line-label",Rc:v,Af:F,yr:y}),a({command:"addRenderJob",type:"line-label",vertexBuffer:A,texcoordsBuffer:m,color:v,"z-index":F,center:p,"hover-event":r,"click-event":P,"draw-event":t,"enter-event":O,"leave-event":R,"zbuffer-offset":y,hitable:$a,state:Ja,eventInfo:u,lod:Ha},[A.buffer,m.buffer],w)))}}}function u(a){switch(a){case "filter":return null;
case "inherit":return"";case "line":return!1;case "line-flat":return!1;case "line-width":return 1;case "line-color":return[255,255,255,255];case "line-style":return"solid";case "line-style-texture":return null;case "line-style-background":return[0,0,0,0];case "line-label":return!1;case "line-label-color":return[255,255,255,255];case "line-label-source":return"$name";case "line-label-size":return 1;case "line-label-offset":return 0;case "point":return!1;case "point-flat":return!1;case "point-radius":return 1;
case "point-Layer":return"solid";case "point-color":return[255,255,255,255];case "icon":return!1;case "icon-source":return null;case "icon-scale":return 1;case "icon-offset":return[0,0];case "icon-origin":return"bottom-center";case "icon-stick":return[0,0,0,255,255,255,255];case "icon-color":return[255,255,255,255];case "label":return!1;case "label-color":return[255,255,255,255];case "label-source":return"$name";case "label-size":return 10;case "label-offset":return[0,0];case "label-origin":return"bottom-center";
case "label-align":return"center";case "label-stick":return[0,0,0,255,255,255,255];case "label-width":return 200;case "polygon":return!1;case "polygon-color":return[255,255,255,255];case "z-index":return 0;case "zbuffer-offset":return[0,0,0];case "hover-event":return!1;case "hover-style":return"";case "enter-event":return!1;case "leave-event":return!1;case "click-event":return!1;case "draw-event":return!1;case "visible":return!0;case "visibility":return 0;case "culling":return 180;case "next-pass":return null}}
function w(a,b,c){switch(b){case "inherit":return v(a,b,c,"string");case "line":return v(a,b,c,"boolean");case "line-flat":return v(a,b,c,"boolean");case "line-width":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "line-color":return v(a,b,c,"object",4,0,255);case "line-style":return v(a,b,c,"string");case "line-style-texture":return v(a,b,c,"object",3,-Number.MAX_VALUE,Number.MAX_VALUE);case "line-style-background":return v(a,b,c,"object",4,0,255);case "line-label":return v(a,b,c,"boolean");
case "line-label-source":return v(a,b,c,"string");case "line-label-color":return v(a,b,c,"object",4,0,255);case "line-label-size":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "line-label-offset":return v(a,b,c,"number",null,-Number.MAX_VALUE,Number.MAX_VALUE);case "point":return v(a,b,c,"boolean");case "point-flat":return v(a,b,c,"boolean");case "point-radius":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "point-Layer":return v(a,b,c,"string");case "point-color":return v(a,
b,c,"object",4,0,255);case "icon":return v(a,b,c,"boolean");case "icon-source":return v(a,b,c,"object",5,-Number.MAX_VALUE,Number.MAX_VALUE);case "icon-scale":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "icon-offset":return v(a,b,c,"object",2,-Number.MAX_VALUE,Number.MAX_VALUE);case "icon-origin":return v(a,b,c,"string");case "icon-stick":return v(a,b,c,"object",7,-Number.MAX_VALUE,Number.MAX_VALUE);case "icon-color":return v(a,b,c,"object",4,0,255);case "label":return v(a,b,c,"boolean");
case "label-color":return v(a,b,c,"object",4,0,255);case "label-source":return v(a,b,c,"string");case "label-size":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "label-offset":return v(a,b,c,"object",2,-Number.MAX_VALUE,Number.MAX_VALUE);case "label-origin":return v(a,b,c,"string");case "label-align":return v(a,b,c,"string");case "label-stick":return v(a,b,c,"object",7,-Number.MAX_VALUE,Number.MAX_VALUE);case "label-width":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "polygon":return v(styleId_,
b,c,"boolean");case "polygon-color":return v(styleId_,b,c,"object",4,0,255);case "z-index":return v(a,b,c,"number",null,-Number.MAX_VALUE,Number.MAX_VALUE);case "zbuffer-offset":return v(a,b,c,"object",3,0,Number.MAX_VALUE);case "hover-event":return v(a,b,c,"boolean");case "hover-style":return v(a,b,c,"string");case "enter-event":return v(a,b,c,"boolean");case "leave-event":return v(a,b,c,"boolean");case "click-event":return v(a,b,c,"boolean");case "draw-event":return v(a,b,c,"boolean");case "visible":return v(a,
b,c,"boolean");case "visibility":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "culling":return v(a,b,c,"number",180,1E-4,180);case "next-pass":return v(a,b,c,"object")}return c}function v(a,b,c,d,e,f,g){if(null!=c&&"object"==typeof c&&(null!=c.discrete||null!=c.linear||null!=c["lod-scaled"])){var h=!1;if(null!=c["lod-scaled"]){var k=c["lod-scaled"];if(!("object"==typeof k&&Array.isArray(k)&&2<=k.length))return C("wrong-property-value",a,b,c,null,"[]"),u(b);null==k[2]&&(k[2]=1);if("number"!=
typeof k[0]||"number"!=typeof k[2])return C("wrong-property-value",a,b,c,null,"[]"),u(b);if("number"==typeof k[1])return c;e=k[1];h=!0}else e=c.discrete||c.linear;if(null==e||!("object"==typeof e&&Array.isArray(e)&&0<e.length))return C("wrong-property-value",a,b,c,null,"[]"),u(b);if(null!=e){var m=null;d=0;for(k=e.length;d<k;d++){var n=e[d];if(null==n||"object"!=typeof n||!Array.isArray(n)||2==n.length)if(null==m&&(m=typeof n[1],1==h&&"number"!=m)||"number"!=typeof n[0]||typeof n[1]!=m||"number"==
m&&(n[1]>g||n[1]<f))return C("wrong-property-value[]",a,b,c,d,"[]"),u(b)}}return c}if(typeof c!=d&&(null!==c||"icon-source"!=b&&"visibility"!=b))return C("wrong-property-value",a,b,c),u(b);switch(typeof c){case "object":if(null===c&&("line-style-texture"==b||"icon-source"==b||"visibility"==b||"next-pass"==b))return c;if("next-pass"==b)if(1==Array.isArray(c)&&0<c.length)for(d=0;d<k;d++){if(f=c[d],"object"!=typeof f||1!=Array.isArray(f)||2!=f.length||"number"!=typeof f[0]||"string"!=typeof f[1])return C("wrong-property-value[]",
a,b,c,d),u(b)}else return C("wrong-property-value",a,b,c),u(b);if(null!=e)if(1==Array.isArray(c)&&c.length==e){d=0;if("icon-source"==b||"line-style-texture"==b){if("string"!=typeof c[0])return C("wrong-property-value[]",a,b,c,0),u(b);if(null==I[c[0]])return C("wrong-object",a,b,c,null,"bitmap"),u(b);d=1}for(k=c.length;d<k;d++)if("number"!=typeof c[d])return C("wrong-property-value[]",a,b,c,d),u(b)}else return C("wrong-property-value",a,b,c),u(b);return c;case "string":if("line-style"==b)switch(c){case "solid":case "texture":return c;
default:return C("wrong-property-value",a,b,c),u(b)}if("label-origin"==b||"icon-origin"==b)switch(c){case "top-left":case "top-right":case "top-center":case "center-left":case "center-right":case "center-center":case "bottom-left":case "bottom-right":case "bottom-center":return c;default:return C("wrong-property-value",a,b,c),u(b)}if("label-align"==b)switch(c){case "left":case "right":case "center":break;default:return C("wrong-property-value",a,b,c),u(b)}return c;case "number":return c>g||c<f?(C("wrong-property-value",
a,b,c),u(b)):c;case "boolean":return c}}function C(a,b,c,d,e,f){"object"==typeof d&&(d=JSON.stringify(d));var g=null;switch(a){case "wrong-property-value":g="Error: wrong layer property "+(f?"'"+f+"'":"")+": "+b+"."+c+" = "+d;break;case "wrong-property-value[]":g="Error: wrong layer property "+(f?"'"+f+"'":"")+"["+e+"]: "+b+"."+c+" = "+d;break;case "wrong-object":g="Error: reffered "+f+" does not exist: "+b+"."+c+" = "+d;break;case "wrong-object[]":g="Error: reffered "+f+" does not exist: "+b+"."+
c+"["+e+"] = "+d;break;case "wrong-Layer":g="Error: reffered "+f+" Layer does not exist: "+f+"["+e+"].Layer = "+b;break;case "wrong-bitmap":g="Error: wrong definition of bitmap: "+b;break;case "custom":g="Error: "+b}g&&console.log(g)}function N(a,b,c,d,e){if(100<e)C("custom","infinite inherit loop in Layer: "+a);else if(null!=c.inherit){var f=d.Layers[c.inherit];if(null!=f){null!=f.inherit&&N(c.inherit,b,f,d,e++);for(var g in f)b[g]=f[g]}else C("wrong-object",a,"inherit",f,"Layer")}}function x(a,
b,c,d){var e=a[b];switch(typeof e){case "string":if(0<e.length&&"$"==e.charAt(0)){d=c.tg[e.substr(1)];if(null!=d)return d;C("wrong-object",a["$$layer-id"],b,e,null,"feature-property")}return e;case "object":if(null==e)break;if(1==Array.isArray(e)){if("icon-source"==b&&null==I[e[0]]){C("wrong-object",a["$$layer-id"],b,e,null,"bitmap");break}return e}var f;a=null;if(null!=e["lod-scaled"]){a=e["lod-scaled"];if("number"==typeof a[1])return a[1]*Math.pow(2*a[2],a[0]-d);f=a[1]}else f=e.discrete||e.linear;
b=f[0][0];c=f[0][1];for(var g=typeof c,k=c,h=0,m=f.length;h<=m;h++){if(h==m){k=c;break}if(f[h][0]>d){if(null!=e.discrete||null!=a)k=c;else{currentLod_=f[h][0];currentValue_=f[h][1];if(currentLod_==b)break;switch(g){case "boolean":currentValue_=(c=c?1:0)?1:0;k=c+(d-b)/(currentLod_-b)*(currentValue_-c);k=.5<k?!0:!1;break;case "number":k=c+(d-b)/(currentLod_-b)*(currentValue_-c);break;case "object":for(k=[],e=0,f=c.length;e<f;e++)k[e]=c[e]+(d-b)/(currentLod_-b)*(currentValue_[e]-c[e])}}break}b=f[h][0];
c=f[h][1]}null!=a&&(k*=Math.pow(2*a[2],a[0]-d));return k;case "number":case "boolean":return e}return u(b)}function D(a,b,c){switch(typeof b){case "string":if(0<b.length)switch(b.charAt(0)){case "$":return c=c.tg[b.substr(1)],"undefined"==typeof c&&C("wrong-expresion",a["$$layer-id"],b,b,null,"feature-property"),c}}return b}function G(a,b,c){var d=y.ij[a];return null==d?(C("wrong-Layer",a,null,null,c,b),{}):d}function U(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1];b=b[2];c[0]=e*b-a*
g;c[1]=a*f-d*b;c[2]=d*g-e*f}function r(a,b,c,d){if(!a||!Array.isArray(a))return!1;switch(a[0]){case "all":for(var e=!0,f=1,g=a.length;f<g;f++)e=e&&r(a[f],b,c,d);return e;case "any":e=!1;f=1;for(g=a.length;f<g;f++)e=e||r(a[f],b,c,d);return e;case "none":e=!0;f=1;for(g=a.length;f<g;f++)e=e&&r(a[f],b,c,d);return!e;case "skip":return!1}switch(a[1]){case "#type":e=c;break;case "#group":e=d;break;default:if((c=a[1])&&0<c.length)switch(c.charAt(0)){case "$":e=b.tg[c.substr(1)];break;case "@":e=K[c];break;
default:e=b.tg[c]}}switch(a[0]){case "==":return e==a[2];case "!=":return e!=a[2];case ">=":return e>=a[2];case "<=":return e<=a[2];case ">":return e>a[2];case "<":return e<a[2];case "has":return"undefined"!=typeof e;case "!has":return"undefined"==typeof e;case "in":f=2;for(g=a.length;f<g;f++)if(a[f]==e)return!0;break;case "!in":f=2;for(g=a.length;f<g;f++)if(a[f]==e)return!1;return!0}return!1}var y={},Z={},I={},K={},ja=[0,0,0],ka=[1,1,1],ha=[1,1,1],aa=4096,Ea=!1,Ha=0,Ka={},Ja=0,ab=[0,0,0],Ia=Array(65536),
Ba=0,Ua=Ia.length;vec3Normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=Math.sqrt(c*c+d*d+e*e);if(f){if(1==f)return b[0]=c,b[1]=d,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;return b};vec3Length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};vec3AnyPerpendicular=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2];b[0]=1;b[1]=1;b[2]=e?-(c+d)/e:0;return b};self.onmessage=function(a){a=a.data;var d=a.data;switch(a.command){case "setStylesheet":if(d){Ea=
d.geocent||!1;var e=d.data;I={};K=e.constants||{};a=e.bitmaps||{};for(var f in a)d=a[f],"string"==typeof d?d={url:d}:"object"==typeof d?null==d.url&&C("wrong-bitmap",f):C("wrong-bitmap",f),I[f]=d;postMessage({command:"loadBitmaps",bitmaps:I});y={ij:{}};a=e.layers||{};Z=y.ij;for(f in a){var d=y.ij,g=f,k=f,h={},m=k,n=h,p=a[f];null!=p.inherit&&N(m,n,p,e,0);var r=void 0;for(r in p)n[r]=p[r];n["$$layer-id"]=m;m=void 0;for(m in h)n=h[m],"string"==typeof n&&0<n.length&&"@"==n.charAt(0)&&(null!=K[n]?h[m]=
K[n]:(C("wrong-object",k,m,n,null,"constant"),h[m]=u(m))),h[m]=w(k,m,h[m]);d[g]=h}}postMessage("ready");break;case "setFont":Ka["default"]={jd:d.chars,rf:d.space,s:d.size};postMessage("ready");break;case "processGeodata":Ha=a.lod||0;a=d=JSON.parse(d);f=Ha;if("string"==typeof a)try{e=JSON.parse(a)}catch(Je){e=null}else e=a;if(e)for(e=e.groups||[],a=0,d=e.length;a<d;a++)if(h=e[a],g=f,k=h.id||"",m=h.bbox){ja=m[0];ka=m[1];ha=[m[1][0]-m[0][0],m[1][1]-m[0][1],m[1][2]-m[0][2]];aa=h.resolution||4096;ab=[0,
0,0];forceScale_=[ha[0]/aa,ha[1]/aa,ha[2]/aa];postMessage({command:"beginGroup",id:h.id,bbox:[ja,ka],origin:ja});p=h.points||[];m=0;for(n=p.length;m<n;m++)c("point-array",p[m],g,m,"point",k);p=h.lines||[];m=0;for(n=p.length;m<n;m++)c("line-string",p[m],g,m,"line",k);h=h.polygons||[];m=0;for(n=h.length;m<n;m++)c("polygon",h[m],g,m,"polygon",k);b();postMessage({command:"endGroup"})}b();postMessage("allProcessed");postMessage("ready")}}};
q.Kg=function(a,b){this.Da=a;this.c=a.c;this.R=!1;this.hg=b;this.aa=!0;var c=window.URL||window.webkitURL,d,e=q.Tq();try{d=new Blob([e],{type:"application/javascript"})}catch(g){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.Dr,d=new BlobBuilder,d.append(e),d=blob.getBlob()}this.Yh=new Worker(c.createObjectURL(d));this.Yh.onmessage=this.onMessage.bind(this)};q.Kg.prototype.D=function(){1!=this.R&&(this.R=!0,null!=this.Yh&&this.Yh.terminate())};
q.Kg.prototype.U=function(){return this.aa||this.R};q.Kg.prototype.onMessage=function(a){1!=this.R&&(a=a.data,"string"===typeof a&&"ready"==a&&(this.aa=!0),null!=this.hg&&this.hg(a))};function xc(a,b,c,d){1!=a.R&&(a.aa=!1,b={command:b,data:c},d&&d.f&&(b.lod=d.f[0]),a.Yh.postMessage(b))}
function Yb(a,b,c){this.c=a;this.f=c;this.Tm=[256,256];this.na=[0,100];this.G=[];this.V=[[0,0],[0,0]];this.Wb=null;this.Aa=this.c.Aa;this.Rb=this.c.Rb;this.fc=this.c.fc;this.aa=!1;"esri-world-imagery"==c&&(b.availability={type:"negative-size",size:2521});"string"===typeof b?(this.Wb=this.c.rb(b),this.Aa=q.qa.eh(this.Wb),this.Rb=q.qa.jh(this.Wb),this.fc=q.qa.gh(this.Wb),q.Zc(this.Wb,function(a){this.we(a);this.aa=!0;qc(this.c)}.bind(this),function(){}.bind(this),null,q.useCredentials?-1!=this.Wb.indexOf(this.c.Aa):
!1,this.c.C.ub)):(this.we(b),this.aa=!0)}
Yb.prototype.we=function(a){this.Ip=a.id||null;this.S=a.type||"raster";this.fd=this.rb(a.url,"");this.Tm=a.tileSize||[256,256];this.na=a.lodRange||[0,0];this.V=a.tileRange||[[0,0],[0,0]];this.Zb=this.rb(a.metaUrl);this.Cj=this.rb(a.maskUrl);this.ph=a.isTransparent||!1;this.G=a.credits||[];this.Zd=Math.pow(2,this.na[0])/((this.V[1][0]-this.V[1][0]+1)*(this.V[1][1]-this.V[1][1]+1));if(this.qc=a.availability?{}:null)a=a.availability,this.qc.S=a.type,this.qc.Bp=a.mime,this.qc.En=a.codes,this.qc.s=a.size;
this.Zb&&this.Cj&&(this.qc={S:"metatile"});switch(typeof this.G){case "string":this.G=[];break;case "object":if(!Array.isArray(this.G)){a=this.G;this.G=[];for(var b in a)Tb(this.c,b,new Ub(this.c,a[b])),this.G.push(b)}b=0;for(a=this.G.length;b<a;b++);}};Yb.prototype.Ib=function(){return{type:this.S,url:this.fd,tileSize:this.Tm,credits:this.G,lodRange:this.na,tileRange:this.V,mataUrl:this.Zb,maskUrl:this.Cj,isTransparent:this.ph}};
Yb.prototype.rb=function(a,b){if(!a)return b;a=a.trim();return-1!=a.indexOf("://")?a:0==a.indexOf("//")?this.Rb+a:0==a.indexOf("/")?this.fc+a:this.Aa+a};function yc(a,b){var c=b[0]-a.na[0];if(0>c)return!1;var d=b[1]>>c,c=b[2]>>c;return d<a.V[0][0]||d>a.V[1][0]||c<a.V[0][1]||c>a.V[1][1]?0:b[0]>a.na[1]?1:2}function zc(a,b){return Ac(a.c,a.fd,{da:b[0],hb:b[1],ib:b[2]},null,void 0)}function Qb(a){this.c=a;this.sb=new Bc(a,null,[0,0,0])}Qb.prototype.D=function(){this.sb.D()};
function Cc(a,b,c,d){a=a.sb;var e=b[1]>>c<<c;c=b[2]>>c<<c;for(b=b[0];0<b;b--){var g=0,f=1<<b-0-1;0!=(e&f)&&(g+=1);0!=(c&f)&&(g+=2);if(!a.Z[g])if(d)a.Lg(g);else return null;a=a.Z[g]}return a}function Bc(a,b,c){this.c=a;this.f=c;this.sa=b;this.cf={};this.dm={};this.Rm={};this.Va={};this.G={};this.Z=[null,null,null,null]}Bc.prototype.D=function(){for(var a=0;4>a;a++)null!=this.Z[a]&&this.Z[a].D();this.Z=[null,null,null,null];a=this.sa;this.sa=null;null!=a&&a.removeChild(this)};
Bc.prototype.Lg=function(a){if(!this.Z[a]){var b=this.f,b=[b[0]+1,b[1]<<1,b[2]<<1];switch(a){case 1:b[1]++;break;case 2:b[2]++;break;case 3:b[1]++,b[2]++}this.Z[a]=new Bc(this.c,this,b)}};Bc.prototype.wm=function(a){null!=this.Z[a]&&(this.Z[a].D(),this.Z[a]=null)};Bc.prototype.removeChild=function(a){for(var b=0;4>b;b++)this.Z[b]==a&&(this.Z[b].D(),this.Z[b]=null)};function Dc(a,b,c,d,e,g,f){var k=a.Rm[b];k||(k=new Ec(a.c,b,c,d,e,g,f),a.Rm[b]=k);return k}
function Fc(a,b){for(var c in a.cf)a.cf[c]==b&&delete a.cf[c]}function Gc(a,b,c,d){var e=a.cf,g;for(g in e)if(e[g].A==b)return e[g];g=b.fh(a.f);return e[g]?(b=e[g].clone(b),a.cf[g]=b):c?(b=new Hc(a,b,d),a.cf[g]=b):null}function Fb(a,b){this.c=a;this.lg=null!=b?b:Number.MAX_VALUE;this.pb=this.Lb=null;this.dd=0}function Ic(a,b){if(null!=b&&a.pb!=b){null!=b.Ab&&(b.Ab.ac=b.ac);null!=b.ac&&(b.ac.Ab=b.Ab);a.Lb==b&&(a.Lb=b.Ab);var c=a.pb;a.pb=b;a.pb.ac=c;a.pb.Ab=null;c.Ab=a.pb}}l=Fb.prototype;
l.clear=function(){for(var a=this.pb;null!=a;)null!=a.Vg&&a.Vg(),a=a.ac;this.pb=this.Lb=null;this.dd=0};function Jc(a,b,c){b={Vg:b,Qk:c,Ab:null,ac:a.pb};null!=a.pb&&(a.pb.Ab=b);a.pb=b;null==a.Lb&&(a.Lb=b);a.dd+=c;cc(a);return b}l.remove=function(a){var b=!1;a==this.pb&&(this.pb=a.ac,b=!0,null!=this.pb&&(this.pb.Ab=null));a==this.Lb&&(this.Lb=a.Ab,b=!0,null!=this.Lb&&(this.Lb.ac=null));if(!b){if(a.Ab)a.Ab.ac=a.ac;else debugger;if(a.ac)a.ac.Ab=a.Ab;else debugger}this.dd-=a.Qk;a.Vg();cc(this)};
function cc(a){for(;a.dd>a.lg;){var b=a.Lb;if(null!=b)a.Lb=a.Lb.Ab,null!=a.Lb&&(a.Lb.ac=null),a.dd-=b.Qk,b.Vg();else break}}l.qn=function(a,b){return Jc(this,b,a)};l.removeItem=function(a){return this.remove(a)};l.lp=function(a){return Ic(this,a)};Fb.prototype.addItem=Fb.prototype.qn;Fb.prototype.removeItem=Fb.prototype.removeItem;Fb.prototype.itemUsed=Fb.prototype.lp;function Db(a,b){this.c=a;b instanceof Db?this.o=b.o.slice():(this.o=null!=b&&b instanceof Array?b.slice():[],this.hn())}l=Db.prototype;
l.clone=function(){return new Db(this.c,this.o)};function vc(a){return[a.o[1],a.o[2],a.o[4]]}function Kc(a,b){a.o[1]=b[0];a.o[2]=b[1];a.o[4]=b[2];return a}function Lc(a,b){a.o[1]=b[0];a.o[2]=b[1]}function Uc(a,b){a.o[4]=b;return a}l.Tb=function(){return[this.o[5],this.o[6],this.o[7]]};l.setOrientation=function(a){this.o[5]=a[0];this.o[6]=a[1];this.o[7]=a[2];return this};l.Nd=function(){return this.o[9]};function Vc(a,b){a.o[9]=b;return a}function Wc(a,b){a.o[8]=b;return a}
function wc(a){return.5*a.o[8]/Math.tan(q.Ka(.5*a.Nd()))}l.check=function(){this.o[6]=q.de(this.o[6],-90,90);this.o[5]%=360;this.o[7]%=360};function Xc(a,b,c,d){var e=vc(a),g;$b(a.c).Pd();d=null==d?1:d;Zb($b(a.c))?(d=q.Ka(b),d=[-Math.sin(d),Math.cos(d)],Lc(a,[e[0]+d[0]*c,e[1]+d[1]*c])):(g=$b(a.c).Pd(),c=(new GeographicLib.Geodesic.Geodesic(g.a,g.a/g.b-1)).Direct(e[1],e[0],b,c),Lc(a,[c.lon2,c.lat2]),e=a.Tb(),e[0]+=(c.azi1-c.azi2)*d,a.setOrientation(e));return a}
function Yc(a,b){if(b==a.o[0])return a;if("obj"==b){if("float"==a.o[3]){var c=!0;Zc(a,"fix")}var d=wc(a),e=a.Tb(),g=q.Ka(-e[1]),f=d*Math.sin(g),d=d*Math.cos(g);Zb($b(a.c))?(e=q.Ka(e[0]),e=[-Math.sin(e),Math.cos(e)],g=vc(a),g[0]+=e[0]*d,g[1]+=e[1]*d):(Xc(a,-e[0],d),g=vc(a));g[2]-=f;Kc(a,g);c&&Zc(a,"float")}else"subj"==b&&(g=$c(a,a.o[3]),Kc(a,g));a.o[0]=b;return a}
function Zc(a,b){if(a.o[3]==b)return a;var c=uc(a.c,vc(a),a.o[8],a.c.h.pd),c=a.c.Yc(vc(a),c);"float"==b?(a.o[3]=b,a.o[4]-=c[0]):"fix"==b&&(a.o[3]=b,a.o[4]+=c[0]);return a}
l.hn=function(){var a=this.o;"fixed"==a[0]&&(a[0]="obj",a[9]=a[8],a[8]=a[7],a[7]=a[6],a[6]=a[5],a[5]=a[4],a[4]=a[3],a[3]="fix");a[0]="obj"==a[0]||"subj"==a[0]?a[0]:"obj";a[1]=null!=a[1]?a[1]:0;a[2]=null!=a[2]?a[2]:0;a[3]="fix"==a[3]||"fixed"==a[3]||"float"==a[3]?a[3]:"float";a[4]=null!=a[4]?a[4]:0;a[5]=null!=a[5]?a[5]:0;a[6]=null!=a[6]?a[6]:-90;a[7]=null!=a[7]?a[7]:0;a[8]=null!=a[8]?a[8]:900;a[9]=null!=a[9]?a[9]:55;a[3]="fixed"==a[3]?"fix":a[3]};
function $c(a,b){var c=a.Tb(),d=q.i.create();q.i.multiply(q.dc(2,q.Ka(c[0])),q.dc(0,q.Ka(c[1])),d);if("obj"==a.o[0]){var c=vc(a),e=0;"float"==a.o[3]&&(d=uc(a.c,vc(a),a.o[8],a.c.h.pd),d=a.c.Yc(vc(a),d),e=d[0]);d=a.Rf(Zb($b(a.c)));Zb($b(a.c))?(c[0]+=d.bc[0],c[1]+=d.bc[1],c[2]+=d.bc[2]+e):(c=a.c.Fa([c[0],c[1],c[2]+e],"navigation","physical"),c[0]+=d.bc[0],c[1]+=d.bc[1],c[2]+=d.bc[2],c=a.c.Fa(c,"physical","navigation"));"fix"!=b&&(d=uc(a.c,c,a.o[8],a.c.h.pd),d=a.c.Yc(c,d),c[2]-=d[0]);return c}if(a.o[3]==
b)return vc(a);d=uc(a.c,vc(a),a.o[8],a.c.h.pd);d=a.c.Yc(vc(a),d);c=vc(a);c[2]="fix"==b?c[2]+d[0]:c[2]-d[0];return c}function ad(a,b){var c=vc(a);if("float"==a.o[3]){b=null!=b?b:uc(a.c,vc(a),a.o[8],a.c.h.pd);var d=a.c.Yc(vc(a),b);c[2]+=d[0]}c=a.c.Fa(c,"navigation","physical");d=a.c.va;c[0]-=d[0];c[1]-=d[1];c[2]-=d[2];return c}l.ie=function(a,b){if(b)var c=this.c.va,d=vc(this),c=[d[0]-c[0],d[1]-c[1],d[2]-c[2]];else c=ad(this,a);return Ta(this.c.l,c,yb(this.c.N))};
function bd(a){var b=a.clone();Zc(b,"fix");var c=vc(b),b=a.c.Fa(c,"navigation","physical");a.c.Fa([0,0],"navigation","physical");a.c.Fa([-180,0],"navigation","physical");a.c.Fa([90,0],"navigation","physical");a.c.Fa([0,90],"navigation","physical");a.c.Fa([-90,0],"navigation","physical");a.c.Fa([0,-90],"navigation","physical");a.c.Fa([0,-100],"navigation","physical");if(Zb($b(a.c)))var d=a.c.Fa([c[0],c[1]+100,c[2]],"navigation","physical"),e=a.c.Fa([c[0]+100,c[1],c[2]],"navigation","physical");else{var g=
sc(a.c),e=g.Direct(c[1],c[0],0,-100),d=a.clone();Lc(d,[e.lon2,e.lat2]);d=a.c.Fa(vc(d),"navigation","physical");e=g.Direct(c[1],c[0],90,100);c=a.clone();Lc(c,[e.lon2,e.lat2]);e=a.c.Fa(vc(c),"navigation","physical")}a=[d[0]-b[0],d[1]-b[1],d[2]-b[2]];b=[e[0]-b[0],e[1]-b[1],e[2]-b[2]];d=[0,0,0];q.F.normalize(a);q.F.normalize(b);q.F.xi(a,b,d);q.F.normalize(d);return{fl:b,Xk:a,jm:d}}
l.Rf=function(a,b){var c=this.Tb(),d=wc(this);b&&(c[1]=q.de(c[1],-89,90));var e=q.i.create();q.i.multiply(q.dc(2,q.Ka(c[0])),q.dc(0,q.Ka(c[1])),e);if("obj"==this.o[0]){var g=[0,-d,0];q.i.Za(e,g)}else g=[0,0,0];d={bc:null,xa:d,ak:null,Gg:null,Qp:g[2]};if(a){e=q.i.create();q.i.multiply(q.dc(0,q.Ka(-c[1]-90)),q.dc(2,q.Ka(-c[0])),e);var f=bd(this);north_=f.jm;east_=f.fl;direction_=f.Xk;var c=[1,0,0],f=[0,1,0],k=[0,0,1],h=[1,0,0],m=[0,0,-1],n=[0,0,0];q.F.xi(h,m,n);q.i.Za(e,k);q.i.Za(e,c);q.i.Za(e,f);q.i.Za(e,
h);q.i.Za(e,m);q.i.Za(e,n);e=h[0];h[0]=h[1];h[1]=e;e=m[0];m[0]=m[1];m[1]=e;e=n[0];n[0]=n[1];n[1]=e;h[2]=-h[2];m[2]=-m[2];n[2]=-n[2];f=[c[0],c[1],c[2],0,f[0],f[1],f[2],0,k[0],k[1],k[2],0,0,0,0,1];d.Gg=q.F.normalize([-g[0],-g[1],-g[2]]);d.wr=d.Gg;d.bc=g;d.ak=f}else f=bd(this),north_=f.jm,east_=f.fl,direction_=f.Xk,e=q.i.create(),q.i.multiply(q.dc(0,q.Ka(-c[1]-90)),q.dc(2,q.Ka(-c[0])),e),c=[1,0,0],f=[0,1,0],k=[0,0,1],h=vc(this),m=q.i.create(),q.i.multiply(q.dc(0,q.Ka(h[1]-90)),q.dc(2,q.Ka(-h[0]-90)),
m),q.i.Za(m,k),q.i.Za(m,c),q.i.Za(m,f),c=[c[0],c[1],c[2],0,f[0],f[1],f[2],0,k[0],k[1],k[2],0,0,0,0,1],n=[1,0,0],h=[0,1,0],m=[0,0,1],q.i.Za(c,h),q.i.Za(c,m),q.i.Za(c,n),q.i.Za(e,n),q.i.Za(e,h),q.i.Za(e,m),f=[n[0],n[1],n[2],0,h[0],h[1],h[2],0,m[0],m[1],m[2],0,0,0,0,1],c=q.i.inverse(c),q.i.Za(c,g),d.wr=[-c[8],-c[9],-c[10]],q.i.inverse(f,c),d.Gg=[-c[8],-c[9],-c[10]];d.bc=g;d.ak=f;return d};
l.toString=function(){var a=this.o;return a[0]+", "+a[1].toFixed(0)+", "+a[2].toFixed(0)+", "+a[3]+", "+a[4].toFixed(0)+", "+a[5].toFixed(0)+", "+a[6].toFixed(0)+", "+a[7].toFixed(0)+", , "+a[8].toFixed(0)+", "+a[9].toFixed(0)};function Ub(a,b){this.c=a;this.f=b.id||null;this.Hj=b.notice||null;this.fd=b.url||null;this.bp=q.Em(this.Hj);this.Vp=q.Em(this.Hj)}Ub.prototype.Ib=function(){return{id:this.f,notice:this.Hj,html:this.bp,plain:this.Vp}};
Cb.prototype.Ua=function(a){this.sd=.5*this.l.ja[0];var b=this.Od().Tb(),b=Math.log(.05)/(Math.max(5,-b[1])/90*Math.max(1,1E-4*this.ti)*this.N.ge),b=5/(Math.min(5E4,Math.max(this.sc,1E3))/5E3)*b;this.Ci||(b=0);this.Ue=b;this.l.Ue=b;this.qe=.9*this.Ub.lg;this.Gi=this.u.Ae=0;b=this.va;if(this.w.wf||this.w.vf)this.w.Vd=[];if(this.w.$n||this.w.dl||this.w.Di||this.w.bl||this.w.al||this.w.Ei){a=this.w.da;var c=this.w.Mq;if(this.w.dl&&this.w.Id)for(var d=this.w.Id,e=0,g=d.length;e<g;e++){var f=d[e];(c&&
f.f[0]==a||!c&&f.f[0]<=a)&&cd(this,f,f.B,b,f.mc,!1,!1)}if(this.w.Di&&this.w.Zg)for(d=this.w.Zg,e=0,g=d.length;e<g;e++)f=d[e],(c&&f.f[0]==a||!c&&f.f[0]<=a)&&cd(this,f,f.B,b,f.mc,!1,!1);if(this.w.bl&&this.w.qk){var d=this.w.qk,k=this.wc;this.wc=!0;e=0;for(g=d.length;e<g;e++)f=d[e],(c&&f.f[0]==a||!c&&f.f[0]<=a)&&dd(this,f,f.B,b,f.Ea);this.wc=k}if(this.w.al&&this.w.pk){d=this.w.pk;k=this.wc;this.wc=!0;e=0;for(g=d.length;e<g;e++)f=d[e],(c&&f.f[0]==a||!c&&f.f[0]<=a)&&dd(this,f,f.B,b,f.Ea);this.wc=k}var d=
this.w.Wl,h=this.w.Nq;if(this.w.Ei&&this.w.Ec){var m=this.w.Ec;this.wc=!0;e=0;for(g=m.length;e<g;e++)(f=m[e])&&f.H&&f.H.f&&(f=f.H,(h&&e==d||!h&&e<=d)&&(c&&f.f[0]==a||!c&&f.f[0]<=a)&&f.B&&(0!=(f.B.O&1)?cd(this,f,f.B,b,f.mc,!1,!1):dd(this,f,f.B,b,f.Ea)));this.wc=k}(this.w.Di&&this.w.Zg||this.w.Ei&&this.w.Ec)&&this.bh&&(Ab(this.l),Bb(this.l))}else{e=0;for(g=this.Eb.length;e<g;e++)this.Eb[e]=null;0<this.sb.Ge.length&&this.sb.Ua();if(this.w.zg){k=[];e=0;for(g=this.Eb.length;e<g;e++)if(d=this.Eb[e])for(c=
0,h=d.length;c<h;c++)k.push(d[c]);this.w.Ef=b;this.w.Id=k;this.w.zg=!1}if(this.w.wf){k=[];e=0;for(g=this.w.Vd.length;e<g;e++)f=this.w.Vd[e],k.push(f);this.w.Ef=b;this.w.qk=k;this.w.wf=!1}e=0;for(g=this.Of.length;e<g;e++)f=this.Of[e],f.aa&&f.sb&&(!f.Va||f.$d&&f.$d.U())&&("geodata"==f.S?f&&this.N.Pc(f.la,this.va)&&(null==f.Rh&&(k=Ac(f.c,f.Qf,{},null,void 0),f.Rh=new ed(this,k,{H:null,A:f})),f.fm!=f.Kd&&(f.ng=null,f.fm=f.Kd),f.Rh.U()&&(f.ng||(f.ng=new fd(this,f.Rh,{H:null,A:f})),f.ng.U()&&f.ng.Ua(this.va))):
f.sb.Ua());if(this.w.yg){k=[];e=0;for(g=this.Eb.length;e<g;e++)if(d=this.Eb[e])for(c=0,h=d.length;c<h;c++)f=d[c],f.A&&f.A.Ki&&k.push(f);this.w.Ef=b;this.w.Zg=k;this.w.yg=!1}if(this.w.vf){k=[];e=0;for(g=this.w.Vd.length;e<g;e++)f=this.w.Vd[e],f.A&&f.A.Ki&&k.push(f);this.w.Ef=b;this.w.pk=k;this.w.vf=!1}!a&&this.bh&&(Ab(this.l),Bb(this.l))}};
function gd(a,b,c){for(var d=!0,e=0,g=a.length;e<g;e++){var f=a[e];switch(f.S){case "submesh":var k=f.Yb,f=f.L,k=k&&k.U(c,b,!0),f=!f||f&&f.U(c,b,!0);k&&f||(d=!1);break;case "geodata":(k=f.ol)&&k.U(c,b,!0)||(d=!1)}}return d}function hd(a,b){for(var c in b.xb){var d=b.xb[c],e=a.Nc.cg[c];a.Nc.cg[c]=e?d>e?d:e:d}for(c in b.je)d=b.je[c],e=a.Nc.cg[c],a.Nc.kh[c]=e?d>e?d:e:d;for(c in b.Td)d=b.Td[c],e=a.Nc.Lh[c],a.Nc.Lh[c]=e?d>e?d:e:d}
function id(a,b,c,d,e){0<c.length&&a.Gi++;for(var g=0,f=c.length;g<f;g++){var k=c[g];switch(k.S){case "state":a.l.j.vd(k.xd);break;case "submesh":var h=k.Yb,m=k.L,n=h&&h.U(e,d),p=!m||m&&m.U(e,d);if(n&&p){a.wc&&a.Fi&&h.jb[k.bd].Se(b);a:{var n=b,t=k.bd,p=k.qd,k=k.ce;null!=h.hc[t]||null==h.jb[t]||h.jb[t].R||(h.hc[t]=jd(h.jb[t]));var u=h.jb[t];if(t=h.hc[t]){var w=h.c.l,v=null,C=null,N=null,x=null,D=h.c.el,G=0!=D?["aPosition","aBarycentric"]:["aPosition"];if("depth"==p)v=w.qm;else if(0<D)switch(D){case 2:v=
w.tm;break;case 3:v=w.gq;break;case 1:switch(p){case "internal":case "internal-nofog":v=w.um;N="aTexCoord";G.push("aTexCoord");break;case "external":case "external-nofog":v=w.tq;x="aTexCoord2";G.push("aTexCoord2");break;case "fog":break a}}else switch(p){case "internal":case "internal-nofog":v=w.Uj;N="aTexCoord";G.push("aTexCoord");break;case "external":case "external-nofog":v=w.rq;m&&(C=m.J?m.J.L&&m.J.L.Sa?m.J.L.Sa.Ya:null:m.Sa?m.Sa.Ya:null)&&(v=w.sq);x="aTexCoord2";G.push("aTexCoord2");break;case "fog":v=
w.hq}w.j.useProgram(v,G,C);if(m)if(G=m.J?m.J.L?m.J.L.Ya:null:m.Ya)m.xg!=h.u.tc&&(m.xg=h.u.tc,h.u.wb+=G.s),w.j.bindTexture(G),C&&w.j.bindTexture(C,1);else break a;else if("fog"!=p&&"depth"!=p)break a;C=h.wp;q.i.multiply(pb(w.N),u.We(n,h.vp),C);n=ob(w.N);Qa(v,"uMV",C);Qa(v,"uProj",n);if(0==D)switch(p){case "internal":case "fog":Pa(v,"uParams",[h.c.Me,h.c.Ue,0,0]);break;case "internal-nofog":Pa(v,"uParams",[h.c.Me,0,0,0]);break;case "external":db(v,"uAlpha",1);Pa(v,"uParams",[h.c.Me,h.c.Ue,0,0]);Pa(v,
"uTransform",m.J?m.J.L?m.J.en:null:[1,1,0,0]);break;case "external-nofog":db(v,"uAlpha",k),Pa(v,"uParams",[h.c.Me,0,0,0]),Pa(v,"uTransform",m.J?m.J.L?m.J.en:null:[1,1,0,0])}u.xg!=h.u.tc&&(u.xg=h.u.tc,h.u.wb+=t.s);t.Ua(v,"aPosition",N,x,0!=D?"aBarycentric":null);h.u.Te+=h.Jd;h.u.Yg++}}}break;case "geodata":(h=k.ol)&&h.U(e,d,!0)&&h.Ua(b)}}}q.Lr=[144,8880,5492];
function cd(a,b,c,d,e,g,f){if(a.u.wb>=a.qe)return!1;b.Xj=!1;if(b.A){if(0!=(c.O&1)){a.wc&&!g&&dd(a,b,c,d,b.Ea);if(a.Yo&&!g)return b.A.Va||kd(c,d,b),!0;g||(a.u.bi[b.f[0]]++,a.u.Id++);if(b.Be){b.ba=[[],[],[]];b.Eg=!0;if(b.rc)for(var k in b.rc)b.rc[k].gd=0;b.Be=!1}if(b.A.Va)if(1>=b.f[0])b=!0;else{if(null==b.cd){var h;if(b.A.nl){k=b.f;var m=a.sb.He;if(0==k[0])k=m.B&&0!=(m.B.O&2)?m:null;else{for(var n=null,p=1;p<=k[0];p++){var t=1<<k[0]-p,u=0;0!=(k[1]&t)&&(u+=1);0!=(k[2]&t)&&(u+=2);if(m=m.Z[u])m.B&&0!=
(m.B.O&2)&&(n=m);else break}k=n}k&&k.A&&(h=ld(k.A,k.f)+";"+k.f[0]+"-"+k.f[1]+"-"+k.f[2]+";"+k.B.rd+";"+k.B.ad,h=md(b.A,b.f,encodeURIComponent(h)))}h||(h=md(b.Na,b.f,""));k=b.cc;m={H:b,A:b.A};n=k.Va[h];n||(n=new ed(k.c,h,m),k.Va[h]=n);b.cd=n}h=a.Uc;b.Kd!=b.A.Kd&&(b.ba=[[],[],[]],null!=b.Qb&&b.Qb.D(),b.Qb=null,b.Kd=b.A.Kd);if(0<b.ba[h].length&&gd(b.ba[h],e,f))g||(id(a,d,b.ba[h],e),hd(a,b)),b.Kb=null,b=!0;else if(b.Qb||!b.cd.U(f,e)||f||(b.Qb=new fd(a,b.cd,{H:b,A:b.A})),b.Qb){b.Td={};a=b.A?b.A.Zd:0;d=
0;for(e=c.G.length;d<e;d++)b.Td[c.G[d]]=a;b.ba[h][0]={S:"geodata",ol:b.Qb};b=b.Qb.U()}else b=!1}else a:{if(!b.Ea){if(b.Na.Mc){b=!0;break a}h=b.Na;k=b.f;t=Ac(h.c,h.Ph,{da:k[0],hb:k[1],ib:k[2]},null,void 0);h=b.cc;k=t;m=h.dm[k];m||(m=new nd(h.c,k,b),h.dm[k]=m);b.Ea=m}h=a.Uc;k=!1;if(0<b.ba[h].length&&gd(b.ba[h],e,f))g||(id(a,d,b.ba[h],e),hd(a,b)),b.Kb=null,b=!0;else{if(b.Kb)if(1==b.Ea.U(!0,e)){if(0<b.ba[h].length){g||(id(a,d,b.Kb.ba[h],e,!0),hd(a,b));b=!0;break a}}else g||(id(a,d,b.Kb.ba[h],e,!0),hd(a,
b)),k=!0;0<b.ba[h].length&&a.h.ig&&!g&&(kd(c,d,b),k=!0);if(b.Ea.U(f,e)&&!f){m=b.Ea.jb;b.ba=[[],[],[]];b.xb={};b.Gb={};var w=0;if(b.A.ke){t=b.A.f;n=0;for(p=t.length;n<p;n++)(u=a.Qd(t[n]))&&(w=Math.max(w,u.Zd));for(var t=0,v=c.G.length;t<v;t++)b.je[c.G[t]]=w}else for(w=b.A.Zd,t=0,v=c.G.length;t<v;t++)b.xb[c.G[t]]=w;n=0;for(p=m.length;n<p;n++){t=m[n];a.wc&&a.Fi&&!g&&t.Se(d);if(t.xc){if(b.Eg){b.Eg=!1;for(var w=a,u=b,v=m,C=0,N=v.length;C<N;C++){var x=v[C];if(x.xc){var D=u.Na;u.A.ke&&(D=u.A.Fe[x.Fe-1]);
if(D){var G=u.rc[D.f];G||(G={Jc:[],ce:[],ii:!1,gd:0},u.rc[D.f]=G);if(G.gd!=u.gd){var U=w,r=u,y=x,x=D,D=G,G=G.gd!=u.gd;if(0<x.gc.length){if(G){D.Jc=[];for(var U=[],y=G=0,Z=x.gc.length;y<Z;y++){var I=x.gc[y][0];if(I&&I.aa&&yc(I,r.f)&&0<x.gc[y][1]){var K=null;r.f[0]>I.na[1]&&(K={Ce:od(r,I.na[1]),Im:null,Da:I,H:r});if(r.Ga[I.f]){K=r.Ga[I.f];if(r.Ga[I.f].qg)continue;pd(K)&&(D.ii=!0)}else{var ja=zc(I,r.f);r.Ga[I.f]=Dc(r.cc,ja,null,K,{H:r,Da:I},r,!1)}K=r.Ga[I.f];(K=!(1>x.gc[y][1]||K.J||pd(K)||I.ph))&&G++;
U.push(K);D.Jc.push(I.f);D.ce[I.f]=x.gc[y];r.Pa[I.f]=I;if(1>D.ce[I.f][1]||I.ph)D.ii=!0}}if(0<G){x=[];for(G=D.Jc.length-1;0<=G;G--)if(y=D.Jc[G],U[G]){x.unshift(y);break}else K=r.Ga[y],(1>D.ce[y][1]||r.Pa[y].ph||pd(K)&&!K.J)&&x.unshift(y);D.Jc=x}}}else null!=x.yd?G&&(I=U.Pa[x.yd])&&yc(I,r.f)&&(K=null,r.f[0]>I.na[1]&&(K={Ce:od(r,I.na[1]),Im:null,Da:I,H:r}),D.Jc.push(I.f),r.Pa[I.f]=I,r.Ga[I.f]||(ja=zc(I,r.f),r.Ga[I.f]=Dc(r.cc,ja,null,K,{H:r,Da:I},r,!1))):0!=y.yd&&(I=kc(U,y.yd))&&yc(I,r.f)&&(K=null,r.f[0]>
I.na[1]&&(K={Ce:od(r,I.na[1]),Im:null,Da:I,H:r}),r.Pa[I.f]=I,r.Ga[I.f]||(ja=zc(I,r.f),r.Ga[I.f]=Dc(r.cc,ja,null,K,{H:r,Da:I},r,!1)))}}}}w=void 0;for(w in u.rc)u.rc[w].gd=u.gd}u=b.Na;b.A.ke&&(u=b.A.Fe[t.Fe-1]);if(null!=u&&(w=b.rc[u.f]))if(t.xc)if(0<w.Jc.length)if(w.ii){t.Vb&&(null==b.ab[n]&&(t=qd(b.Na,b.f,n),b.ab[n]=Dc(b.cc,t,null,null,null,b,!0)),b.ba[0].push({S:"submesh",Yb:b.Ea,bd:n,L:b.ab[n],qd:"internal-nofog"}));b.ba[0].push({S:"state",xd:a.Un});N=w.Jc;r=0;for(D=N.length;r<D;r++)if(C=b.Ga[N[r]]){b.Gb[u.f]||
(b.Gb[u.f]=[]);b.Gb[u.f].push(N[r]);x=b.Pa[N[r]];U=x.G;t=0;for(v=U.length;t<v;t++)b.xb[U[t]]=x.Zd;b.ba[0].push({S:"submesh",Yb:b.Ea,bd:n,L:C,qd:"external-nofog",ce:w.ce[N[r]][1]})}b.ba[0].push({S:"submesh",Yb:b.Ea,bd:n,L:null,qd:"fog"});b.ba[0].push({S:"state",xd:a.cl})}else{if(t=w.Jc[w.Jc.length-1],C=b.Ga[t]){b.Gb[u.f]||(b.Gb[u.f]=[]);b.Gb[u.f].push(t);x=b.Pa[t];U=x.G;t=0;for(v=U.length;t<v;t++)b.xb[U[t]]=x.Zd;b.ba[0].push({S:"submesh",Yb:b.Ea,bd:n,L:C,qd:"external"})}}else if(t.yd){if(x=kc(a,t.yd))if(C=
b.Ga[x.f]){b.Gb[u.f]||(b.Gb[u.f]=[]);b.Gb[u.f].push(x.f);x=b.Pa[x.f];U=x.G;t=0;for(v=U.length;t<v;t++)b.xb[U[t]]=x.Zd;b.ba[0].push({S:"submesh",Yb:b.Ea,bd:n,L:C,qd:"external"})}}else t.Vb&&(null==b.ab[n]&&(t=qd(b.Na,b.f,n),b.ab[n]=Dc(b.cc,t,null,null,null,b,!0)),b.ba[0].push({S:"submesh",Yb:b.Ea,bd:n,L:b.ab[n],qd:"internal"}));else t.Vb&&(null==b.ab[n]&&(t=qd(b.Na,b.f,n),b.ab[n]=Dc(b.cc,t,null,null,null,b,!0)),b.ba[0].push({S:"submesh",Yb:b.Ea,bd:n,L:b.ab[n],qd:"internal"}))}else t.Vb&&(null==b.ab[n]&&
(t=qd(b.Na,b.f,n),b.ab[n]=Dc(b.cc,t,null,null,null,b,!0)),b.ba[0].push({S:"submesh",Yb:b.Ea,bd:n,L:b.ab[n],qd:"internal"}));b.ba[1].push({S:"submesh",Yb:b.Ea,bd:n,qd:"depth"})}gd(b.ba[h],e,f)?(g||(id(a,d,b.ba[h],e),hd(a,b)),b.Kb=null,k=!0):b.Kb?(g||(id(a,d,b.Kb.ba[h],e,!0),hd(a,b)),k=!0):a.h.ig&&!g&&(kd(c,d,b),k=!0)}else a.h.ig&&!g&&(kd(c,d,b),k=!0);b=k}}return b}return!0}if(!g&&b.Kb)return id(a,d,b.Kb.ba[a.Uc],e,!0),hd(a,b),!0}function od(a,b){for(;a&&a.f[0]>b;)a=a.sa;return a}
function dd(a,b,c,d,e){if(!a.Fi)if(a.$k){for(var g=[],f=0,k=c.Df.length;f<k;f++){var h=c.Df[f],h=["obj",h[0],h[1],"fix",h[2],0,0,0,10,90];g.push((new Db(c.c,h)).ie(null,!0))}f=c.c.l;f.fe([g[0],g[1],g[2],g[3],g[0]],2,[0,1,.5,255],!1,!1,!0);f.fe([g[4],g[5],g[6],g[7],g[4]],2,[0,1,.5,255],!1,!1,!0)}else c.Se(d);k=c.v.K;g=c.v.ea;d=a.C.ih().ie([k[0]+.5*(g[0]-k[0])-d[0],k[1]+.5*(g[1]-k[1])-d[1],g[2]-d[2]],yb(a.N));d[2]*=.9992;g=a.Rn;a.co&&(f=""+b.f[0],rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]-
4*g),4*g,f,[255,0,0,255],d[2]));a.Nr&&(f=""+b.f[1]+" "+b.f[2],rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]-11*g),4*g,f,[0,255,255,255],d[2]));a.jo&&(f=""+k[0].toFixed(1)+" "+k[1].toFixed(1)+" "+k[2].toFixed(1),rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+3*g),4*g,f,[0,255,255,255],d[2]));a.Zn&&e&&(f=""+e.Jd+" - "+e.jb.length+(b.A&&b.A.ke?" - 1":" - 0"),rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+10*g),4*g,f,[0,255,0,255],d[2]));a.io&&(f=""+a.Gi,rb(a.l,Math.round(d[0]-.5*sb(4*
g,f)),Math.round(d[1]+10*g),4*g,f,[0,255,0,255],d[2]));a.ko&&(f=JSON.stringify(b.A.f),c.Cf&&(f="[A]"+f),rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+10*g),4*g,f,[255,255,255,255],d[2]));if(a.Vn&&b.Gb){var m=b.A;if(m.ke)for(k=0,h=m.f.length;k<h;k++)b.Gb[m.f[k]]&&(f="< "+m.f[k]+" >",rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+(10+14*k)*g),4*g,f,[255,255,255,255],d[2]),f=JSON.stringify(b.Gb[m.f[k]]),rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+(17+14*k)*g),4*g,f,[255,255,255,
255],d[2]));else b.Gb[m.f]&&(f="< "+m.f+" >",rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+10*g),4*g,f,[255,255,255,255],d[2]),f=JSON.stringify(b.Gb[m.f]),rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+17*g),4*g,f,[255,255,255,255],d[2]))}if(a.$k){var f="{ ",n;for(n in b.xb)b.xb[n]&&(f+=n+":"+b.xb[n]+", ");for(n in b.je)b.xb[n]||(f+=n+":"+b.je[n]+", ");f+="}";rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+10*g),4*g,f,[255,255,255,255],d[2])}a.Yn&&(f=""+b.xa.toFixed(2)+"  "+b.Db.toFixed(3)+
"  "+c.jf.toFixed(3),f+="--"+b.Vq.toFixed(3),rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+17*g),4*g,f,[255,0,255,255],d[2]));a.ho&&(n=(c.O&240)>>4,f=""+c.O.toString(2)+"-"+(n&1?"1":"0")+(n&2?"1":"0")+(n&4?"1":"0")+(n&8?"1":"0"),f+="-"+c.rd+"/"+c.ad,rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]-18*g),4*g,f,[255,0,255,255],d[2]));if(a.lo&&e)for(c=e.jb,k=0,h=c.length;k<h;k++)c[k].Vb&&(e=b.ab[k])&&e.Ya&&(f="["+k+"]: "+e.Ya.Cd+" x "+e.Ya.Ze,rb(a.l,Math.round(d[0]-.5*sb(4*g,f)),Math.round(d[1]+
(17+14*k)*g),4*g,f,[255,255,255,255],d[2]))}function Y(a){this.c=a;this.h=a.h}l=Y.prototype;l.setPosition=function(a){this.c.setPosition(a);return this};l.Od=function(){return this.c.Od().o};l.qf=function(a){this.c.qf(a);return this};l.Xi=function(){return this.c.Xi()};l.Pi=function(){return this.c.Pi()};
l.zo=function(){var a=this.c,b=a.Nc.cg,c=a.Nc.kh,d=[],e=[],g;for(g in c)b[g]||(b[g]=c[g]);a.Nc.kh={};for(g in b)d.push(g),e.push(b[g]);do for(var f=!0,b=0,c=e.length-1;b<c;b++)e[b]<e[b+1]&&(f=e[b],e[b]=e[b+1],e[b+1]=f,f=d[b],d[b]=d[b+1],d[b+1]=f,f=!1);while(!f);b=a.Nc.Lh;a=[];e=[];for(g in b)a.push(g),e.push(b[g]);do for(f=!0,b=0,c=e.length-1;b<c;b++)e[b]<e[b+1]&&(f=e[b],e[b]=e[b+1],e[b+1]=f,f=a[b],a[b]=a[b+1],a[b+1]=f,f=!1);while(!f);return{"3D":[],imagery:d,mapdata:a}};
l.yo=function(a){return(a=this.c.G[a])?a.Ib():{}};l.So=function(){return dc(this.c.pg)};l.Ro=function(a){return(a=this.c.pg[a])?a.Ib():{}};l.Oi=function(){return this.c.Oi()};l.ql=function(a){return this.c.ql(a)};l.Ri=function(){return this.c.Ri()};l.Ao=function(a){return(a=this.c.Ra[a])?a.Ib():{}};l.Wi=function(){return this.c.Wi()};l.Qo=function(a){return(a=this.c.Ra[a])?a.Ib():{}};l.Vi=function(){return this.c.Vi(surfaceId_)};l.Pd=function(a){return(a=this.c.De[a])?a.Ib():{}};l.Po=function(){return this.c.Cb.Ib()};
l.Ln=function(a,b){var c=Yc(new Db(this.c,a),b);return null!=c?c.o:c};l.Kn=function(a,b){var c=Zc(new Db(this.c,a),b);return null!=c?c.o:c};l.Fa=function(a,b,c){a=this.c.De[a];b=this.c.De[b];return a&&b?rd(b,c,a):null};l.Hn=function(a,b,c){return(new Db(this.c,["obj",a[0],a[1],b,a[2],0,0,0,10,90])).ie(c)};l.Jn=function(a){return(new Db(this.c,["obj",a[0],a[1],"fix",a[2],0,0,0,10,90])).ie(null,!0)};l.Gn=function(a,b,c){return ad(new Db(this.c,["obj",a[0],a[1],b,a[2],0,0,0,10,90]),c)};
l.In=function(a){var b=this.c.va;return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]};l.Dn=function(a){return(new Db(this.c,a)).o};l.Fq=function(a,b){return Kc(new Db(this.c,a),b).o};l.Io=function(a){return vc(new Db(this.c,a))};l.Hq=function(a,b){return Uc(new Db(this.c,a),b).o};l.Ko=function(a){return(new Db(this.c,a)).o[4]};l.Iq=function(a,b){return(new Db(this.c,a)).setOrientation(b).o};l.Mo=function(a){return(new Db(this.c,a)).Tb()};l.Jq=function(a,b){return Wc(new Db(this.c,a),b).o};
l.No=function(a){return(new Db(this.c,a)).o[8]};l.Gq=function(a,b){return Vc(new Db(this.c,a),b)};l.Jo=function(a){return(new Db(this.c,a)).Nd()};l.Oo=function(a){return(new Db(this.c,a)).o[0]};l.Lo=function(a){return(new Db(this.c,a)).o[3]};l.Ho=function(a,b){return(new Db(this.c,a)).ie(b)};l.Go=function(a,b){return $c(new Db(this.c,a),b)};l.Ep=function(a,b,c,d){return Xc(new Db(this.c,a),b,c,d)};l.Yc=function(a,b){return this.c.Yc(a,sd(this.c,a,b))};l.Qi=function(a,b,c){return this.c.Pr(a,b,c)};
l.Ni=function(a,b){return this.c.Ni(a,b)};l.Rf=function(){var a=this.c.N;return{"projection-matrix":a.Xd.slice(),"view-matrix":a.ef.slice(),"view-projection-matrix":a.og.slice(),"rotation-matrix":a.mf.slice(),position:this.c.va.slice(),vector:this.c.Ed.slice()}};l.kp=function(a){var b;a:{b=this.c.N;var c=this.c.va;b.Ba&&b.update();a=c?[a[0]-c[0],a[1]-c[1],a[2]-c[2],1]:[a[0],a[1],a[2],1];for(c=0;6>c;c++)if(0>q.xf.eb(b.zc[c],a)){b=!1;break a}b=!0}return b};
l.jp=function(a){return this.c.N.Pc({K:a[0],ea:a[1]},this.c.va)};l.to=function(a,b,c){a=new Db(this.c,a);b=new Db(this.c,b);return(new td(this.c,a,b,c)).Li()};S.prototype.pc=function(a){this.c.pc(a);return this};l=Y.prototype;l.ec=function(a,b){this.c.ec(a,b);return this};l.Wc=function(a){return this.c.Wc(a,value_)};l.xq=function(){pc(this.c);return this};l.Mg=function(a,b,c){this.c.Mg(a,b,c);return this};l.Fj=function(a,b){this.c.Fj(a,b);return this};l.Ej=function(a,b){this.c.Ej(a,b);return this};
l.Wj=function(a){this.c.Wj(a);return this};l.ck=function(a,b){this.c.ck(a,b);return this};l.Ui=function(a){return this.c.Ui(a)};l.Eq=function(a){this.c.Ah=a;return this};l.Do=function(){return this.c.Ah};l.Bo=function(){return this.c.Ub};l.Si=function(a,b,c,d){return this.c.Si(a,b,c,d)};l.Ve=function(a,b){return this.c.Ve(a,b)};
l.getStats=function(){return{bestMeshTexelSize:this.c.Pg,bestGeodataTexelSize:this.c.Gk,downloading:this.c.Xb.Tc.length,lastDownload:this.c.Xb.gg,surfaces:this.c.sb.Ge.length,freeLayers:this.c.Of.length,texelSizeFit:this.c.Ag,loadMode:this.c.h.Fh,drawnTiles:this.c.u.Id}};q.Cr=Db;Y.prototype.setPosition=Y.prototype.setPosition;Y.prototype.getPosition=Y.prototype.Od;Y.prototype.setView=Y.prototype.qf;Y.prototype.getView=Y.prototype.Xi;Y.prototype.getCredits=Y.prototype.Pi;
Y.prototype.getCurrentCredits=Y.prototype.zo;Y.prototype.getCreditInfo=Y.prototype.yo;Y.prototype.getViews=Y.prototype.So;Y.prototype.getViewInfo=Y.prototype.Ro;Y.prototype.getBoundLayers=Y.prototype.Oi;Y.prototype.getBoundLayerInfo=Y.prototype.ql;Y.prototype.getFreeLayers=Y.prototype.Ri;Y.prototype.getFreeLayerInfo=Y.prototype.Ao;Y.prototype.getSurfaces=Y.prototype.Wi;Y.prototype.getSurfaceInfo=Y.prototype.Qo;Y.prototype.getSrses=Y.prototype.Vi;Y.prototype.getSrsInfo=Y.prototype.Pd;
Y.prototype.getReferenceFrame=Y.prototype.Po;Y.prototype.convertPositionViewMode=Y.prototype.Ln;Y.prototype.convertPositionHeightMode=Y.prototype.Kn;Y.prototype.convertCoords=Y.prototype.Fa;Y.prototype.convertCoordsFromNavToCanvas=Y.prototype.Hn;Y.prototype.convertCoordsFromPhysToCanvas=Y.prototype.Jn;Y.prototype.convertCoordsFromNavToCameraSpace=Y.prototype.Gn;Y.prototype.convertCoordsFromPhysToCameraSpace=Y.prototype.In;Y.prototype.clonePosition=Y.prototype.Dn;Y.prototype.setPositionCoords=Y.prototype.Fq;
Y.prototype.getPositionCoords=Y.prototype.Io;Y.prototype.setPositionHeight=Y.prototype.Hq;Y.prototype.getPositionHeight=Y.prototype.Ko;Y.prototype.setPositionOrientation=Y.prototype.Iq;Y.prototype.getPositionOrientation=Y.prototype.Mo;Y.prototype.setPositionViewExtent=Y.prototype.Jq;Y.prototype.getPositionViewExtent=Y.prototype.No;Y.prototype.setPositionFov=Y.prototype.Gq;Y.prototype.getPositionFov=Y.prototype.Jo;Y.prototype.getPositionViewMode=Y.prototype.Oo;Y.prototype.getPositionHeightMode=Y.prototype.Lo;
Y.prototype.getPositionCanvasCoords=Y.prototype.Ho;Y.prototype.getPositionCameraCoords=Y.prototype.Go;Y.prototype.movePositionCoordsTo=Y.prototype.Ep;Y.prototype.getSurfaceHeight=Y.prototype.Yc;Y.prototype.getDistance=Y.prototype.Qi;Y.prototype.getAzimuthCorrection=Y.prototype.Ni;Y.prototype.getCameraInfo=Y.prototype.Rf;Y.prototype.isPointInsideCameraFrustum=Y.prototype.kp;Y.prototype.isBBoxInsideCameraFrustum=Y.prototype.jp;Y.prototype.generateTrajectory=Y.prototype.to;
Y.prototype.setConfigParam=Y.prototype.ec;Y.prototype.getConfigParam=Y.prototype.Wc;Y.prototype.redraw=Y.prototype.xq;Y.prototype.addRenderSlot=Y.prototype.Mg;Y.prototype.moveRenderSlotBefore=Y.prototype.Fj;Y.prototype.moveRenderSlotAfter=Y.prototype.Ej;Y.prototype.removeRenderSlot=Y.prototype.Wj;Y.prototype.setRenderSlotEnabled=Y.prototype.ck;Y.prototype.getRenderSlotEnabled=Y.prototype.Ui;Y.prototype.setLoaderSuspended=Y.prototype.Eq;Y.prototype.getLoaderSuspended=Y.prototype.Do;
Y.prototype.getGpuCache=Y.prototype.Bo;Y.prototype.getHitCoords=Y.prototype.Si;Y.prototype.getScreenRay=Y.prototype.Ve;Y.prototype.getStats=Y.prototype.getStats;function Ib(a,b){this.c=a;this.Oh=b||1;this.ki=0;this.Nh=2*this.Oh;this.hl=.95;this.hf=[[],[]];this.Tg=0;this.Tc=[];this.Re=[];this.gg=0;ud(this)}function ud(a){a.Oh=a.c.h.Dh;a.Nh=Math.max(20,2*a.Oh);a.hl=(a.Nh-1)/a.Nh}l=Ib.prototype;
l.load=function(a,b,c,d,e){var g=this.Tc.indexOf(a);if(-1==g){var f=this.hf[this.Tg],g=rc(f,a);-1!=g?f[g].mc=c:f.unshift({f:a,Kk:b,mc:c||0,H:d,uh:e});do for(c=!0,a=0,b=f.length-1;a<b;a++)f[a].mc>f[a+1].mc&&(c=f[a],f[a]=f[a+1],f[a+1]=c,c=!1);while(!c);f.length>this.Nh&&f.pop()}};l.remove=function(a){a=rc(this.hf[this.Tg],a);-1!=a&&this.hf[this.Tg].splice(a,1)};
l.Pb=function(a){var b=this.Tc.indexOf(a.f),c=performance.now(),d=this.c.u;this.c.w.ek&&(this.c.w.Ec.push({fd:a.f,uh:a.uh,H:a.H,mc:a.mc,lr:c,ka:c-this.Re[b],hp:c-this.gg,Zq:this.Tc.length}),Number.isNaN(c-this.Re[b]));this.Tc.splice(b,1);this.Re.splice(b,1);this.gg=c;this.ki--;pc(this.c);this.update();d.Vl++;d.yh=c};
l.Ob=function(a){var b=this.Tc.indexOf(a.f),c=performance.now(),d=this.c.u;this.c.w.ek&&this.c.w.Ec.push({fd:a.f,uh:a.uh,H:a.H,mc:a.mc,lr:c,ka:c-this.Re[b],hp:c-this.gg,Zq:this.Tc.length});this.Tc.splice(b,1);this.Re.splice(b,1);this.gg=c;this.ki--;pc(this.c);this.update();d.Ul++;d.yh=c};
l.update=function(){for(var a=this.hf.length-1;0<=a;a--)if(0<this.hf[a].length){a=this.hf[a];ud(this);for(var b=0,c=a.length;b<c;b++)a[b].mc*=this.hl;for(b=performance.now();0<a.length&&this.ki<this.Oh;)c=a.shift(),-1==this.Tc.indexOf(c.f)&&null!=c.Kk&&(this.Tc.push(c.f),this.Re.push(b),this.ki++,c.Kk(c.f,this.Pb.bind(this,c),this.Ob.bind(this,c)));break}};
Cb.prototype.Yc=function(a,b,c){var d=vd(this,a),e=d[0],d=d[1];this.h.bf||(b=Math.floor(b));if(this.h.vj)return wd(this,a,b+8,c,b);var g=this.sb;if(null!=e&&null!==b){var f={Pk:d,Jf:Math.ceil(b),la:{ca:e.la.ca.slice(),oa:e.la.oa.slice()},B:null,gb:null,Xf:null,qr:!0};xd(g,yd(g,e.f),f,!1);e=f.B;if(null!=f.gb)return c&&(this.u.Yi=2,this.u.Zi=b,this.u.$i=e.f[0]),this.h.bf&&0<e.f[0]&&f.sa&&f.sa.gb&&b<=e.f[0]?(a=zd(d,f.sa.B,f.sa),a+=(zd(d,e,f)-a)*(b-Math.floor(b))):a=zd(d,e,f),[a,e.f[0]>=Math.ceil(b),
!0];if(null!=e)return a=wd(this,a,b+8,c,b),[a[0],a[1],!0]}return[0,!1,!1]};
function wd(a,b,c,d,e,g){if(g)b=g[0],f=g[1];else{f=vd(a,b);b=f[0];var f=f[1]}a.h.bf||(c=Math.floor(c));if(!g&&a.h.uj){g=wd(a,null,c,d,e,[b,[f[0],f[1],f[2]]]);if(g[2]){var k=g[3].oa[0]-g[3].ca[0],h=g[3].oa[1]-g[3].ca[1],m=(f[0]-g[3].ca[0])/k,n=(f[1]-g[3].ca[1])/h,p=wd(a,null,c,d,e,[b,[f[0]+k,f[1],f[2]]]),t=wd(a,null,c,d,e,[b,[f[0],f[1]+h,f[2]]]);c=wd(a,null,c,d,e,[b,[f[0]+k,f[1]+h,f[2]]]);a=g[0]+(p[0]-g[0])*m;c=a+(t[0]+(c[0]-t[0])*m-a)*n;return[c,g[1],g[2],g[3]]}return[g[0],g[1],g[2],g[3]]}m=a.sb;
if(null!=b&&null!==c&&(g={Pk:f,Jf:Math.ceil(c),la:{ca:b.la.ca.slice(),oa:b.la.oa.slice()},B:null,gb:null,Xf:null,qr:!0},xd(m,yd(m,b.f),g,!0),b=g.B,null!=b))return f=b.v.Sg(),f=a.Fa(f,"physical","navigation"),d&&(a.u.Yi=1,a.u.Zi=e,a.u.$i=b.f[0]),a.h.bf&&0<b.f[0]&&g.sa&&g.sa.B?(a=a.Fa(g.sa.B.v.Sg(),"physical","navigation"),c=f[2]+(a[2]-f[2])*(c-Math.floor(c)),[c,!0,!0,g.la,b]):[f[2],!0,!0,g.la,b];d&&(a.u.Yi=0,a.u.Zi=e,a.u.$i=0);return[0,!1,!1,null]}
function zd(a,b,c){var d=c.gb,e=d.md,g=d.nh;c=c.Xf;var f=a[0]-c.ca[0];a=c.oa[1]-a[1];f=f/(c.oa[0]-c.ca[0])*(g[0]-1);a=a/(c.oa[1]-c.ca[1])*(g[1]-1);c=Math.floor(f);var d=Math.floor(a),f=f-c,k=d*g[0],g=k+g[0],h=e[4*(k+c)],m=e[4*(g+c)],k=h+(e[4*(k+c+1)]-h)*f,e=k+(m+(e[4*(g+c+1)]-m)*f-k)*(a-d);return e=b.rd+e/255*(b.ad-b.rd)}
function vd(a,b){for(var c=a.Cb.Hd.ua,d=null,e=-1,g=[0,0],f=0,k=c.length;f<k;f++){var h=c[f],m=rd(h.Mm,b,$b(h.c)),n=h.la;m[0]>=n.ca[0]&&m[0]<=n.oa[0]&&m[1]>=n.ca[1]&&m[1]<=n.oa[1]&&h.f[0]>e&&(d=h,e=h.f[0],g=m)}return[d,g]}function sd(a,b,c){a=vd(a,b)[0];return null!=a?(c=Math.log((a.la.oa[1]-a.la.ca[1])/c)/Math.log(2),c=c-8+a.f[0],Math.max(0,c)):null}function uc(a,b,c,d){a=vd(a,b)[0];return null!=a?(c=Math.log(d*(a.la.oa[1]-a.la.ca[1])/c)/Math.log(2),c=c-8+a.f[0],Math.max(0,c)):null}
Cb.prototype.Qi=function(a,b,c){var d=rd(this.Cb.Nb.xe,a,$b(this)),e=rd(this.Cb.Nb.xe,b,$b(this)),g=e[0]-d[0],f=e[1]-d[1],e=e[2]-d[2],d=c?Math.sqrt(g*g+f*f+e*e):Math.sqrt(g*g+f*f),k=$b(this).Pd();if(Zb($b(this)))return[d,q.Vk(Math.atan2(f,g))];a=sc(this).Inverse(a[1],a[0],b[1],b[0]);return d>2*k.a*Math.PI/4007.5?c?[Math.sqrt(a.s12*a.s12+e*e),a.Gr]:[a.s12,a.azi1]:[d,a.azi1]};function sc(a){a=$b(a).Pd();return new GeographicLib.Geodesic.Geodesic(a.a,a.a/a.b-1)}
function td(a,b,c,d){this.c=a;this.Ic=b.clone();this.Wd=c.clone();this.Pp=c.clone();a=this.Ic.o[3];b=this.Wd.o[3];"fix"==a&&"float"==b?Zc(this.Ic,"float"):"float"==a&&"fix"==b&&Zc(this.Ic,"fix");a=this.Ic.o[0];b=this.Wd.o[0];"subj"==a&&"obj"==b?Yc(this.Wd,"subj"):"obj"==a&&"subj"==b&&Yc(this.Ic,"subj");this.Ic.o[5]=0>this.Ic.o[5]?360+this.Ic.o[5]%360:this.Ic.o[5]%360;this.Wd.o[5]=0>this.Wd.o[5]?360+this.Wd.o[5]%360:this.Wd.o[5]%360;this.zb=this.Ic.clone();this.df=d.mode||"auto";this.Uq="none";this.ad=
d.maxHeight||1E9;this.Mh=d.maxDuration||1E4;this.zm=d.samplePeriod||10;this.vq=d.pv||.15;Zb($b(this.c))||(this.pl=sc(this.c));d.distanceAzimuth?(this.zi=!0,this.mb=this.Ic.clone(),d.destHeight&&Uc(this.mb,d.destHeight),d.destOrientation&&Uc(this.mb,d.destOrientation),d.destFov&&Uc(this.mb,d.destFov),this.dh=d.azimuth||0,this.xa=this.Mi=d.distance||100,this.lb=this.dh%360,this.lb=0>this.lb?360+this.lb:this.lb):(this.zi=!1,this.mb=this.Wd.clone(),a=this.c.Qi(vc(this.zb),vc(this.mb)),this.xa=a[0],this.lb=
(a[1]-90)%360,this.lb=0>this.lb?360+this.lb:this.lb,Zb($b(this.c))||(a=this.pl.Inverse(this.zb.o[2],this.zb.o[1],this.mb.o[2],this.mb.o[1]),this.dh=a.azi1,this.Mi=a.s12,this.lb=this.dh%360,this.lb=0>this.lb?360+this.lb:this.lb));"auto"==this.df&&(this.df=2E3<this.xa?"ballistic":"direct");this.ka=0;this.Jb=1E3;500>this.xa?this.ka=1E3:2E3>this.xa?this.ka=2E3:(this.ka=this.xa/100,300>this.ka?this.ka=3E3:this.Jb=1500,6E3>this.ka&&(this.ka=6E3),1E4<this.ka&&(this.ka=1E4),"direct"!=this.df&&(this.ka*=1.8,
this.Jb*=1.8));"direct"!=this.df&&(a=3*this.Jb,this.ka=Math.max(this.ka,a),this.Mh<a&&(this.ka=this.Mh,this.Jb=this.Mh/3));this.ka=Math.min(this.ka,this.Mh);d=d.height;"ballistic"==this.df&&(this.he=Math.max(this.zb.o[4],this.mb.o[4]),this.he+=d||.5*this.xa,this.he=Math.min(this.he,this.ad),this.he-=Math.max(this.zb.o[4],this.mb.o[4]))}
td.prototype.Li=function(){for(var a=Array(Math.ceil(this.ka/this.zm)+(this.zi?0:1)),b=0,c=0;c<=this.ka;c+=this.zm){var d=c/this.ka,e=this.zb.clone();if("direct"==this.df){Kc(e,Ad(this,d));var g=this.zb.o[4];Uc(e,g+(this.mb.o[4]-g)*d);e.setOrientation(Qd(this.zb.Tb(),this.mb.Tb(),d));Vc(e,Rd(this,d));Wc(e,Sd(this,d))}else{d=d*d*(3-2*d);d=d*d*(3-2*d);g=c<this.Jb?0:c>this.ka-this.Jb?1:Math.min(1,(c-this.Jb)/(this.ka-2*this.Jb));g=g*g*(3-2*g);factor2_=g*g*(3-2*g);if("piha"==this.Uq){var g=vc(this.zb)[2],
f=this.xa/(.001*this.ka*this.vq*Math.tan(.5*q.Ka(this.zb.Nd())))*(1-Math.cos(2*Math.PI*c/this.ka))+g+(vc(this.mb)[2]-g)*c/this.ka,g=Ad(this,this.xa/this.ka*(c-this.ka/(2*Math.PI)*Math.sin(2*Math.PI/this.ka*c))/this.xa);Kc(e,g);Uc(e,f)}else g=Ad(this,factor2_),Kc(e,g),f=vc(this.zb),Uc(e,f[2]+(vc(this.mb)[2]-f[2])*d+Math.sin(Math.PI*d)*this.he);null!=g[3]&&(this.lb=g[3]);var g=c,f=[0,-90,0],k;f[0]=this.lb%360;0>f[0]&&(f[0]=360-Math.abs(f[0]));g<=this.Jb?(k=g/this.Jb,g=this.zb.Tb()):g>=this.ka-this.Jb?
(k=(g-(this.ka-this.Jb))/this.Jb,g=f,f=this.mb.Tb()):(k=0,g=f);e.setOrientation(Qd(g,f,k));Vc(e,Rd(this,d));Wc(e,Sd(this,d));a[b]=e.o}a[b]=e.o;b++}this.zi||(a[b]=this.Pp.clone().o);return a};function Ad(a,b){var c=vc(a.zb),d=vc(a.mb);if(Zb($b(a.c)))return[c[0]+(d[0]-c[0])*b,c[1]+(d[1]-c[1])*b,c[2]+(d[2]-c[2])*b];var e=a.pl.Direct(c[1],c[0],a.dh,a.Mi*b),g=e.azi1-e.azi2,g=0>a.lb?360+g:g;return[e.lon2,e.lat2,c[2]+(d[2]-c[2])*b,g]}
function Qd(a,b,c){var d=b[0]-a[0],e=b[1]-a[1];b=b[2]-a[2];180<Math.abs(d)&&(d=0<d?-(360-d):360-Math.abs(d));return[a[0]+d*c,a[1]+e*c,a[2]+b*c]}function Rd(a,b){var c=a.zb.Nd();return c+(a.mb.Nd()-c)*b}function Sd(a,b){var c=a.zb.o[8];return c+(a.mb.o[8]-c)*b}
function Vb(a,b,c){this.c=a;this.u=a.u;this.f=b;this.Ta=this.fd=null;this.Sb=this.s=this.I=0;"object"===typeof c?(this.Ta=c,this.I=2):(this.fd=this.c.rb(c),q.Zc(this.fd,this.Pb.bind(this),this.Ob.bind(this),null,q.useCredentials?-1!=this.fd.indexOf(this.c.Aa):!1,this.c.C.ub),this.I=1)}l=Vb.prototype;l.D=function(){};l.setData=function(a){this.Ta=a;this.I=2};l.U=function(a,b){if(2==this.I)return!0;0!=this.I||a||this.ob(b);return!1};l.ob=function(a){this.c.Xb.load(this.fd,this.Hc.bind(this),a)};
l.Hc=function(){this.I=1};l.Ob=function(){};l.Pb=function(a){1!=this.c.R&&(this.Ta=a,this.I=2)};l.size=function(){return this.s};l.fileSize=function(){return this.Sb};function ed(a,b,c){this.c=a;this.u=a.u;this.La=b;this.Qa=c;this.v=new Ga;this.Sb=this.s=0;this.X=this.Va=null;this.I=0;this.Ia=null;this.ra=0}l=ed.prototype;l.D=function(){this.v=null;this.Pl()};l.Pl=function(a){this.Va&&(this.Va=null);1!=a&&null!=this.X&&this.c.oc.remove(this.X);this.Sb=this.s=this.I=0;this.X=null};
l.U=function(a,b){var c=this.c.u.wb>=this.c.qe;a=a||c;if(2==this.I)return Ic(this.c.oc,this.X),!0;0==this.I?a||this.ob(b):3==this.I&&this.ra<=this.c.h.jc&&performance.now()>this.Ia+this.c.h.kc&&this.ob(b);return!1};l.ob=function(a){this.c.Xb.load(this.La,this.Hc.bind(this),a,this.Qa.H,"geodata")};l.Hc=function(a,b,c){this.lc=b;this.Fc=c;this.I=1;q.Zc(a,this.Pb.bind(this),this.Ob.bind(this),!0,q.useCredentials?-1!=this.La.indexOf(this.c.Aa):!1,this.c.C.ub)};
l.Ob=function(){this.c.R||(this.I=3,this.Ia=performance.now(),this.ra++,this.ra<=this.c.h.jc&&setTimeout(function(){this.c.R||pc(this.c)}.bind(this),this.c.h.kc),this.Fc())};l.Pb=function(a){if(!this.c.R){var b=a.length;this.Sb=this.s=b;this.Va=a;this.X=Jc(this.c.oc,this.Pl.bind(this,!0),b);pc(this.c);this.I=2;this.Ia=null;this.ra=0;this.lc()}};l.size=function(){return this.s};l.fileSize=function(){return this.Sb};
function fd(a,b,c){this.c=a;this.u=a.u;this.Va=b;this.j=this.c.l.j;this.l=this.c.l;this.Ye=[];this.Qe=null;this.H=c.H;this.A=c.A;this.A.Ld?this.A.gk&&(xc(this.A.Ld,"setStylesheet",{data:this.A.$d.Ta,geocent:!Zb($b(this.c))}),this.A.gk=!1):(a=new q.Kg(this,this.lm.bind(this)),xc(a,"setStylesheet",{data:this.A.$d.Ta,geocent:!Zb($b(this.c))}),xc(a,"setFont",{chars:this.l.Vc.jd,space:this.l.Vc.rf,size:this.l.Vc.s}),this.A.Ld=a);this.Ld=this.A.Ld;this.s=0;this.aa=this.ej=this.R=!1;this.U()}l=fd.prototype;
l.D=function(){this.R=!0;this.Va=null;this.Ql(!1)};l.Ql=function(a){this.ej=a;for(var b=0,c=this.Ye.length;b<c;b++)this.Ye[b].D();this.Ye=[];1!=a&&null!=this.Xa&&this.c.Ub.remove(this.Xa);this.u.Uf-=this.s;this.u.Ac[1][0]++;this.u.Ac[1][1]+=this.s;this.aa=!1;this.s=0;this.Xa=null};
l.lm=function(a){if(!this.R&&!this.ej)if("string"!==typeof a&&null!=a.command)switch(a.command){case "beginGroup":this.Qe=new Fa(a.id,a.bbox,a.origin,this.j,this.l);this.Ye.push(this.Qe);break;case "addRenderJob":if(this.Qe){var b=this.Qe;switch(a.type){case "flat-line":var c=b.m,d=a.vertexBuffer,e=a.color,g=1/255,f={S:"flat-line"};f.Ja=a.program;f.Rc=[e[0]*g,e[1]*g,e[2]*g,e[3]*g];f.Af=a["z-index"]+256;f.Gf=a["click-event"];f.bg=a["hover-event"];f.$g=a["enter-event"];f.xh=a["leave-event"];f.$f=a.hitable;
f.Nf=a.eventInfo;f.xd=a.state;f.hd=a.center;f.da=a.lod;f.Tl=a["line-width"];f.Ne=a["zbuffer-offset"];f.Yd=!1;f.aa=!0;f.P=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,f.P);c.bufferData(c.ARRAY_BUFFER,d,c.STATIC_DRAW);f.P.ia=3;f.P.W=d.length/3;b.nd.push(f);b.s+=4*d.length;b.yb+=d.length/3;break;case "flat-tline":Ma(b,a);break;case "pixel-line":Ma(b,a);break;case "pixel-tline":Ma(b,a);break;case "line-label":var c=b.m,d=a.vertexBuffer,e=a.texcoordsBuffer,g=a.color,f=1/255,k={S:"line-label"};k.Ja=a.program;
k.Rc=[g[0]*f,g[1]*f,g[2]*f,g[3]*f];k.Af=a["z-index"]+256;k.Gf=a["click-event"];k.bg=a["hover-event"];k.$g=a["enter-event"];k.xh=a["leave-event"];k.$f=a.hitable;k.Nf=a.eventInfo;k.xd=a.state;k.hd=a.center;k.da=a.lod;k.Ne=a["zbuffer-offset"];k.Yd=!1;k.aa=!0;k.P=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,k.P);c.bufferData(c.ARRAY_BUFFER,d,c.STATIC_DRAW);k.P.ia=4;k.P.W=d.length/4;k.tb=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,k.tb);c.bufferData(c.ARRAY_BUFFER,e,c.STATIC_DRAW);k.tb.ia=4;k.tb.W=e.length/
4;b.nd.push(k);b.s+=4*d.length+4*e.length;b.yb+=d.length/4;break;case "icon":Oa(b,a);break;case "label":Oa(b,a,!0);break;case "optimize":b.cs(a)}}break;case "endGroup":this.Qe&&(this.s+=this.Qe.size())}else switch(a){case "allProcessed":pc(this.c);this.Xa=Jc(this.c.Ub,this.Ql.bind(this,!0),this.s);this.u.Uf+=this.s;this.u.Ac[0][0]++;this.u.Ac[0][1]+=this.s;this.aa=!0;break;case "ready":pc(this.c)}};
l.U=function(a,b,c){if(this.R)return!1;var d=this.c.u.wb>=this.c.qe;a=a||d;!this.aa&&!a&&this.Va.U(a,b,c)&&this.Ld.U()&&(this.ej=!1,this.Ld.hg=this.lm.bind(this),xc(this.Ld,"processGeodata",this.Va.Va,this.H));!a&&this.Xa&&Ic(this.c.Ub,this.Xa);return this.aa};l.We=function(a,b,c){null==c&&(c=q.i.create(),q.i.multiply(q.ed(a.K[0]-b[0],a.K[1]-b[1],a.K[2]-b[2]),q.vg(1,1,1),c));return c};
l.Ua=function(a){if(this.aa){for(var b=this.l,c=0,d=this.Ye.length;c<d;c++){var e=this.Ye[c],g=q.i.create(),f=q.i.create();q.i.multiply(pb(b.N),this.We(e.v,a),f);var k=ob(b.N);q.i.multiply(k,f,g);e.Ua(f,g);this.u.Te+=e.yb;this.u.Yg+=e.nd.length}this.xg!=this.u.tc&&(this.xg=this.u.tc,this.u.wb+=this.s)}return this.aa};l.size=function(){return this.s};
function nd(a,b,c){this.c=a;this.u=a.u;this.La=b;this.H=c;this.v=new Ga;this.Jd=this.Sb=this.s=0;this.Xa=this.X=null;this.I=0;this.Ia=null;this.ra=0;this.wp=q.i.create();this.vp=q.i.create();this.jb=[];this.hc=[];this.hk=!1}l=nd.prototype;l.D=function(){this.v=null;this.dj();this.Rl()};l.dj=function(a){for(var b=0,c=this.jb.length;b<c;b++)this.jb[b].D();this.hk=!0;1!=a&&this.X&&this.c.oc.remove(this.X);0==this.hc.length&&(this.I=0);this.X=null};
l.Rl=function(a){for(var b=0,c=0,d=this.hc.length;c<d;c++)this.hc[c].D(),b+=this.hc[c].s;0<d&&(this.u.Vf-=b,this.u.Bc[1][0]++,this.u.Bc[1][1]+=b);this.hc=[];1!=a&&this.Xa&&this.c.Ub.remove(this.Xa);this.hk&&(this.I=0);this.Xa=null};
l.U=function(a,b,c){var d=this.c.u.wb>=this.c.qe;a=a||d;if(2==this.I){this.X&&Ic(this.c.oc,this.X);if(c)return!0;if(0==this.hc.length){if(this.c.u.wb>=this.c.qe)return!1;if(this.u.Ae>this.c.h.Hh)return pc(this.c),!1;if(d)return!1;b=performance.now();c=0;this.hc=Array(this.jb.length);for(var d=0,e=this.jb.length;d<e;d++)this.hc[d]=jd(this.jb[d]),c+=this.hc[d].s;this.u.Vf+=c;this.u.Bc[0][0]++;this.u.Bc[0][1]+=c;this.Xa=Jc(this.c.Ub,this.Rl.bind(this,!0),c);this.u.Ae+=performance.now()-b}!a&&this.Xa&&
Ic(this.c.Ub,this.Xa);return!0}0==this.I?a||this.ob(b):3==this.I&&this.ra<=this.c.h.jc&&performance.now()>this.Ia+this.c.h.kc&&this.ob(b);return!1};l.ob=function(a){this.La||(this.La=Ac(this.c,this.H.Na.Ph,{da:this.H.f[0],hb:this.H.f[1],ib:this.H.f[2]}));this.c.Xb.load(this.La,this.Hc.bind(this),a,this.H,"mesh")};l.Hc=function(a,b,c){this.lc=b;this.Fc=c;q.Dc(a,this.Pb.bind(this),this.Ob.bind(this),q.useCredentials?-1!=this.La.indexOf(this.c.Aa):!1,this.c.C.ub);this.I=1};
l.Ob=function(){1!=this.c.R&&(this.I=3,this.Ia=performance.now(),this.ra++,this.ra<=this.c.h.jc&&setTimeout(function(){this.c.R||pc(this.c)}.bind(this),this.c.h.kc),this.Fc())};
l.Pb=function(a){if(1!=this.c.R){this.Sb=a.byteLength;a={Ta:a,g:0};this.dj();var b=a.Ta,c;c=""+String.fromCharCode(b.getUint8(a.g,!0));a.g+=1;c+=String.fromCharCode(b.getUint8(a.g,!0));a.g+=1;if("ME"==c&&(this.kb=b.getUint16(a.g,!0),a.g+=2,!(3<this.kb))){b.getFloat64(a.g,!0);a.g+=8;this.km=b.getUint16(a.g,!0);a.g+=2;this.jb=[];b=0;for(c=this.km;b<c;b++){var d=new Td(this,a);d.Ad&&(this.jb.push(d),this.s+=this.jb[b].s,this.Jd+=this.jb[b].Jd)}this.km=this.jb.length}this.hk=!1;this.X=Jc(this.c.oc,this.dj.bind(this,
!0),this.s);pc(this.c);this.I=2;this.Ia=null;this.ra=0;this.lc()}};l.size=function(){return this.s};l.fileSize=function(){return this.Sb};MelownMetanodeFlags_GeometryPresent=1;MelownMetanodeFlags_NavtilePresent=3;MelownMetanodeFlags_InternalTexturePresent=7;MelownMetanodeFlags_CoarsenessControl=15;MelownMetanodeFlags_ChildShift=3;
function Ud(a,b,c){this.$b=a;this.c=a.c;this.f=b;this.G=[];this.Yf=this.aa=this.Cf=!1;if(c){a=c.Ta;this.O=a.getUint8(c.g,!0);c.g+=1;var d=6*(this.f[0]+2)+7>>3;b=new Uint8Array(d);for(var e=0,g=d;e<g;e++)b[e]=a.getUint8(c.g,!0),c.g+=1;for(var g=this.f[0]+2,d=[0,0,0],f=[0,0,0],k=0,h=this.c.Qq,m=this.c.Pq,e=0;3>e;e++)d[e]=Vd(b,g,k)*h[e]+m[e],k+=g,f[e]=Vd(b,g,k)*h[e]+m[e],k+=g;e=k=0;for(g=b.length;e<g;e++)k+=b[e];0==k&&(d[0]=Number.POSITIVE_INFINITY,d[1]=Number.POSITIVE_INFINITY,d[2]=Number.POSITIVE_INFINITY,
f[0]=Number.NEGATIVE_INFINITY,f[1]=Number.NEGATIVE_INFINITY,f[2]=Number.NEGATIVE_INFINITY);this.v=new Ga(d[0],d[1],d[2],f[0],f[1],f[2]);this.oh=a.getUint8(c.g,!0);c.g+=1;this.jf=q.Sn(a.getUint16(c.g,!0));c.g+=2;a.getUint16(c.g,!0);c.g+=2;this.ee=1024;0==(this.O&4)&&(this.jf=Number.POSITIVE_INFINITY);0==(this.O&8)&&(this.ee=256);this.rd=a.getInt16(c.g,!0);c.g+=2;this.ad=a.getInt16(c.g,!0);c.g+=2;3<=this.$b.kb&&(this.$b.O&128?(this.Hm=a.getUint16(c.g,!0),c.g+=2):this.$b.O&64&&(this.Hm=a.getUint8(c.g,
!0),c.g+=1));this.Yf=0!=(this.O&2);this.Cf=!1;Wd(this)}}Ud.prototype.D=function(){};function Vd(a,b,c){for(var d=0,e=0;e<b;e++)a[c>>3]&1<<7-(c&7)&&(d|=1<<b-e-1),c++;return d/((1<<b)-1)}
Ud.prototype.clone=function(){var a=new Ud(this.$b,this.f);a.O=this.O;a.rd=this.rd;a.ad=this.ad;a.v=this.v.clone();a.oh=this.oh;a.jf=this.jf;a.ee=this.ee;a.aa=this.aa;a.Sq=this.Sq;a.Yf=this.Yf;a.G=Array(this.G.length);for(var b=0,c=this.G.length;b<c;b++)a.G[b]=this.G[b];a.vc=this.vc;a.Mf=this.Mf;a.Wg=this.Wg;a.Lf=this.Lf;a.Xg=this.Xg;a.Df=this.Df;this.Wh&&(a.Wh=this.Wh.slice());return a};
function Wd(a,b){a.aa=!0;if(!a.ml)if(a.c.h.zj){if(!b){var c,d=a.f,e=a.c.Cb.Hd.ua;c=null;for(var g=[0,0],f=0,k=e.length;f<k;f++){var h=e[f],m=d[0]-h.f[0];if(0<=m){var n=d[2]>>m;h.f[1]==d[1]>>m&&h.f[2]==n&&(c=h,g=[h.f[1]<<m,h.f[2]<<m])}}m=d[0]-c.f[0];h=1/Math.pow(2,m);e=c.la.oa;f=c.la.ca;k=(e[0]-f[0])*h;h*=f[1]-e[1];m=d[1]-g[0];d=d[2]-g[1];c=[c,[[f[0]+k*m,e[1]+h*d],[f[0]+k*(m+1),e[1]+h*(d+1)]]];var n=c[0],p=c[1][0],t=c[1][1],u=a.rd,k=[.5*(t[0]+p[0]),.5*(t[1]+p[1]),u];c=[0,0,0];a.vc=Xd(n,k);a.Xg=q.F.length(a.vc);
q.F.normalize(a.vc,c);a.Mf=c;var f=Xd(n,[t[0],t[1],u]),e=Xd(n,[t[0],p[1],u]),g=Xd(n,[p[0],p[1],u]),d=Xd(n,[p[0],t[1],u]),h=Xd(n,[.5*(t[0]+p[0]),t[1],u]),m=Xd(n,[.5*(t[0]+p[0]),p[1],u]),w=Xd(n,[p[0],.5*(t[1]+p[1]),u]),u=Xd(n,[t[0],.5*(t[1]+p[1]),u]),k=a.vc;a.Wh=[d[0],d[1],d[2],h[0],h[1],h[2],f[0],f[1],f[2],w[0],w[1],w[2],k[0],k[1],k[2],u[0],u[1],u[2],g[0],g[1],g[2],m[0],m[1],m[2],e[0],e[1],e[2]];u=a.ad;k=Xd(n,[t[0],t[1],u]);h=Xd(n,[t[0],p[1],u]);m=Xd(n,[p[0],p[1],u]);n=Xd(n,[p[0],t[1],u]);a.Df=[[f[0],
f[1],f[2]],[e[0],e[1],e[2]],[g[0],g[1],g[2]],[d[0],d[1],d[2]],k,h,m,n];q.F.normalize(f);q.F.normalize(e);q.F.normalize(g);q.F.normalize(d);f=q.F.eb(c,f);e=q.F.eb(c,e);g=q.F.eb(c,g);d=q.F.eb(c,d);d=Math.min(f,e,g,d);a.Wg=Math.cos(Math.max(0,.5*Math.PI-Math.acos(d)));a.Lf=d}}else n=a.v.K,p=a.v.ea,c=a.v.Sg(),a.vc=[c[0],c[1],c[2]],q.F.normalize(c),a.Mf=c,f=[n[0],n[1],n[2]],e=[p[0],n[1],n[2]],g=[p[0],p[1],n[2]],d=[n[0],p[1],n[2]],k=[n[0],n[1],p[2]],h=[p[0],n[1],p[2]],m=[p[0],p[1],p[2]],n=[n[0],p[1],p[2]],
q.F.normalize(f),q.F.normalize(e),q.F.normalize(g),q.F.normalize(d),q.F.normalize(k),q.F.normalize(h),q.F.normalize(m),q.F.normalize(n),f=q.F.eb(c,f),e=q.F.eb(c,e),g=q.F.eb(c,g),d=q.F.eb(c,d),d=Math.min(f,e,g,d,q.F.eb(c,k),q.F.eb(c,h),q.F.eb(c,m),q.F.eb(c,n)),a.Wg=Math.cos(Math.max(0,.5*Math.PI-Math.acos(d))),a.Lf=d,wb(a.v),d=.2*a.v.mg,a.vc=[a.vc[0]-c[0]*d,a.vc[1]-c[1]*d,a.vc[2]-c[2]*d]}
Ud.prototype.We=function(a,b){var c=b;null!=c?(c[0]=xb(this.v,0),c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=xb(this.v,1),c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=xb(this.v,2),c[11]=0,c[12]=this.v.K[0]-a[0],c[13]=this.v.K[1]-a[1],c[14]=this.v.K[2]-a[2],c[15]=1):(c=q.i.create(),q.i.multiply(q.ed(this.v.K[0]-a[0],this.v.K[1]-a[1],this.v.K[2]-a[2]),q.vg(xb(this.v,0),xb(this.v,1),xb(this.v,2)),c));return c};
Ud.prototype.Se=function(a){var b=this.c.l;b.j.useProgram(b.kf,["aPosition"]);var c=q.i.create(),d=q.i.create();q.i.multiply(pb(b.N),this.We(a),d);a=ob(b.N);q.i.multiply(a,d,c);Qa(b.kf,"uMVP",c);b.Og.Ua(b.kf,"aPosition")};
function kd(a,b,c){var d=a.c.l,e=a.c.Wp,g=a.Wh;if(g){d.j.useProgram(d.Tj,["aPosition","aTexCoord"]);var f=q.i.create();a=pb(d.N);var k=ob(d.N);q.i.multiply(k,a,f);var f=b[0],h=b[1];b=b[2];for(var m=0;9>m;m++){var n=3*m;e[n]=g[n]-f;e[n+1]=g[n+1]-h;e[n+2]=g[n+2]-b}g=d.Tj;Qa(g,"uMV",a);Qa(g,"uProj",k);eb(g,"uPoints",e);c=Math.log(Math.max(10,c.xa+20))/Math.log(8);c-=Math.floor(c);Pa(g,"uParams",[4,0,1/15,8]);Pa(g,"uParams2",[0,0,c,0]);d.j.bindTexture(d.Zf);d.Yp.Ua(d.Tj,"aPosition","aTexCoord")}}
function Hc(a,b,c){this.qb=a;this.c=a.c;this.A=b;this.f=a.f;this.H=c;this.ua=[];this.I=this.Hb=0;this.Ia=null;this.s=this.ra=0;this.X=null}l=Hc.prototype;l.D=function(a){1!=a&&null!=this.X&&this.c.Gc.remove(this.X);this.qb&&Fc(this.qb,this);this.A=this.I=0;this.X=null;this.ua=[]};
l.clone=function(a){a=new Hc(this.qb,a);a.ua=this.ua;a.I=this.I;a.ua=this.ua;a.s=this.s;a.da=this.da;a.re=this.re;a.se=this.se;a.td=this.td;a.ud=this.ud;a.pa=this.pa;a.$a=this.$a;a.kb=this.kb;a.G=this.G;2>this.kb?a.rg=this.rg:(a.O=this.O,a.uc=this.uc,a.yc=this.yc);a.X=Jc(this.c.Gc,a.D.bind(a,!0),a.s);return a};l.U=function(a){if(2==this.I)return!0;0==this.I&&(3==this.I?this.ra<=this.c.h.jc&&performance.now()>this.Ia+this.c.h.kc&&this.ob(a):this.ob(a));return!1};
l.uk=function(){null!=this.X&&Ic(this.c.Gc,this.X)};l.Sf=function(a){var b=a[1]-this.f[1]-this.td;a=a[2]-this.f[2]-this.ud;if(0>b||0>a||b>=this.pa||a>=this.$a)return null;b=this.ua[this.pa*a+b];b.aa||(Wd(b),b.aa=!0);return b};l.ob=function(){null==this.La&&(this.La=this.A.fh(this.f));this.c.Xb.load(this.La,this.Hc.bind(this),null,this.H,"metatile")};
l.Hc=function(a,b,c){this.lc=b;this.Fc=c;q.Dc(a,this.Pb.bind(this),this.Ob.bind(this),q.useCredentials?-1!=this.La.indexOf(this.c.Aa):!1,this.c.C.ub);this.I=1};l.Ob=function(){1!=this.c.R&&(this.I=3,this.Ia=performance.now(),this.ra++,this.ra<=this.c.h.jc&&setTimeout(function(){this.c.R||pc(this.c)}.bind(this),this.c.h.kc),this.Fc())};
l.Pb=function(a){1!=this.c.R&&(this.s+=4*a.byteLength,this.Nj({Ta:a,g:0}),this.X=Jc(this.c.Gc,this.D.bind(this,!0),this.s),pc(this.c),this.I=2,this.Ia=null,this.ra=0,this.lc())};
l.Nj=function(a){var b=a.Ta,c;c=""+String.fromCharCode(b.getUint8(a.g,!0));a.g+=1;c+=String.fromCharCode(b.getUint8(a.g,!0));a.g+=1;"MT"==c&&(this.kb=b.getUint16(a.g,!0),a.g+=2,3<this.kb||(this.da=b.getUint8(a.g,!0),a.g+=1,this.re=b.getUint32(a.g,!0),a.g+=4,this.se=b.getUint32(a.g,!0),a.g+=4,this.td=b.getUint16(a.g,!0),a.g+=2,this.ud=b.getUint16(a.g,!0),a.g+=2,this.pa=b.getUint16(a.g,!0),a.g+=2,this.$a=b.getUint16(a.g,!0),a.g+=2,this.yc=Array(8),2>this.kb?(this.rg=b.getUint8(a.g,!0),a.g+=1):(this.O=
b.getUint8(a.g,!0),a.g+=1,this.uc=b.getUint8(a.g,!0),a.g+=1,this.Mj(a)),this.Oj(a),this.Pj(a)))};l.Mj=function(a){for(var b=a.Ta,c=this.pa*this.$a+7>>3,d=0;6>d;d++)if(0!=(this.O&1<<d)){for(var e=new Uint8Array(c),g=0;g<c;g++)e[g]=b.getUint8(a.g,!0),a.g+=1;this.yc[d]=e}};
l.Oj=function(a){var b=a.Ta;2>this.kb&&(this.uc=b.getUint8(a.g,!0),a.g+=1,b.getUint16(a.g,!0),a.g+=2);if(0==this.uc)this.G=[];else{var c=this.pa*this.$a+7>>3;this.G=Array(this.uc);for(var d=0,e=this.G.length;d<e;d++){var g=b.getUint16(a.g,!0);a.g+=2;for(var f=new Uint8Array(c),k=0;k<c;k++)f[k]=b.getUint8(a.g,!0),a.g+=1;g=this.c.wi[g];this.G[d]={ui:g?g.Ol:null,vi:f}}}};
l.ni=function(){for(var a=0;1>a;a++)if(this.yc[a]){bitplane_=this.yc[a];for(var b=0;b<this.$a;b++)for(var c=0;c<this.pa;c++){var d=this.pa*b+c,e=1<<(d&7),d=d>>3;if(bitplane_[d]&e)switch(a){case 0:this.ua[b*this.pa+c].Cf=!0}}}};l.oi=function(){for(var a=0;a<this.$a;a++)for(var b=0;b<this.pa;b++)for(var c=this.pa*a+b,d=1<<(c&7),c=c>>3,e=0,g=this.G.length;e<g;e++)if(this.G[e].vi[c]&d){var f=this.G[e].ui;f&&this.ua[a*this.pa+b].G.push(f)}};
l.Pj=function(a){this.ua=Array(this.pa*this.$a);for(var b=0,c=0;c<this.$a;c++)for(var d=0;d<this.pa;d++)this.ua[b]=new Ud(this,[this.da,this.re+this.td+d,this.se+this.ud+c],a),b++;this.oi();this.ni()};function Yd(a,b,c,d,e){this.c=a;this.f=b;this.Mm=lc(this.c,c);this.la=d;this.mh=e}function Xd(a,b){return Zd(a.Mm,b,a.c.Cb.Nb.xe)}
function Sb(a,b){this.c=a;this.Bb=a.Bb;this.Ad=!1;this.f=b.id||null;this.Wk=b.description||"";var c=b.model;if(null!=c&&(this.Nb={xe:lc(this.c,c.physicalSrs),Th:lc(this.c,c.navigationSrs),Vj:lc(this.c,c.publicSrs)},this.gf={},null!=b.parameters&&(c=b.parameters,this.gf.Qh=c.metaBinaryOrder||1,this.gf.hm=c.navDelta||8),c=b.division,null!=c)){this.Hd={js:c.rootLod||0,Er:c.arity||null,mh:c.heightRange||[0,1]};var d;d=c.extents;d=null==d?{ca:[0,0,0],oa:[1,1,1]}:{ca:d.ll||[0,0,0],oa:d.ur||[1,1,1]};this.Hd.la=
d;this.c.Qq=[d.oa[0]-d.ca[0],d.oa[1]-d.ca[1],d.oa[2]-d.ca[2]];this.c.Pq=d.ca;c=c.nodes;this.Hd.ua=[];if(null!=c){d=0;for(var e=c.length;d<e;d++){var g;var f=c[d],k;g=f.srs;var h;h=f.extents;h=null==h?{ca:[0,0],oa:[1,1]}:{ca:h.ll||[0,0],oa:h.ur||[1,1]};k=f.id;null!=k?(f=k.lod||0,k=k.position||[0,0],g=new Yd(this.c,[f,k[0],k[1]],g,h,this.mh)):g=void 0;this.Hd.ua.push(g)}this.Ad=!0}}}Sb.prototype.Ib=function(){return{physicalSrs:this.Nb.xe.f,navigationSrs:this.Nb.Th.f,publicSrs:this.Nb.Vj.f}};
Sb.prototype.Fa=function(a,b,c){var d,e;switch(b){case "public":d=this.Nb.Vj;break;case "physical":d=this.Nb.xe;break;case "navigation":d=this.Nb.Th}switch(c){case "public":e=this.Nb.Vj;break;case "physical":e=this.Nb.xe;break;case "navigation":e=this.Nb.Th}return Zd(d,a,e)};l=Cb.prototype;l.Mg=function(a,b,c){this.nb.push({id:a,Lk:b,Hi:c})};l.Fj=function(a,b){var c=rc(this.nb,"after-map-render"==a?"map":a),d=rc(this.nb,b);-1!=c&&-1!=d&&this.nb.splice(d,0,this.nb.splice(c,1)[0])};
l.Ej=function(a,b){var c=rc(this.nb,"after-map-render"==a?"map":a),d=rc(this.nb,b);-1!=c&&-1!=d&&(d++,this.nb.splice(d,0,this.nb.splice(c,1)[0]))};l.Wj=function(){var a=rc(this.nb,id2_);-1!=a&&this.nb.splice(a,1)};l.ck=function(a,b){var c=rc(this.nb,a);-1!=c&&(this.nb[c].Hi=b)};l.Ui=function(){var a=rc(this.nb,id2_);return-1!=a?this.nb[a].Hi:!1};function tc(a){1!=a.Uc&&ta(a.l.j);for(var b=0,c=a.nb.length;b<c;b++){var d=a.nb[b];d.Hi&&d.Lk&&d.Lk(a.Wn[a.Uc])}}
Hc=function(a,b,c){this.qb=a;this.c=a.c;this.A=b;this.f=a.f;this.H=c;this.ua=[];this.I=this.Hb=0;this.Ia=null;this.s=this.ra=0;this.X=null};l=Hc.prototype;l.D=function(a){1!=a&&null!=this.X&&this.c.Gc.remove(this.X);this.qb&&Fc(this.qb,this);this.A=this.I=0;this.X=null;this.ua=[]};
l.clone=function(a){a=new Hc(this.qb,a);a.ua=this.ua;a.I=this.I;a.ua=this.ua;a.s=this.s;a.da=this.da;a.re=this.re;a.se=this.se;a.td=this.td;a.ud=this.ud;a.pa=this.pa;a.$a=this.$a;a.kb=this.kb;a.G=this.G;2>this.kb?a.rg=this.rg:(a.O=this.O,a.uc=this.uc,a.yc=this.yc);a.X=Jc(this.c.Gc,a.D.bind(a,!0),a.s);return a};l.U=function(a){if(2==this.I)return!0;0==this.I&&(3==this.I?this.ra<=this.c.h.jc&&performance.now()>this.Ia+this.c.h.kc&&this.ob(a):this.ob(a));return!1};
l.uk=function(){null!=this.X&&Ic(this.c.Gc,this.X)};l.Sf=function(a){var b=a[1]-this.f[1]-this.td;a=a[2]-this.f[2]-this.ud;if(0>b||0>a||b>=this.pa||a>=this.$a)return null;b=this.ua[this.pa*a+b];b.aa||(Wd(b),b.aa=!0);return b};l.ob=function(){null==this.La&&(this.La=this.A.fh(this.f));this.c.Xb.load(this.La,this.Hc.bind(this),null,this.H,"metatile")};
l.Hc=function(a,b,c){this.lc=b;this.Fc=c;q.Dc(a,this.Pb.bind(this),this.Ob.bind(this),q.useCredentials?-1!=this.La.indexOf(this.c.Aa):!1,this.c.C.ub);this.I=1};l.Ob=function(){1!=this.c.R&&(this.I=3,this.Ia=performance.now(),this.ra++,this.ra<=this.c.h.jc&&setTimeout(function(){this.c.R||pc(this.c)}.bind(this),this.c.h.kc),this.Fc())};
l.Pb=function(a){1!=this.c.R&&(this.s+=4*a.byteLength,this.Nj({Ta:a,g:0}),this.X=Jc(this.c.Gc,this.D.bind(this,!0),this.s),pc(this.c),this.I=2,this.Ia=null,this.ra=0,this.lc())};
l.Nj=function(a){var b=a.Ta,c;c=""+String.fromCharCode(b.getUint8(a.g,!0));a.g+=1;c+=String.fromCharCode(b.getUint8(a.g,!0));a.g+=1;"MT"==c&&(this.kb=b.getUint16(a.g,!0),a.g+=2,3<this.kb||(this.da=b.getUint8(a.g,!0),a.g+=1,this.re=b.getUint32(a.g,!0),a.g+=4,this.se=b.getUint32(a.g,!0),a.g+=4,this.td=b.getUint16(a.g,!0),a.g+=2,this.ud=b.getUint16(a.g,!0),a.g+=2,this.pa=b.getUint16(a.g,!0),a.g+=2,this.$a=b.getUint16(a.g,!0),a.g+=2,this.yc=Array(8),2>this.kb?(this.rg=b.getUint8(a.g,!0),a.g+=1):(this.O=
b.getUint8(a.g,!0),a.g+=1,this.uc=b.getUint8(a.g,!0),a.g+=1,this.Mj(a)),this.Oj(a),this.Pj(a)))};l.Mj=function(a){for(var b=a.Ta,c=this.pa*this.$a+7>>3,d=0;6>d;d++)if(0!=(this.O&1<<d)){for(var e=new Uint8Array(c),g=0;g<c;g++)e[g]=b.getUint8(a.g,!0),a.g+=1;this.yc[d]=e}};
l.Oj=function(a){var b=a.Ta;2>this.kb&&(this.uc=b.getUint8(a.g,!0),a.g+=1,b.getUint16(a.g,!0),a.g+=2);if(0==this.uc)this.G=[];else{var c=this.pa*this.$a+7>>3;this.G=Array(this.uc);for(var d=0,e=this.G.length;d<e;d++){var g=b.getUint16(a.g,!0);a.g+=2;for(var f=new Uint8Array(c),k=0;k<c;k++)f[k]=b.getUint8(a.g,!0),a.g+=1;g=this.c.wi[g];this.G[d]={ui:g?g.Ol:null,vi:f}}}};
l.ni=function(){for(var a=0;1>a;a++)if(this.yc[a]){bitplane_=this.yc[a];for(var b=0;b<this.$a;b++)for(var c=0;c<this.pa;c++){var d=this.pa*b+c,e=1<<(d&7),d=d>>3;if(bitplane_[d]&e)switch(a){case 0:this.ua[b*this.pa+c].Cf=!0}}}};l.oi=function(){for(var a=0;a<this.$a;a++)for(var b=0;b<this.pa;b++)for(var c=this.pa*a+b,d=1<<(c&7),c=c>>3,e=0,g=this.G.length;e<g;e++)if(this.G[e].vi[c]&d){var f=this.G[e].ui;f&&this.ua[a*this.pa+b].G.push(f)}};
l.Pj=function(a){this.ua=Array(this.pa*this.$a);for(var b=0,c=0;c<this.$a;c++)for(var d=0;d<this.pa;d++)this.ua[b]=new Ud(this,[this.da,this.re+this.td+d,this.se+this.ud+c],a),b++;this.oi();this.ni()};
function Rb(a,b,c){this.c=a;this.f=b;this.Bb=a.Bb;this.Fn=c.comment||null;this.sf=c.srsDef||null;this.Lm=c.srsModifiers||[];this.S=c.type||"projected";this.tr=c.vdatum||"orthometric";this.sf=c.srsDefEllps||this.sf;a=c.periodicity;this.Tp=null==a?null:{type:a.type||"",period:a.period||0};this.dk=this.Bb(this.sf).info();this.Md=this.Wa=null;this.wd=this.Bb(this.sf,null,null,!0);this.wh=null;c.geoidGrid&&(c=c.geoidGrid,this.Wa={Uk:c.definition||null,Km:c.srsDefEllps||null,xk:c.valueRange||[0,1]},this.Wa.la=
c.extents?{ca:c.extents.ll,oa:c.extents.ur}:{ca:[0,0],oa:[1,1]},this.Wa.Uk&&(c=Ac(this.c,this.Wa.Uk,{},null),this.Md=new Ec(this.c,c,!0)),this.Wa.Km&&(this.Wa.wd=this.Bb(this.Wa.Km,null,null,!0)))}Rb.prototype.Ib=function(){return{comment:this.Fn,srsDef:this.sf,srsModifiers:this.Lm,type:this.S,vdatum:this.tr,srsDefEllps:this.sf,a:this.dk.a,b:this.dk.b}};Rb.prototype.Pd=function(){return this.dk};Rb.prototype.U=function(){return null==this.Wa||null!=this.Md&&this.Md.U()};
function Zb(a){return"projected"==a.S}function $d(a,b){var c=b[2]||0,c=c/ae(a,b);return c-=be(a,b)}function ce(a,b){var c=b[2]||0,c=c+be(a,b);return c*=ae(a,b)}
function be(a,b){if(null!=a.Md&&(null==a.Wa||null!=a.Md&&a.Md.U())){mapCoords_=a.Bb(a.wd,a.Wa.wd,[b[0],b[1]]);var c=mapCoords_[0]-a.Wa.la.ca[0],d=a.Wa.la.oa[1]-mapCoords_[1],e=a.Md.nh,c=e[0]/(a.Wa.la.oa[0]-a.Wa.la.ca[0])*c,d=e[1]/(a.Wa.la.oa[1]-a.Wa.la.ca[1])*d,c=q.de(c,0,e[0]-2),d=q.de(d,0,e[1]-2),g=Math.floor(c),f=Math.floor(d),c=c-g,k=a.Md.md,h=f*e[0],e=h+e[0],m=k[4*(h+g)],n=k[4*(e+g)],h=m+(k[4*(h+g+1)]-m)*c,d=h+(n+(k[4*(e+g+1)]-n)*c-h)*(d-f);return d=a.Wa.xk[0]+(a.Wa.xk[1]-a.Wa.xk[0])/255*d}return 0}
function ae(a,b){if(-1!=a.Lm.indexOf("adjustVertical")){var c=a.Pd(),d="+proj=longlat  +alpha=0 +gamma=0 +a="+c.a+" +b="+c.b+" +x_0=0 +y_0=0";a.wh||(a.wh=a.Bb(d,null,null,!0));d=a.Bb(a.wd,a.wh,[b[0],b[1]]);c=(new GeographicLib.Geodesic.Geodesic(c.a,c.a/c.b-1)).Direct(d[1],d[0],90,1E3);d=[c.Vr,c.Rr];d=a.Bb(a.wh,a.wd,d);c=d[0]-b[0];d=d[1]-b[1];return Math.sqrt(c*c+d*d)/1E3}return 1}
function Zd(a,b,c){a.U();if("string"!==typeof c){if(c.f==a.f)return b.slice();c.U()}b=b.slice();b[2]=$d(a,b);a=a.Bb(a.wd,"string"===typeof c?c:c.wd,b);"string"!==typeof c&&(a[2]=ce(c,a));return a}function rd(a,b,c){a.U();if("string"!==typeof c){if(c.f==a.f)return b.slice();c.U()}b=b.slice();"string"!==typeof c&&(b[2]=$d(c,b));b=a.Bb("string"===typeof c?c:c.wd,a.wd,b);b[2]=ce(a,b);return b}
function Pb(a){this.c=a;this.C=a.C;this.eg=a.C.eg;this.Sl=this.Ae=this.xm=this.ug=this.jl=this.Nm=this.tc=this.Zh=this.$h=this.ji=this.Yg=this.Te=this.Id=0;this.bi=Array(32);this.wq=!1;this.lh=0;this.fb=900;this.Hl=Array(this.fb);this.vl=Array(this.fb);this.ul=Array(this.fb);this.wl=Array(this.fb);this.Al=Array(this.fb);this.sl=Array(this.fb);this.tl=Array(this.fb);this.El=Array(this.fb);this.Cl=Array(this.fb);this.Bl=Array(this.fb);this.Dl=Array(this.fb);this.Gl=Array(this.fb);this.Fl=Array(this.fb);
this.zl=Array(this.fb);this.yl=Array(this.fb);this.xl=Array(this.fb);this.Cc=[[0,0],[0,0]];this.Bc=[[0,0],[0,0]];this.Ac=[[0,0],[0,0]];for(a=this.lh=0;a<this.fb;a++)this.Hl[a]=0,this.vl[a]=0,this.ul[a]=0,this.wl[a]=0,this.Al[a]=0,this.tl[a]=0,this.sl[a]=0,this.El[a]=0,this.Cl[a]=0,this.Bl[a]=0,this.Dl[a]=0,this.Gl[a]=0,this.Fl[a]=[0,[]],this.zl[a]=[[0,0],[0,0]],this.yl[a]=[[0,0],[0,0]],this.xl[a]=[[0,0],[0,0]];this.To=this.Uo=this.$i=this.Zi=this.Yi=this.yh=this.mj=this.Ul=this.Vl=this.wb=this.Uf=
this.Wf=this.Vf=0}
Pb.prototype.end=function(a){var b=performance.now(),c=b-this.xm,d=b-this.jl;this.jl=b;a?(this.ug+=c,this.Sl=c):this.ug+=this.Sl;this.wq&&(a=this.lh,this.Hl[a]=c,this.vl[a]=0,this.ul[a]=0,this.wl[a]=0,this.Al[a]=d,this.tl[a]=this.c.oc.dd,this.sl[a]=this.c.Gc.dd,this.El[a]=this.Wf,this.Cl[a]=this.Vf,this.Bl[a]=this.Uf,this.Dl[a]=this.wb,this.Gl[a]=this.Te,this.zl[a]=[[this.Cc[0][0],this.Cc[0][1]],[this.Cc[1][0],this.Cc[1][1]]],this.yl[a]=[[this.Bc[0][0],this.Bc[0][1]],[this.Bc[1][0],this.Bc[1][1]]],
this.xl[a]=[[this.Ac[0][0],this.Ac[0][1]],[this.Ac[1][0],this.Ac[1][1]]],this.Fl[a]=[this.Id,this.bi.slice()],this.lh=(this.lh+1)%this.fb,this.eg.vs(this));0==this.Nm%50&&(this.ug=0,null!=this.eg&&this.eg.ws(this));this.Cc=[[0,0],[0,0]];this.Bc=[[0,0],[0,0]];this.Ac=[[0,0],[0,0]]};MelownSubmeshFlags_InternalTexcoords=1;MelownSubmeshFlags_ExternalTexcoords=2;MelownSubmeshFlags_PerVertexUndulation=4;MelownSubmeshFlags_TextureMode=8;
function Td(a,b){this.c=a.c;this.xc=this.Vb=this.T=null;this.Yb=a;this.Ad=!0;this.R=!1;this.v=new Ga;this.Jd=this.s=0;if(null!=b){var c=b.Ta;this.O=c.getUint8(b.g,!0);b.g+=1;1<this.Yb.kb?(this.Fe=c.getUint8(b.g,!0),b.g+=1):this.Fe=0;this.yd=c.getUint16(b.g,!0);b.g+=2;var d=this.v.K,e=this.v.ea;d[0]=c.getFloat64(b.g,!0);b.g+=8;d[1]=c.getFloat64(b.g,!0);b.g+=8;d[2]=c.getFloat64(b.g,!0);b.g+=8;e[0]=c.getFloat64(b.g,!0);b.g+=8;e[1]=c.getFloat64(b.g,!0);b.g+=8;e[2]=c.getFloat64(b.g,!0);b.g+=8;wb(this.v);
if(3<=this.Yb.kb){var c=b.Ta,d=b.g,g=c.getUint16(d,!0),d=d+2,f=c.getUint16(d,!0),d=d+2;g||(this.Ad=!1);for(var e=this.v.Sg(),k=this.v.mg,h=1/f,f=null,m=new Float32Array(3*g),n=0,p=0,t=0,u=e[0],w=e[1],v=e[2],C=this.v.K[0],N=this.v.K[1],x=this.v.K[2],D=1/(this.v.ea[0]-this.v.K[0]),G=1/(this.v.ea[1]-this.v.K[1]),U=1/(this.v.ea[2]-this.v.K[2]),e=0;e<g;e++){var r=de(c,d),n=n+r[0],d=r[1],r=de(c,d),p=p+r[0],d=r[1],r=de(c,d),t=t+r[0],d=r[1],y=3*e;m[y]=(n*h*k+u-C)*D;m[y+1]=(p*h*k+w-N)*G;m[y+2]=(t*h*k+v-x)*
U}if(this.O&MelownSubmeshFlags_ExternalTexcoords)for(f=c.getUint16(d,!0),d+=2,h=1/f,f=new Float32Array(2*g),e=p=n=0;e<g;e++)r=de(c,d),n+=r[0],d=r[1],r=de(c,d),p+=r[0],d=r[1],r=2*e,f[r]=n*h,f[r+1]=1-p*h;this.Dg=m;this.Bg=f;if(this.O&MelownSubmeshFlags_InternalTexcoords){f=c.getUint16(d,!0);d+=2;m=c.getUint16(d,!0);d+=2;e=c.getUint16(d,!0);d+=2;m=1/m;y=1/e;p=n=0;g=new Float32Array(2*f);e=0;for(f*=2;e<f;e+=2)r=de(c,d),n+=r[0],d=r[1],r=de(c,d),p+=r[0],d=r[1],g[e]=n*m,g[e+1]=1-p*y;this.Cg=g}n=c.getUint16(d,
!0);d+=2;f=g=null;m=new Float32Array(9*n);this.O&MelownSubmeshFlags_InternalTexcoords&&(g=new Float32Array(6*n));this.O&MelownSubmeshFlags_ExternalTexcoords&&(f=new Float32Array(6*n));p=this.Dg;k=this.Bg;h=this.Cg;for(e=t=0;e<n;e++)y=9*e,r=ee(c,d),u=t-r[0],d=r[1],r[0]||t++,r=ee(c,d),w=t-r[0],d=r[1],r[0]||t++,r=ee(c,d),v=t-r[0],d=r[1],r[0]||t++,r=3*u,m[y]=p[r],m[y+1]=p[r+1],m[y+2]=p[r+2],r=3*w,m[y+3]=p[r],m[y+4]=p[r+1],m[y+5]=p[r+2],r=3*v,m[y+6]=p[r],m[y+7]=p[r+1],m[y+8]=p[r+2],null!=f&&(y=6*e,f[y]=
k[2*u],f[y+1]=k[2*u+1],f[y+2]=k[2*w],f[y+3]=k[2*w+1],f[y+4]=k[2*v],f[y+5]=k[2*v+1]);t=0;if(null!=g)for(e=0;e<n;e++)r=ee(c,d),u=t-r[0],d=r[1],r[0]||t++,r=ee(c,d),w=t-r[0],d=r[1],r[0]||t++,r=ee(c,d),v=t-r[0],d=r[1],r[0]||t++,y=6*e,g[y]=h[2*u],g[y+1]=h[2*u+1],g[y+2]=h[2*w],g[y+3]=h[2*w+1],g[y+4]=h[2*v],g[y+5]=h[2*v+1];this.T=m;this.Vb=g;this.xc=f}else{c=b.Ta;d=b.g;y=c.getUint16(b.g,!0);d+=2;y||(this.Ad=!1);m=null;f=new Float32Array(3*y);this.O&MelownSubmeshFlags_ExternalTexcoords&&(m=new Float32Array(2*
y));p=n=1/65535;for(e=0;e<y;e++)r=3*e,f[r]=c.getUint16(d,!0)*p,d+=2,f[r+1]=c.getUint16(d,!0)*p,d+=2,f[r+2]=c.getUint16(d,!0)*p,d+=2,null!=m&&(r=2*e,m[r]=c.getUint16(d,!0)*n,d+=2,m[r+1]=(65535-c.getUint16(d,!0))*n,d+=2);this.Dg=f;this.Bg=m;if(this.O&MelownSubmeshFlags_InternalTexcoords){m=c.getUint16(d,!0);d+=2;y=new Float32Array(2*m);n=1/65535;e=0;for(m*=2;e<m;e+=2)y[e]=c.getUint16(d,!0)*n,d+=2,y[e+1]=(65535-c.getUint16(d,!0))*n,d+=2;this.Cg=y}n=c.getUint16(d,!0);d+=2;m=y=null;f=new Float32Array(9*
n);this.O&MelownSubmeshFlags_InternalTexcoords&&(y=new Float32Array(6*n));this.O&MelownSubmeshFlags_ExternalTexcoords&&(m=new Float32Array(6*n));p=this.Dg;g=this.Bg;k=this.Cg;for(e=0;e<n;e++)r=9*e,h=c.getUint16(d,!0),d+=2,t=c.getUint16(d,!0),d+=2,u=c.getUint16(d,!0),d+=2,w=3*h,f[r]=p[w],f[r+1]=p[w+1],f[r+2]=p[w+2],w=3*t,f[r+3]=p[w],f[r+4]=p[w+1],f[r+5]=p[w+2],w=3*u,f[r+6]=p[w],f[r+7]=p[w+1],f[r+8]=p[w+2],null!=m&&(r=6*e,m[r]=g[2*h],m[r+1]=g[2*h+1],m[r+2]=g[2*t],m[r+3]=g[2*t+1],m[r+4]=g[2*u],m[r+5]=
g[2*u+1]),null!=y&&(h=c.getUint16(d,!0),d+=2,t=c.getUint16(d,!0),d+=2,u=c.getUint16(d,!0),d+=2,r=6*e,y[r]=k[2*h],y[r+1]=k[2*h+1],y[r+2]=k[2*t],y[r+3]=k[2*t+1],y[r+4]=k[2*u],y[r+5]=k[2*u+1]);this.T=f;this.Vb=y;this.xc=m}this.Bg=this.Cg=this.Dg=null;b.g=d;this.s=this.T.length;this.Vb&&(this.s+=this.Vb.length);this.xc&&(this.s+=this.xc.length);this.s*=4;this.Jd=n}}l=Td.prototype;l.D=function(){this.R=!0;this.xc=this.Vb=this.T=null};
function ee(a,b){var c=a.getUint8(b,!0);if(c&128){var d=a.getUint8(b+1,!0);return[c&127|d<<7,b+2]}return[c,b+1]}function de(a,b){var c=a.getUint8(b,!0);return c&128?(c=c&127|a.getUint8(b+1,!0)<<7,c&1?[-((c>>1)+1),b+2]:[c>>1,b+2]):c&1?[-((c>>1)+1),b+1]:[c>>1,b+1]}l.size=function(){return this.s};l.fileSize=function(){return this.Sb};function jd(a){return new Xa(a.c.l.j,{v:a.v,T:a.T,Fg:a.Vb,gn:a.xc},1,a.c.C)}
l.We=function(a,b){var c=b;null!=c?(c[0]=xb(this.v,0),c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=xb(this.v,1),c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=xb(this.v,2),c[11]=0,c[12]=this.v.K[0]-a[0],c[13]=this.v.K[1]-a[1],c[14]=this.v.K[2]-a[2],c[15]=1):(c=q.i.create(),q.i.multiply(q.ed(this.v.K[0]-a[0],this.v.K[1]-a[1],this.v.K[2]-a[2]),q.vg(xb(this.v,0),xb(this.v,1),xb(this.v,2)),c));return c};
l.Se=function(a){var b=this.c.l;b.j.useProgram(b.kf,["aPosition"]);var c=q.i.create(),d=q.i.create();q.i.multiply(pb(b.N),this.We(a),d);a=ob(b.N);q.i.multiply(a,d,c);Qa(b.kf,"uMVP",c);b.Og.Ua(b.kf,"aPosition")};
function Wb(a,b,c){this.c=a;this.f=null;this.S="basic";this.Qh=1;this.Gj=this.Zb="";this.hm=1;this.kk=this.Ph="";this.Aa=this.c.Aa;this.Rb=this.c.Rb;this.fc=this.c.fc;this.na=[0,0];this.V=[[0,0],[0,0]];this.yd=null;this.gc=[];this.ke="glue"==c;this.Ki="free"==c;this.Mc=!1;this.Me=0;this.aa=!1;this.Ld=null;this.Kd=0;this.nl=!1;this.ng=this.Rh=null;this.fm=-1;this.On=[];this.Lj=this.$d=this.Pm=null;this.gk=!0;this.sb=this.Ki?new ac(this.c,0,this):null;"string"===typeof b?(this.Wb=this.c.rb(b),this.Aa=
q.qa.eh(this.Wb),this.Rb=q.qa.jh(this.Wb),this.fc=q.qa.gh(this.Wb),q.Zc(this.Wb,function(a){this.we(a);this.aa=!0;qc(this.c)}.bind(this),function(){}.bind(this),null,q.useCredentials?-1!=this.Wb.indexOf(this.c.Aa):!1,this.c.C.ub)):(this.we(b),this.aa=!0)}l=Wb.prototype;
l.we=function(a){this.f=a.id||null;this.S=a.type||"basic";this.Qh=a.metaBinaryOrder||1;this.Zb=this.rb(a.metaUrl,"");this.Gj=this.rb(a.navUrl,"");this.hm=a.navDelta||1;this.Ph=this.rb(a.meshUrl,"");this.kk=this.rb(a.textureUrl,"");this.Qf=this.rb(a.geodataUrl||a.geodata,"");this.na=a.lodRange||[0,0];this.V=a.tileRange||[[0,0],[0,0]];this.yd=a.textureLayer||null;this.Va="geodata"==this.S||"geodata-tiles"==this.S;this.G=a.credits||[];this.ee=a.displaySize||256;if(a.extents){var b=a.extents.ll,c=a.extents.ur;
this.la=new Ga(b[0],b[1],b[2],c[0],c[1],c[2])}else this.la=new Ga(0,0,0,1,1,1);this.Zd=Math.pow(2,this.na[0])/((this.V[1][0]-this.V[1][0]+1)*(this.V[1][1]-this.V[1][1]+1));switch(typeof this.G){case "string":this.G=[];break;case "object":if(!Array.isArray(this.G)){b=this.G;this.G=[];for(var d in b)Tb(this.c,d,new Ub(this.c,b[d])),this.G.push(d)}d=0;for(b=this.G.length;d<b;d++)c=this.c.G[this.G[d]],this.On.push(c?c.f:null)}this.Qf&&-1!=this.Qf.indexOf("{geonavtile}")&&(this.nl=!1);this.Va&&(this.Lj=
a=a.style)&&oc(this,a);this.Fe=[];if(this.ke)for(d=0,b=this.f.length;d<b;d++)this.Fe.push(this.c.Qd(this.f[d]))};l.Ib=function(){return this.Va?{type:this.S,metaUrl:this.Zb,geodataUrl:this.Qf,lodRange:this.na,tileRange:this.V,style:this.Lj}:{type:this.S,metaUrl:this.Zb,navUrl:this.Gj,meshUrl:this.Ph,textureUrl:this.kk,lodRange:this.na,tileRange:this.V,textureLayer:this.yd}};
l.rb=function(a,b){if(!a)return b;a=a.trim();return-1!=a.indexOf("://")?a:0==a.indexOf("//")?this.Rb+a:0==a.indexOf("/")?this.fc+a:this.Aa+a};l.Il=function(a){var b=a[0]-this.na[0],c=0>b;if(a[0]<this.na[0]){var b=-b,d=this.V[0][0]>>b,e=this.V[0][1]>>b,g=this.V[1][0]>>b,b=this.V[1][1]>>b;if(a[0]>this.na[1]||a[1]<d||a[1]>g||a[2]<e||a[2]>b)return[!1,!1]}else if(d=a[1]>>b,b=a[2]>>b,a[0]>this.na[1]||d<this.V[0][0]||d>this.V[1][0]||b<this.V[0][1]||b>this.V[1][1])return[!1,!1];return[!0,c]};
function oc(a,b){a.Pm!=b&&(a.$d=a.c.fi[b],a.$d||(a.$d=new Vb(a.c,b,b),a.c.fi[b]=a.$d),a.Pm=b,a.gk=!0,a.Kd++,pc(a.c))}l.fh=function(a,b){return Ac(this.c,this.Zb,{da:a[0],hb:a[1],ib:a[2]},null,b)};function ld(a,b){return Ac(a.c,a.Gj,{da:b[0],hb:b[1],ib:b[2]},null,void 0)}function qd(a,b,c){return Ac(a.c,a.kk,{da:b[0],hb:b[1],ib:b[2]},c,void 0)}function md(a,b,c){return Ac(a.c,a.Qf,{da:b[0],hb:b[1],ib:b[2]},c,void 0)}
function mc(a){var b,c=a.If;if(b=a.sb){b.Ge=[];b.qs=[];b.gi=[];var d={},e=0,g=[],f=[],k;for(k in c.bb){var h=a.Qd(k);h&&(f.push(h.f),e++,d[k]=h.g+1,g.push([[h.g+1],h,!0,!1]))}1<=e&&(f.sort(),f=f.join(";"),h=a.Fb[f])&&(g=[[[h.g+1],h,!0,!1]],e=1);if(1<e){var m=[];for(k in a.Tf){var n=a.Tf[k],p=n.f;if(p.length<=e){for(var t=!1,f=0,h=p.length;f<h;f++)if(!d[p[f]]){t=!0;break}if(!t){t=[];f=0;for(h=p.length;f<h;f++)t.unshift(d[p[f]]);m.push([t,n,!1,!1])}}}d=0;for(p=m.length;d<p;d++)f=m[d],n=f[1],n.oo=!0,
n.no=!0,n.oo&&g.push(f),n.no&&(t=f[0].slice(1),g.push([t,f[1],!1,!0]));do for(m=!0,d=0,p=g.length-1;d<p;d++){for(var n=g[d][0],t=g[d+1][0],u=!1,f=0,h=Math.min(n.length,t.length);f<h;f++)if(n[f]<t[f]||f==h-1&&n[f]==t[f]&&t.length>n.length){u=!0;break}u&&(f=g[d],g[d]=g[d+1],g[d+1]=f,m=!1)}while(!m);--e;d=0;for(p=g.length;d<p;d++)b.Ge.push([g[d][1],g[d][3]]),g[d][1].yk=e,g[d][2]&&(e--,b.gi.push(g[d][1]))}else 1==e&&(b.Ge.push([g[0][1],g[0][3]]),g[0][1].yk=e-1,b.gi=[g[0][1]]);a.bh=!1;for(k in c.Ra)if(b=
a.Ra[k])b.Ge=[b],b.gi=[b],b.Va&&(a.bh=!0);Bb(a.l)}}
function nc(a){var b=a.If,c;for(c in b.bb){var d=b.bb[c],e=a.Qd(c);if(null!=e){e.gc=[];for(var g=0,f=d.length;g<f;g++){var k=d[g];if("string"===typeof k){var h=a.Pa[k];h&&e.gc.push([h,1])}else if(h=a.Pa[k.id]){var m=1;"undefined"!==typeof k.alpha&&(m=k.alpha);e.gc.push([h,m])}}}}for(c in b.Ra)if(g=b.Ra[c],d=a.Ra[c],null!=d&&d.aa&&(d.gc=[],(e=g.boundLayers)&&Array.isArray(e)))for(g=0,f=e.length;g<f;g++)if(k=e[g],"string"===typeof k)(h=a.Pa[k])&&d.gc.push([h,1]);else if(h=a.Pa[k.id])m=1,"undefined"!==
typeof k.alpha&&(m=k.alpha),d.gc.push([h,m])}function Ec(a,b,c,d,e,g,f){this.c=a;this.u=a.u;this.H=g;this.af=f;this.Ya=this.nh=this.md=this.Ca=null;this.I=0;this.Ia=null;this.ra=0;this.qg=!1;this.Sa=null;this.La=b;this.gb=c||!1;this.J=d;this.Qa=e;this.wa=0;this.ld=this.kd=null;this.Ii=!1;this.Sb=0;if(e&&e.Da&&(a=e.Da,a.qc))switch(this.kd=a.qc.S,this.kd){case "negative-type":this.ld=a.qc.Bp;break;case "negative-code":this.ld=a.qc.En;break;case "negative-size":this.ld=a.qc.s}this.Xa=this.X=null}l=Ec.prototype;
l.D=function(){this.L=null;this.th();this.sh();this.Sa&&(this.Sa.th(),this.Sa.sh())};l.th=function(a){this.md=this.Ca=null;1!=a&&this.X&&this.c.oc.remove(this.X);this.Sa&&this.Sa.th();this.I=this.Ya?this.I:0;this.X=null};l.sh=function(a){null!=this.Ya&&(this.u.Wf-=this.Ya.s,this.Ya.D(),this.u.Cc[1][0]++,this.u.Cc[1][1]+=this.Ya.s,this.Sa&&this.Sa.sh());this.Ya=null;1!=a&&this.Xa&&this.c.Ub.remove(this.Xa);this.Ca||this.md||(this.I=0);this.Xa=null};
function fe(a,b,c){if(b&&c){a.J.Ce=b;a.J.Da=c;if(!b.Ga[c.f]){b.Pa[c.f]=c;var d=zc(c,b.f);b.Ga[c.f]=Dc(b.cc,d,null,null,{H:b,Da:c},a.H,a.af)}a.J.L=b.Ga[c.f];c=a.J.H;var d=c.f[0]-b.f[0],e=1/Math.pow(2,d);a.J.en=[e,e,(c.f[1]-(b.f[1]<<d))*e,(c.f[2]-(b.f[2]<<d))*e];pc(a.c)}}
l.U=function(a,b,c){var d=this.c.u.wb>=this.c.qe;a=a||d;if(this.qg)return!1;if(this.J){if(this.J.L){for(;-1==this.J.L.wa;){d=this.J.Ce.sa;if(d.f[0]<this.J.Da.na[0])return this.qg=!0,this.J.H.Be=!0,pc(this.c),!1;fe(this,d,this.J.Da)}(a=this.J.L.U(a,b,c))&&this.Nk&&(this.J.H.Be=null!=pd(this.J.L),this.Nk=!1);return a}fe(this,this.J.Ce,this.J.Da);return!1}switch(this.kd){case "metatile":if(2!=this.wa){if(0==this.wa&&this.Qa&&this.Qa.H){var e=this.Qa.H.Ik;e||(e=Cc(this.c.ci,this.Qa.H.f,8),this.Qa.H.Ik=
e);var d=this.Qa.Da,g=this.Qa.em;this.Qa.em||(g=e.f,g=Ac(d.c,d.Zb,{da:g[0],hb:g[1],ib:g[2]},null,void 0),this.Qa.em=g);e=Dc(e,g,!0,null,null,this.H,this.af);this.Sa?this.Sa.U(a,b,c)&&(this.wa=2):e.U(a,b,c)&&(a=this.Qa.H,b=e.md?e.md[4*((a.f[2]&255)*e.nh[0]+(a.f[1]&255))]:0,this.wa=b&128?2:-1,2!=this.wa||b&64||(b=a.f,g=Ac(d.c,d.Cj,{da:b[0],hb:b[1],ib:b[2]},null,void 0),this.Sa=Dc(a.cc,g,null,null,null,this.H,this.af),this.wa=0,a.Be=!0,pc(this.c)))}if(-1==this.wa){if(!this.J){d=this.Qa.H.sa;if(d.f[0]<
this.Qa.Da.na[0])return this.qg=!0,this.Qa.H.Be=!0,pc(this.c),!1;this.J={H:this.Qa.H,Da:this.Qa.Da};fe(this,this.J.H.sa,this.J.Da);this.Nk=!0}for(;-1==this.J.L.wa;){d=this.J.Ce.sa;if(d.f[0]<this.J.Da.na[0]){this.qg=!0;this.J.H.Be=!0;pc(this.c);break}fe(this,d,this.J.Da)}}return!1}break;case "negative-type":case "negative-code":case "negative-size":if(2!=this.wa){if(0==this.wa)ge(this,b,"negative-size"==this.kd);else if(3==this.wa)this.ra<=this.c.h.jc&&performance.now()>this.Ia+this.c.h.kc&&ge(this,
b,"negative-size"==this.kd);else if(-1==this.wa&&this.Qa)for(this.J||(this.J={H:this.Qa.H,Da:this.Qa.Da},fe(this,this.J.H.sa,this.J.Da));-1==this.J.L.wa;)fe(this,this.J.Ce.sa,this.J.Da);return!1}}if(2==this.I){!a&&this.X&&Ic(this.c.oc,this.X);if(c)return this.gb&&(this.md||he(this)),this.Sa?this.Sa.U(a,b,c):!0;if(this.gb)this.md||he(this);else{if(!this.Ya){if(this.c.u.wb>=this.c.qe)return!1;if(this.u.Ae>this.c.h.Hh)return pc(this.c),!1;if(d)return!1;d=performance.now();this.Ya=new Aa(this.c.l.j,null,
this.c.C);Da(this.Ya,this.Ca,"linear",!1);this.u.Wf+=this.Ya.s;this.u.Cc[0][0]++;this.u.Cc[0][1]+=this.Ya.s;this.Xa=Jc(this.c.Ub,this.sh.bind(this,!0),this.Ya.s);this.u.Ae+=performance.now()-d}!a&&this.Xa&&Ic(this.c.Ub,this.Xa)}return this.Sa?this.Sa.U(a,b,c):!0}0==this.I?a||this.ob(b):3==this.I&&this.ra<=this.c.h.jc&&performance.now()>this.Ia+this.c.h.kc&&this.ob(b);return!1};l.ob=function(a,b){this.c.Xb.load(this.La,this.Hc.bind(this,b),a,this.H,this.af?"texture-in":"texture-ex")};
l.Hc=function(a,b,c,d){this.lc=c;this.Fc=d;c=this.Ob.bind(this);d=this.Pb.bind(this);a?this.wa=1:this.I=1;this.c.h.kg?q.Dc(b,this.Jp.bind(this),c,q.useCredentials?-1!=this.La.indexOf(this.c.Aa):!1,this.c.C.ub,"blob"):this.Ca=q.cb.cj(b,d,c,this.c.C.lk?-1!=b.indexOf(this.c.C.lk):!1)};l.Ob=function(a){1!=this.c.R&&(a&&window.URL.revokeObjectURL(this.Ca.src),this.I=3,this.Ia=performance.now(),this.ra++,this.ra<=this.c.h.jc&&setTimeout(function(){this.c.R||pc(this.c)}.bind(this),this.c.h.kc),this.Fc())};
l.Jp=function(a){if(this.Ii&&this.kd&&"metatile"!=this.kd&&(this.mm(0,a,null),-1==this.wa)){this.lc();return}var b=new Image;b.onerror=this.Ob.bind(this,!0);b.onload=this.Pb.bind(this,!0);this.Ca=b;b.src=window.URL.createObjectURL(a);this.Sb=a.size};l.Pb=function(a){this.c.R||(a&&window.URL.revokeObjectURL(this.Ca.src),this.X=Jc(this.c.oc,this.th.bind(this,!0),this.Ca.naturalWidth*this.Ca.naturalHeight*3),pc(this.c),this.I=2,this.Ia=null,this.ra=0,this.lc())};
function ge(a,b,c){a.c.h.kg&&a.Ii?a.ob(b,!0):a.c.Xb.load(a.La,a.Kp.bind(a,c),b,a.H,a.af,a.af?"texture-in":"texture-ex")}l.Kp=function(a,b,c,d){this.lc=c;this.Fc=d;c=this.Lp.bind(this,a);d=this.mm.bind(this,a);this.wa=1;a?q.Dc(b,d,c,q.useCredentials?-1!=this.La.indexOf(this.c.Aa):!1,this.c.C.ub,"blob"):q.cb.Jl(b,d,c,q.useCredentials?-1!=this.La.indexOf(this.c.Aa):!1,this.c.C.ub)};
l.Lp=function(){this.c.R||(this.wa=3,this.Ia=performance.now(),this.ra++,this.ra<=this.c.h.jc&&setTimeout(function(){this.c.R||pc(this.c)}.bind(this),this.c.h.kc),this.Fc())};
l.mm=function(a,b,c){if(!this.c.R)if(this.wa=2,this.Ia=null,this.ra=0,this.c.h.kg&&this.Ii)switch(this.kd){case "negative-size":b&&b.size==this.ld&&(this.wa=-1);break;case "negative-type":b&&b.type==this.ld&&(this.wa=-1);break;case "negative-code":c&&-1!=this.ld.indexOf(c)&&(this.wa=-1)}else{switch(this.kd){case "negative-size":b&&b.byteLength==this.ld&&(this.wa=-1);break;case "negative-type":b&&-1!=b.indexOf(this.ld)&&(this.wa=-1);break;case "negative-code":c&&-1!=this.ld.indexOf(c)&&(this.wa=-1)}this.lc()}};
function he(a){var b=document.createElement("canvas");b.width=a.Ca.naturalWidth;b.height=a.Ca.naturalHeight;b=b.getContext("2d");b.drawImage(a.Ca,0,0);a.md=b.getImageData(0,0,a.Ca.naturalWidth,a.Ca.naturalHeight).data;a.nh=[a.Ca.naturalWidth,a.Ca.naturalHeight];a.Ca=null}function pd(a){return a.J&&a.J.L?a.J.L.Sa:a.Sa}
function Xb(a,b){this.c=a;this.f=null;this.Bj=this.Zb="";this.Aa=this.c.Aa;this.Rb=this.c.Rb;this.fc=this.c.fc;this.na=[0,0];this.V=[[0,0],[0,0]];this.bb=[];this.we(b);this.Mc=!0;this.aa=!1}l=Xb.prototype;
l.we=function(a){this.f=a.id||null;this.Zb=this.rb(a.metaUrl,"");this.Bj=this.rb(a.mapping,"");this.na=a.lodRange||[0,0];this.V=a.tileRange||[[0,0],[0,0]];this.Om=this.f?this.f.join(";"):null;if(this.f){var b=this.f.slice();b.sort();this.Om=b.join(";")}a.extents?(b=a.extents.ll,a=a.extents.ur,this.la=new Ga(b[0],b[1],b[2],a[0],a[1],a[2])):this.la=new Ga(0,0,0,1,1,1);this.Zd=Math.pow(2,this.na[0])/((this.V[1][0]-this.V[1][0]+1)*(this.V[1][1]-this.V[1][1]+1));q.Dc(this.Bj,this.Np.bind(this),this.Mp.bind(this),
q.useCredentials?-1!=this.Wb.indexOf(this.c.Aa):!1,this.c.C.ub)};l.Np=function(a){var b=0,c;c=""+String.fromCharCode(a.getUint8(b,!0));b+=1;c+=String.fromCharCode(a.getUint8(b,!0));b+=1;if("TM"==c){c=a.getUint16(b,!0);for(var b=b+2,d=0;d<c;d++){for(var e=a.getUint8(b,!0),b=b+1,g=[],f=0;f<e;f++){var k=a.getUint16(b,!0),b=b+2;(k=this.f[k])&&g.push(k)}1==g.length?this.bb.push(this.c.Qd(g[0])):this.bb.push(this.c.Tf[g.join(";")])}}this.aa=!0;qc(this.c)};l.Mp=function(){};
l.Ib=function(){return{metaUrl:this.Zb,mapping:this.Bj,lodRange:this.na,tileRange:this.V}};l.rb=function(a,b){if(!a)return b;a=a.trim();return-1!=a.indexOf("://")?a:0==a.indexOf("//")?this.Rb+a:0==a.indexOf("/")?this.fc+a:this.Aa+a};
l.Il=function(a){var b=a[0]-this.na[0],c=0>b;if(a[0]<this.na[0]){var b=-b,d=this.V[0][0]>>b,e=this.V[0][1]>>b,g=this.V[1][0]>>b,b=this.V[1][1]>>b;if(a[0]>this.na[1]||a[1]<d||a[1]>g||a[2]<e||a[2]>b)return[!1,!1]}else if(d=a[1]>>b,b=a[2]>>b,a[0]>this.na[1]||d<this.V[0][0]||d>this.V[1][0]||b<this.V[0][1]||b>this.V[1][1])return[!1,!1];return[!0,c]};l.Qd=function(a){return this.bb[a-1]};l.fh=function(a,b){return Ac(this.c,this.Zb,{da:a[0],hb:a[1],ib:a[2]},null,b)};
function ie(a,b,c){this.c=a;this.f=c;this.sa=b;this.yf=a.yf;this.Xj=!1;this.Kd=0;this.xa=this.Vq=this.Db=1;this.Qb=this.cd=this.Ea=this.A=this.Ik=this.oe=this.B=null;this.ab=[];this.Na=null;this.Mc=!1;this.Fb=[];this.Be=!1;this.rc={};this.Pa={};this.Ga={};this.Eg=!0;this.gb=null;this.ba=[[],[],[]];this.xb={};this.je={};this.Td={};a=this.c.ci.sb;for(b=1;b<=c[0];b++){var d=1<<b-1,e=0;0!=(c[1]&d)&&(e+=1);0!=(c[2]&d)&&(e+=2);a.Z[e]||a.Lg(e);a=a.Z[e]}this.cc=a;this.qb=Cc(this.c.ci,c,5,!0);Cc(this.c.ci,
c,8,!0);this.Z=[null,null,null,null]}l=ie.prototype;l.D=function(){for(var a=0;4>a;a++)null!=this.Z[a]&&this.Z[a].D();this.Ea=this.A=this.B=this.qb=this.cc=null;this.ab=[];this.Na=this.Qb=this.cd=null;this.rc={};this.Pa={};this.Ga={};this.Eg=!0;this.Mc=!1;this.Fb=[];this.Xj=!1;this.gb=this.Kb=this.od=this.Sd=null;this.ba=[[],[],[]];this.xb={};this.je={};this.Td={};this.Z=[null,null,null,null];a=this.sa;this.sa=null;null!=a&&a.removeChild(this)};
l.hn=function(){null!=this.qb&&Gc(this.qb,this.A,null,this)};function je(a){a.od&&(a.Ea=a.od.Ea,a.ab=a.od.ab,a.Ga=a.od.Ga,a.cd=a.od.cd,a.Qb=a.od.Qb,a.Na=a.od.Na,a.Sd=null,a.od=null)}l.Lg=function(a){if(!this.Z[a]){var b=this.f,b=[b[0]+1,b[1]<<1,b[2]<<1];switch(a){case 1:b[1]++;break;case 2:b[2]++;break;case 3:b[1]++,b[2]++}this.Z[a]=new ie(this.c,this,b)}};l.wm=function(a){null!=this.Z[a]&&(this.Z[a].D(),this.Z[a]=null)};
l.removeChild=function(a){for(var b=0;4>b;b++)this.Z[b]==a&&(this.Z[b].D(),this.Z[b]=null)};
function ke(a,b,c,d){if(a.c.yf!=a.gd){a.Sd=a.A;a.od={Ea:a.Ea,ab:a.ab,Ga:a.Ga,cd:a.cd,Qb:a.Qb,Na:a.Na};a.Kb=0<a.ba[0].length?{ba:a.ba,xb:a.xb,Td:a.Td}:null;a.Xj=!1;a.oe=a.B;for(var e in a.rc)a.rc[e]={Jc:[],ce:[],ii:!1,gd:0};a.Pa={};a.Ga={};a.Eg=!0;a.A=null;a.Ea=null;a.ab=[];a.cd=null;a.Qb=null;a.Na=null;a.Mc=!1;a.Fb=[];a.ba=[[],[],[]];a.xb={};a.je={};a.Td={};a.gd=a.c.yf;pc(a.c);a.Kb&&(a.Kb=a.Kb)}if(!d){if(a.Hg||null==a.A&&0==a.Fb.length)a:if(a.A=null,a.Mc=!1,a.Fb=[],a.Hg=!1,b.ah)a.A=b.ah;else{b=b.Ge;
d=0;for(e=b.length;d<e;d++){var g=b[d][0],f=b[d][1];if(1==g.Il(a.f)[0]){if(0<a.f[0]){var k=a.sa;if(k){if(k.Hg){a.Hg=!0;a.Fb=[];break a}var h=Gc(k.qb,g,null,a);if(h){if(!h.U(c)){a.Hg=!0;continue}if(k=h.Sf(k.f)){if(h=a.f,0==(k.O&1<<(h[2]-(k.f[2]<<1)<<1)+(h[1]-(k.f[1]<<1))+4))continue}else continue}else continue}}a.Fb.push([g,f])}}1<a.Fb.length?a.Mc=!0:a.A=a.Fb[0]?a.Fb[0][0]:null}if(null==a.B||a.oe){if(!(b=a.Hg)){a:{if(a.Mc){b=a.Fb;e=d=0;for(g=b.length;e<g;e++)1==Gc(a.qb,b[e][0],!0,a).U(c)&&d++;if(d==
g){b=a.Fb;d=null;e=0;for(g=b.length;e<g;e++)if(f=b[e][0],h=b[e][1],k=Gc(a.qb,f,null,a),1==k.U(c)&&(k=k.Sf(a.f),null!=k&&h==k.Cf)){if(!h&&f.ke&&0==(k.O&1)&&0<k.oh){for(var h=k.oh-1,h=a.c.Qd(f.f[h]).yk,m=!1,n=e;n<g;n++)if(b[n].yk<=h){m=n>e;e=n-1;break}if(m)continue}if(0!=(k.O&1)){d=k.clone();a.A=f;break}}e=0;for(g=b.length;e<g;e++)f=b[e][0],k=Gc(a.qb,f,null,a),1==k.U(c)&&(k=k.Sf(a.f),null!=k&&(d?(d.O|=k.O&240,d.v.K[0]=Math.min(d.v.K[0],k.v.K[0]),d.v.K[1]=Math.min(d.v.K[1],k.v.K[1]),d.v.K[2]=Math.min(d.v.K[2],
k.v.K[2]),d.v.ea[0]=Math.max(d.v.ea[0],k.v.ea[0]),d.v.ea[1]=Math.max(d.v.ea[1],k.v.ea[1]),d.v.ea[2]=Math.max(d.v.ea[2],k.v.ea[2])):(d=k.clone(),a.A=f)));d&&Wd(d,!0);a.B=d;a.oe=null;pc(a.c)}else{c=!1;break a}}b=a.A;if(null==b)c=!1;else if(b=Gc(a.qb,b,!0,a),1==b.U(c)){a.Mc||(a.B=b.Sf(a.f),a.oe=null,pc(a.c));if(null!=a.B)for(a.B.H=a,a.oe=null,pc(a.c),c=0;4>c;c++)0!=(a.B.O&1<<c+4)==1?a.Lg(c):a.wm(c);c=!0}else c=!1}b=c||null!=a.B&&a.oe}if(!b)return;a.oe&&(processFlag2_=!0)}}if(null==a.B)return!1;a.B.$b.uk();
a.Sd&&a.Sd==a.A&&(a.Sd=null,je(a));a.A&&(a.A.Mc?(a.Na=a.A.Qd(a.B.Hm),a.Na||(a.Na=a.A)):a.Na=a.A);return!0}
l.Pc=function(a,b,c,d){var e=this.c;if(!e.h.rj&&e.ml&&d){var g=d.vc,f=e.va,g=[g[0]-f[0],g[1]-f[1],g[2]-f[2]];q.F.normalize(g);if(q.F.eb(g,d.Mf)>d.Wg)return!1}if(!e.h.zp||4>a[0])d=e.N.Pc(b,c);else a:{a=e.N;d=d.Df;a.Ba&&a.update();b=a.Fk;if(c){var e=c[0],g=c[1],k=c[2];c=d[0];f=b[0];f[0]=c[0]-e;f[1]=c[1]-g;f[2]=c[2]-k;c=d[1];f=b[1];f[0]=c[0]-e;f[1]=c[1]-g;f[2]=c[2]-k;c=d[2];f=b[2];f[0]=c[0]-e;f[1]=c[1]-g;f[2]=c[2]-k;c=d[3];f=b[3];f[0]=c[0]-e;f[1]=c[1]-g;f[2]=c[2]-k;c=d[4];f=b[4];f[0]=c[0]-e;f[1]=c[1]-
g;f[2]=c[2]-k;c=d[5];f=b[5];f[0]=c[0]-e;f[1]=c[1]-g;f[2]=c[2]-k;c=d[6];f=b[6];f[0]=c[0]-e;f[1]=c[1]-g;f[2]=c[2]-k;c=d[7];f=b[7];f[0]=c[0]-e;f[1]=c[1]-g;f[2]=c[2]-k;d=b}c=q.xf.Zk;a=a.zc;for(b=0;6>b;b++){e=!0;for(g=0;8>g;g++)if(0<=c(a[b],d[g])){e=!1;break}if(e){d=!1;break a}}d=!0}return d};
function le(a,b,c,d){var e=b.K,g=b.ea;b=[e[0]-d[0],e[1]-d[1]];var f=[g[0]-d[0],e[1]-d[1]],k=[g[0]-d[0],g[1]-d[1]],h=[e[0]-d[0],g[1]-d[1]],m=e[2]-d[2],n=g[2]-d[2];if(!a.c.h.Gh&&d[0]>e[0]&&d[0]<g[0]&&d[1]>e[1]&&d[1]<g[1]&&d[2]>e[2]&&d[2]<g[2])return[Number.POSITIVE_INFINITY,.1];a=a.c.N;a=0<b[1]?0<b[0]?0>n?zb(a,[b[0],b[1],n]):0<m?zb(a,[b[0],b[1],m]):zb(a,[b[0],b[1],.5*(m+n)]):0>f[0]?0>n?zb(a,[f[0],f[1],n]):0<m?zb(a,[f[0],f[1],m]):zb(a,[f[0],f[1],.5*(m+n)]):0>n?zb(a,[.5*(b[0]+f[0]),f[1],n]):0<m?zb(a,
[.5*(b[0]+f[0]),f[1],m]):zb(a,[.5*(b[0]+f[0]),f[1],.5*(m+n)]):0>h[1]?0<h[0]?0>n?zb(a,[h[0],h[1],n]):0<m?zb(a,[h[0],h[1],m]):zb(a,[h[0],h[1],.5*(m+n)]):0>k[0]?0>n?zb(a,[k[0],k[1],n]):0<m?zb(a,[k[0],k[1],m]):zb(a,[k[0],k[1],.5*(m+n)]):0>n?zb(a,[.5*(h[0]+k[0]),k[1],n]):0<m?zb(a,[.5*(h[0]+k[0]),k[1],m]):zb(a,[.5*(h[0]+k[0]),k[1],.5*(m+n)]):0<h[0]?0>n?zb(a,[b[0],.5*(f[1]+k[1]),n]):0<m?zb(a,[b[0],.5*(f[1]+k[1]),m]):zb(a,[b[0],.5*(f[1]+k[1]),.5*(m+n)]):0>k[0]?0>n?zb(a,[f[0],.5*(f[1]+k[1]),n]):0<m?zb(a,[f[0],
.5*(f[1]+k[1]),m]):zb(a,[f[0],.5*(f[1]+k[1]),.5*(m+n)]):0>n?zb(a,[.5*(b[1]+f[1]),.5*(f[1]+k[1]),n]):0<m?zb(a,[.5*(b[1]+f[1]),.5*(f[1]+k[1]),m]):zb(a,[.5*(b[1]+f[1]),.5*(f[1]+k[1]),.5*(m+n)]);return[a[0]*c,a[1]]}function me(a,b,c){var d=1*a.c.An-b.Xg;if(0>d)return[Number.POSITIVE_INFINITY,.1];var e=q.F.eb(a.c.Bn,b.Mf);e<b.Lf&&(e=Math.acos(e),e-=Math.acos(b.Lf),b=Math.tan(e)*b.Xg,d=Math.sqrt(b*b+d*d));a=a.c.N;b=d;a.Ba&&a.update();a=b<a.ff?Number.POSITIVE_INFINITY:a.Xd[0]/b;return[a*c,d]}
function ne(a){var b,c=a.c,d=c.Ag,e=a.B,g=c.va,f=c.h.Ap;0!=(e.O&1)?(b=Number.POSITIVE_INFINITY,0!=(e.O&4)?b=c.sd*e.jf:0!=(e.O&8)&&(b=e.v.mg/e.ee*c.sd),1==c.N.Rp?(e=c.N.kn,b=[2*b/e,e]):0!=(e.O&8)?f?(b=e.v.mg/256*c.sd*(256/e.ee),b=me(a,e,b)):(b=e.v.mg/256*c.sd,d=e.ee/256*c.sc,c=c.Ed,g=[g[0]-c[0]*d,g[1]-c[1]*d,g[2]-c[2]*d],b=le(a,e.v,b,g)):!f&&1.1<d?(b=d/1.1*e.jf*c.sd,d=d/1.1*c.sc,c=c.Ed,g=[g[0]-c[0]*d,g[1]-c[1]*d,g[2]-c[2]*d],b=le(a,e.v,b,g)):b=f?me(a,e,b):le(a,e.v,b,g)):(b=f?me(a,e,1):le(a,e.v,1,g),
b[0]=Number.POSITIVE_INFINITY);a.Db=b[0];a.xa=b[1]}function ac(a,b,c){this.c=a;this.N=a.N;this.Cq=[0,0,0];this.ah=c;this.Qh=this.c.Cb.gf.Qh;this.Rd=!1;this.He=new ie(this.c,null,this.Cq);this.Ge=[];this.gi=[];this.h=this.c.h;this.Ef=[0,0,0];this.sd=1;this.tc=0}l=ac.prototype;l.D=function(){this.He=null};l.ic=function(){var a=Ac(this.c,surface.Zb,{da:result_[0],hb:result_[1],ib:result_[2]});map_.Xb.load(a,metatile_.Ur.bind(metatile_,a));this.Xr.load();this.He.$b=1;this.Rd=!0};
function yd(a,b){for(var c=a.He,d=1;d<=b[0];d++){var e=1<<d-1,g=0;0!=(b[1]&e)&&(g+=1);0!=(b[2]&e)&&(g+=2);c=c.Z[g];if(!c)return null}return c}
l.Ua=function(){this.Ef=[0,0,0];this.sd=this.c.sd;var a=this.c.Cb.Nb.xe.Tp;if(null!=a)oe(this),"X"==a.S&&(oe(this),oe(this));else switch(this.ah&&this.ah.Va?this.c.h.tj:this.c.h.Fh){case "topdown":oe(this);break;case "fit":this.tc++;var b=this.He;if(ke(b,this,0)){var a=this.c,c=b.B,d=a.va;if(b.Pc(b.f,c.v,d,c)){ne(b);var e=a.Bi,g=a.Sj,f=a.Rj,k=0,h,m;g[0]=[b,0];h=1;var n=a.Ag,p=a.w.wf||a.w.vf,t=a.w.Vd;a.Hb++;var u=1,w=1,v=1,C=a.Hb;do{var N=0;m=0;for(--h;0<=h;h--)if(c=g[h],b=c[0],depth_=c[1],!(2<=depth_)){if(c=
b.B)w++,c.$b.Hb!=C&&(c.$b.Hb=C,v++);if(b.Pc(b.f,c.v,d,c))if(u++,b.Db!=Number.POSITIVE_INFINITY&&b.Db>N&&(N=b.Db),p&&t.push(b),0!=(c.O&240)==0||b.Db<=n){var x=2E3*(b.f[0]+4)*b.xa;if(0==(c.O&240)||cd(a,b,b.B,d,x,!0,0<depth_))e[k]=b,k++;else for(depth_++,c=0;4>c;c++){var D=b.Z[c];D&&ke(D,this,D.f[0],!0)&&(pe(D,D.B),ne(D),x=2E3*(D.f[0]+4)*D.xa,cd(a,D,D.B,d,x,!0,0<depth_)?(e[k]=b,k++):(f[m]=[D,depth_],m++))}}else if(0==depth_&&0!=(c.O&1)&&b.Db<=2*n){for(var G=0,U=0,r=[],c=0;4>c;c++)if(D=b.Z[c])G++,ke(D,
this,D.f[0])&&(pe(D,D.B),ne(D),x=2E3*(D.f[0]+4)*D.xa,cd(a,D,D.B,d,x,!0,0<depth_)&&(U++,r.push(D)));if(0<G&&G==U){do for(x=!0,c=0,b=r.length-1;c<b;c++)r[c].xa>r[c+1].xa&&(x=r[c],r[c]=r[c+1],r[c+1]=x,x=!1);while(!x);c=0;for(b=r.length;c<b;c++)f[m]=[r[c],depth_],m++}else if(x=2E3*(b.f[0]+4)*b.xa,cd(a,b,b.B,d,x,!0,!0))e[k]=b,k++;else for(c=0,b=r.length;c<b;c++)f[m]=[r[c],depth_],m++}else for(c=0;4>c;c++)(D=b.Z[c])&&ke(D,this,D.f[0])&&(pe(D,D.B),ne(D),f[m]=[D,depth_],m++)}N=g;g=f;f=N;h=m}while(0<h);a.u.ji=
u;a.u.$h=w;a.u.Zh=v;if(this.c.w.zg||this.c.w.yg)for(this.c.Eb[0]||(this.c.Eb[0]=[]),g=this.c.Eb[0],h=k-1;0<=h;h--)g.push(e[h]);for(h=k-1;0<=h;h--)b=e[h],cd(a,b,b.B,d,0,!1,!1)}}break;case "fitonly":if(this.tc++,b=this.He,ke(b,this,0)&&(a=this.c,c=b.B,d=a.va,b.Pc(b.f,c.v,d,c))){ne(b);e=a.Bi;g=a.Sj;f=a.Rj;k=0;g[0]=b;h=1;n=a.Ag;p=a.w.wf||a.w.vf;t=a.w.Vd;a.Hb++;v=w=u=1;C=a.Hb;do{m=N=0;for(--h;0<=h;h--){b=g[h];if(c=b.B)w++,c.$b.Hb!=C&&(c.$b.Hb=C,v++);if(b.Pc(b.f,c.v,d,c))if(u++,p&&t.push(b),b.Db!=Number.POSITIVE_INFINITY&&
b.Db>N&&(N=b.Db),b.Db<=n)e[k]=b,k++;else{x=0;c=[];for(r=0;4>r;r++)if(D=b.Z[r])x++,ke(D,this,D.f[0])&&(pe(D,D.B),ne(D),c.push(D));if(0<x){do for(x=!0,r=0,b=c.length-1;r<b;r++)c[r].xa>c[r+1].xa&&(x=c[r],c[r]=c[r+1],c[r+1]=x,x=!1);while(!x);r=0;for(b=c.length;r<b;r++)f[m]=c[r],m++}else e[k]=b,k++}}N=g;g=f;f=N;h=m}while(0<h);a.u.ji=u;a.u.$h=w;a.u.Zh=v;if(this.c.w.zg||this.c.w.yg)for(this.c.Eb[0]||(this.c.Eb[0]=[]),g=this.c.Eb[0],h=k-1;0<=h;h--)g.push(e[h]);for(h=k-1;0<=h;h--)b=e[h],cd(a,b,b.B,d,0,!1,
!1)}}};function pe(a,b){if(!b.Yf){for(var c=a.sa;c;){var d=c.B;if(0!=(d.O&2)){b.rd=d.rd;b.ad=d.ad;Wd(b);break}c=c.sa}b.Yf=!0}}
function oe(a){a.tc++;var b=a.He;if(ke(b,a,0)){var c=a.c,d=b.B,e=c.va;if(b.Pc(b.f,d.v,e,d)){ne(b);var g=c.Bi,f=c.Sj,k=c.Rj,h=0,m,n;f[0]=b;m=1;var p=c.Ag,t=0,u=c.w.wf||c.w.vf,w=c.w.Vd;c.Hb++;var v=1,C=1,N=1,x=c.Hb;do{var D=0;n=0;for(--m;0<=m;m--){b=f[m];if(d=b.B)v++,d.$b.Hb!=x&&(d.$b.Hb=x,C++);if(b.Pc(b.f,d.v,e,d))if(N++,b.Db!=Number.POSITIVE_INFINITY&&b.Db>D&&(D=b.Db),u&&w.push(b),b.Db<=p)g[h]=b,h++;else{for(var G=0,U=0,d=[],r=0;4>r;r++){var y=b.Z[r];if(y&&(G++,ke(y,a,y.f[0]))){pe(y,y.B);ne(y);var Z=
1*y.f[0]*y.xa;b.A&&0!=(y.B.O&1)?cd(c,y,y.B,e,Z,!0,!1)&&(U++,d.push(y)):(U++,d.push(y))}}if(0<G&&G==U&&0!=G){do for(G=!0,r=0,b=d.length-1;r<b;r++)d[r].xa>d[r+1].xa&&(G=d[r],d[r]=d[r+1],d[r+1]=G,G=!1);while(!G);r=0;for(b=d.length;r<b;r++)k[n]=d[r],n++}else g[h]=b,h++}}m=f;f=k;k=m;m=n;0!=D&&(t=D)}while(0<m);t>a.c.Pg&&(a.c.Pg=t);c.u.ji=N;c.u.$h=v;c.u.Zh=C;if(a.c.w.zg||a.c.w.yg)for(a.c.Eb[0]||(a.c.Eb[0]=[]),a=a.c.Eb[0],m=h-1;0<=m;m--)a.push(g[m]);for(m=h-1;0<=m;m--)b=g[m],cd(c,b,b.B,e,0,!1,!1)}}}
function xd(a,b,c,d){if(b){a.gf=c;c=d?a.pr:a.or;if(1==b.f[0]&&(qe(a,b.sa,!0),!b.sa.B))return;qe(a,b,!1,c)}}function qe(a,b,c,d){if(null!=b&&ke(b,a,0)&&!c&&(b.B.$b.uk(),b.Sd&&b.Sd==b.A&&(b.Sd=null,je(b)),1==d(b,a.gf,0))){var e=a.gf;c=e.Pk;var e=e.la,g=[.5*(e.ca[0]+e.oa[0]),.5*(e.ca[1]+e.oa[1])],f=c[0]>=g[0];c=c[1]>=g[1];f?e.ca[0]=g[0]:e.oa[0]=g[0];c?e.ca[1]=g[1]:e.oa[1]=g[1];qe(a,b.Z[f?c?1:3:c?0:2],!1,d)}}
l.or=function(a,b){if(!a||a.f[0]>b.Jf&&b.gb)return!1;var c=a.B;if(!c)return!1;if(0!=(c.O&2))if(!a.gb){if(!a.A||a.A.Mc)return!1;c=ld(a.Na,a.f);a.gb=Dc(a.cc,c,!0)}else{if(1==a.gb.U())return b.sa={B:b.B,gb:b.gb,Xf:b.Xf},b.B=c,b.gb=a.gb,b.Xf={ca:b.la.ca.slice(),oa:b.la.oa.slice()},a.f[0]!=b.Jf}else return b.gb||(b.B=c),!0;return!1};l.pr=function(a,b){if(!a||a.f[0]>b.Jf)return!1;var c=a.B;if(!c)return!1;b.sa={B:b.B};b.B=c;return a.f[0]!=b.Jf};
Cb.prototype.quad=function(a,b,c){var d="";for(i=a;0<i;i--){a=0;var e=1<<i-1;0!=(b&e)&&(a+=1);0!=(c&e)&&(a+=2);d+=a}return d};Cb.prototype.msDigit=function(a,b){return((a&3)<<1)+(b&1)};function re(a){for(a=a.toString(16);8>a.length;)a="0"+a;return a}Cb.prototype.ppx=function(a,b){return re(b<<28-a)};Cb.prototype.ppy=function(a,b){return re(268435456-(b+1<<28-a))};
Cb.prototype.fq=function(a,b,c){if("string"==typeof c)if(-1!=c.indexOf("quad")){b="(function(lod,x,y,loclod,locx,locy){"+c.replace("quad","return this.quad")+"})";try{var d=eval(b).bind(this);return d(a.da,a.hb,a.ib,a.Bh,a.nj,a.oj)}catch(e){return c}}else if(-1!=c.indexOf("ms_digit")){b="(function(x,y,loclod,locx,locy){"+c.replace("ms_digit","return this.msDigit")+"})";try{return d=eval(b).bind(this),d(a.hb,a.ib,a.Bh,a.nj,a.oj)}catch(e){return c}}else{if(-1!=c.indexOf("alt"))return(a=/\(([^)]*)\)/.exec(c))&&
a[1]&&(a=a[1].match(/([^,]+)/g),0<a.length)?a[b%a.length]:c;if(-1!=c.indexOf("ppx")){b="(function(lod,x,loclod,locx){"+c.replace("ppx","return this.ppx")+"})";try{return d=eval(b).bind(this),d(a.da,a.hb,a.Bh,a.nj)}catch(e){return c}}else if(-1!=c.indexOf("ppy")){b="(function(lod,y,loclod,locy){"+c.replace("ppy","return this.ppy")+"})";try{return d=eval(b).bind(this),d(a.da,a.ib,a.Bh,a.oj)}catch(e){return c}}else return c}else return c};
function Ac(a,b,c,d,e){var g=e=0,f=0;if(c.da){var k=[c.da,c.hb,c.ib],h=a.Cb.Hd.ua;e=[];f=0;for(g=h.length;f<g;f++){var m=h[f],n=k[0]-m.f[0];ix_=k[1]>>n;iy_=k[2]>>n;ix_==m.f[1]&&iy_==m.f[2]&&e.push(m)}k=null;f=0;for(g=e.length;f<g;f++)-1<e[f].f[0]&&(k=e[f]);f=c.da-(k?k.f.slice():[0,0,0])[0];g=(1<<f)-1;e=c.hb&g;g&=c.ib}k={da:c.da,hb:c.hb,ib:c.ib,Bh:f,nj:e,oj:g};b=b.replace(/ /g,"");b=q.Lq(b,{lod:c.da,x:c.hb,y:c.ib,sub:d,locx:e,locy:g,loclod:f,geonavtile:d,here_app_id:"abcde",here_app_code:"12345"},
a.fq.bind(a,k,a.fn));a.fn++;return(e=-1!=b.indexOf("//"))?0==b.indexOf("//")?a.Rb+b:b:a.Aa+b}function Eb(a,b){this.parse(b)}Eb.prototype.parse=function(a){this.Wk=a.description||"";this.Ra=a.freeLayers||{};this.bb={};if(a.surfaces)if(a=a.surfaces,Array.isArray(a))for(var b=0,c=a.length;b<c;b++)this.bb[a[b]]=[];else this.bb=a;this.Ra=!this.Ra||Array.isArray(this.Ra)?{}:JSON.parse(JSON.stringify(this.Ra));this.bb=JSON.parse(JSON.stringify(this.bb))};
Eb.prototype.Ib=function(){return{description:JSON.parse(JSON.stringify(this.Wk)),surfaces:JSON.parse(JSON.stringify(this.bb)),freeLayers:JSON.parse(JSON.stringify(this.Ra))}};
function He(a,b,c){this.R=!1;this.h={c:null,Ch:900,Eh:360,Ih:60,Aj:1.1,Gh:0,Dh:20,Hh:2E4,yj:!1,xj:!0,jg:2,pd:4,vj:!1,Kh:!0,Xl:!0,Yl:!0,Zl:!0,rj:!1,zj:!0,bf:!0,uj:!0,$l:!1,zp:!1,Ap:!1,ig:!1,am:!0,kc:3E3,jc:3,Fh:"topdown",tj:"fit",kg:!1,Jh:!0,sj:!1,Zj:!0,Yj:!1,Oc:null,bm:!1};this.Hf={};this.pc(b);this.gl=a;this.gp=c;this.aa=!1;this.pe=[];this.lj=0;this.nk=this.lk=null;this.ub={};this.eg=null!=q.nn?new q.nn(this):null;this.wj=this.c=null;this.l=new hb(this,this.gl,0,this.Vh.bind(this),this.h);this.Bq=
new S(this.l);this.Bb=window._mproj4_;q.ta.ic();this.zh(this.h.c);window.ym(this.om.bind(this))}l=He.prototype;l.Vh=function(){null!=this.c&&pc(this.c)};
l.zh=function(a){null!=this.c&&this.Kf();if(null!=a){a=q.qa.rl(a,window.location.href);this.mk=!0;this.bn=this.hi=this.qj=null;this.an=!0;var b=function(){if((this.mk||this.an)&&this.qj){var b=this.qj;this.Qc("map-mapconfig-loaded",b);this.c=new Cb(this,b,a,this.h);this.wj=new Y(this.c);this.pc(this.c.si);this.pc(this.Hf);this.h.fa&&(this.c.setPosition(this.h.fa),this.h.fa=null);this.h.ln&&(this.c.qf(this.h.ln),this.h.ln=null);this.Qc("map-loaded",{browserOptions:this.c.si})}}.bind(this),c=function(a){this.qj=
a;b()}.bind(this),d=function(){}.bind(this),e=function(b){this.ub.token=b.token;this.ub.tokenHeader=b.header;this.hi=1E3*b.expires;this.bn=function(){this.hi=null;this.cn=!0;"string"===typeof this.h.Oc?q.Zc(this.h.Oc,e,g,null,q.useCredentials,this.ub):this.h.Oc(e)}.bind(this);this.cn||k(a);"string"===typeof this.h.Oc?h(b.cookieInjector,this.h.Oc):h(b.cookieInjector,a)}.bind(this),g=function(){console.log("auth token not loaded");this.an&&k(a)}.bind(this);this.cn=!1;var f=function(){document.body.removeChild(this.nk);
this.nk=null;this.mk=!0;b()}.bind(this),k=function(a){q.Zc(a,c,d,null,q.useCredentials,this.ub)}.bind(this),h=function(a,b){a=q.qa.rl(a,b);this.lk=q.qa.Co(a);var c=document.createElement("iframe");this.nk=c;c.onload=f;c.src=a;c.style.display="none";document.body.appendChild(c)}.bind(this);this.h.Oc?(this.mk=!1,"string"===typeof this.h.Oc?q.Zc(this.h.Oc,e,g,null,q.useCredentials,this.ub):this.h.Oc(e)):k(a)}};l.yi=function(){this.R||(this.Kf(),this.l&&this.l.D(),this.gl=null,this.R=!0)};
l.Kf=function(){this.c&&(this.c.D(),this.wj=this.c=null,this.Qc("map-unloaded",{}))};l.Xc=function(){return this.c};l.hh=function(){return this.l};l.ih=function(){return this.Bq};l.Ti=function(){return this.Bb};l.Ij=function(a,b){if(1!=this.R&&null!=b)return this.lj++,this.pe.push({Fp:a,hg:b,f:this.lj}),function(a){this.removeListener(a)}.bind(this,this.lj)};l.Qc=function(a,b){for(var c=0;c<this.pe.length;c++)this.pe[c].Fp==a&&this.pe[c].hg(b)};
l.removeListener=function(a){for(var b=0;b<this.pe.length;b++)if(this.pe[b].f==a){this.pe.splice(b,1);break}};q.xo=function(a){return(a?"Core: ":"")+"1.66"};q.Ok=function(){q.ta.ic();var a=document.createElement("canvas");if(null==a)return!1;a.width=1024;a.height=768;if(null==a.getContext)return!1;var b=null;try{b=a.getContext("webgl")||a.getContext("experimental-webgl")}catch(c){return!1}return b?!0:!1};
q.Ck=function(a,b){a="string"!==typeof a?a:document.getElementById(a);return q.Ok()?new Ie(a,b):null};function Ie(a,b){this.C=new He(a,b,this);this.c=this.C.Xc()}l=Ie.prototype;l.yi=function(){this.C.yi();this.C=null};l.Xc=function(){return this.C?this.C.wj:null};l.zh=function(a){return this.C?this.C.zh(a):null};l.Kf=function(){return this.C?this.C.Kf():null};l.hh=function(){return this.C?this.C.ih():null};l.Ti=function(){return this.C?this.C.Ti():null};
l.Ij=function(a,b){if(!this.C)return null;this.C.Ij(a,b)};l.Qc=function(a,b){if(!this.C)return null;this.C.Qc(a,b)};q.MapCore=q.Ck;q.mapCore=q.Ck;Ie.prototype.destroy=Ie.prototype.yi;Ie.prototype.loadMap=Ie.prototype.zh;Ie.prototype.destroyMap=Ie.prototype.Kf;Ie.prototype.getMap=Ie.prototype.Xc;Ie.prototype.getRenderer=Ie.prototype.hh;Ie.prototype.on=Ie.prototype.Ij;Ie.prototype.callListener=Ie.prototype.Qc;q.getCoreVersion=q.xo;q.checkSupport=q.Ok;
He.prototype.pc=function(a){if("object"===typeof a&&null!==a)for(var b in a)this.ec(b,a[b])};
He.prototype.ec=function(a,b){if("pos"==a||"position"==a||"view"==a)this.Xc()?("view"==a?this.Xc().qf(b):this.Xc().setPosition(new Db(this,b)),this.Hf[a]&&delete this.Hf[a]):this.Hf[a]=b;else if("map"==a)this.h.c=q.li(b,null);else if("mapVirtualSurfaces"==a)this.h.Kh=q.Oa(b,!0);else if("authorization"==a)this.h.Oc="string"===typeof b||"function"===typeof b?b:null;else{if(0==a.indexOf("map")||"mario"==a)this.Hf[a]=b,null!=this.Xc()&&this.Xc().ec(a,b);0==a.indexOf("renderer")&&this.hh().ec(a,b)}};
He.prototype.Wc=function(a){if("map"==a)return this.h.c;if(0==a.indexOf("map")&&null!=this.Xc())return this.Xc().Wc(a,value_);if(0==a.indexOf("renderer"))return this.hh().Wc(a,value_)};He.prototype.om=function(){this.R||(null!=this.c&&this.c.update(),this.Qc("tick",{}),window.ym(this.om.bind(this)))};
